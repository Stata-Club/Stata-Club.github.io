webpackJsonp([1],[function(e,t,n){(function(e,t){"use strict";n(12),n(4),n(9),n(71),n(156),n(191);var i=n(66);e.render(t.createElement(i,null),document.getElementById("app")),n(188),n(184),n(194),n(193),n(192),n(195)}).call(t,n(11),n(2))},,,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(160),o=i(a),s=n(163),r=i(s),l=n(164),c=i(l),d=n(166),u=i(d),f=n(168),h=i(f),g=n(170),p=i(g),m=n(13),v=i(m),w=n(175),_=i(w),y=n(177),b=i(y),C=n(178),N=i(C),E=n(181),x=i(E),M=n(182),D=i(M),I=n(183),O=i(I),A=n(179),S=i(A),T=n(169),U=i(T),k=n(180),L=i(k),R=n(174),B=i(R),P=n(171),z=i(P),F=n(176),H=i(F),j=n(172),V=i(j),W=n(161),K=i(W),G=n(167),Y=i(G),q=n(162),Q=i(q),J=n(173),Z=i(J);t.LazyLoad=V["default"],t.DragMerge=Y["default"],t.AjaxUtil=o["default"],t.CaretUtil=r["default"],t.ContentUtil=c["default"],t.DomUtil=u["default"],t.EnvUtil=h["default"],t.ImageUtil=p["default"],t.LoggerUtil=v["default"],t.NotificationUtil=_["default"],t.ShareUtil=b["default"],t.TimeUtil=N["default"],t.ValidatorUtil=x["default"],t.VideoUtil=D["default"],t.WindowMessager=O["default"],t.Ui=S["default"],t.ExtUtil=U["default"],t.UrlUtil=L["default"],t.LoginUtil=B["default"],t.JqueryUtil=z["default"],t.PageUtil=H["default"],t.AnalyticUtil=K["default"],t.AudioPlayer=Q["default"],t.LocaleUtil=Z["default"]},,,,function(e,t,n){"use strict";var i=n(271),a=n(270),o={ALL_TAG_ID:0,NO_TAG_ID:-1,TRASHBIN_ID:-2,SECRET_ID:-3,CREATE_TOOLTIP:"创建新贴纸...",ADD_TAG_TOOLTIP:"新增",RECENT_TAGS:"最近标签",READSLATER_TAG_LOCAL_NAME:"稍后阅读",READSLATER_TAG_SERVER_NAME:"readslater",ALL_TAG_NAME:"所有贴纸",NO_TAG_NAME:"待分类",TRASHBIN_NAME:"垃圾桶",SECRET_NAME:"私密",TITLE_PLACEHOLDER:"无标题",NEWNOTE_KEY_NAME:"new_note",CONTENT_LINE_HEIGHT:24,CONTENT_MAX_HEIGHT:150,NOTES_ADD_KEY:"note_create_queue",NOTES_EIDT_KEY:"note_update_queue",TAGS_ADD_KEY:"tag_add_key",TAGS_EIDT_KEY:"tag_eidt_key",TAGS_ACCESS_HISTORY_KEY_NAME:"tags_access_history",TAGS_CHOSEN_HISTORY_KEY_NAME:"tag_chosen_history",TAGS_USAGE_HISTORY_KEY_NAME:"tag_usage_history",TAGS_LAST_OPENED_KEY_NAME:"tag_last_opened",NOTES_LAST_OPENED_KEY_NAME:"note_last_opened",NOTES_SORTBY_KEY_NAME:"note_sortby",NOTES_LAST_SORTBY:"notes_last_sortby",GNID_SORTBY_BIND_KEY_NAME:"gnid_sortby_relation",NOTES_KEY_NAME:"notes",TAGS_KEY_NAME:"tags",USER_KEY_NAME:"profile",LOCAL_DRAFT_KEY:"_new_note",APP_INITED_FLAG:"__OKMEMO_INITED__",TAG_HISTORY_LIMIT:10,TAG_USAGE_LIMIT:10,NAV_TAG_LIMIT:6,USAGE_TAG_LIMIT:9,OFFSET_TO_LOAD:150,ITEMS_PER_LOAD:20,INITIAL_ITEMS_LIMIT:10,TAGS_PER_PANEL:12,API_DOMAIN:"api.funp.in",LOGIN_SITE:"https://api.funp.in",API_VERSION:"v4",SMALL_IMG_CLASS:"smpic",app_map:{1:"Twitter",2:"微博",3:"Google",4:"Facebook",5:"QQ",6:"Evernote",7:"印象笔记",8:"微信",9:"豆瓣"},backup_apps:["evernote","yinxiang"],origin:"http://funp.in",img_folder_path:"./images",default_favicon:i,share_default_url:"https://api.okay.do/v2/invite?from=extension",default_page_title:"预览窗口",img_origin:"https://img.okay.do",img_cdn_domain:"img.okay.do",save_delay:500,sidebar_img_width:290,content_img_maxwidth:272,sidebar_img_height:300,max_upload_width:1200,user_default_avatar:a,no_scroll_state_class:"hover",enable_custom_css_scrollbar:!0,img_placeholder:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",editor_enabled:!0,environment:"production_env",fontsize_level:{"12px":1,"16px":2,"18px":3,"22px":4,"28px":5}};e.exports=o},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(69),o=i(a),s=n(45),r=i(s),l=n(70),c=i(l),d=n(157),u=i(d),f=n(44),h=i(f),g=n(158),p=i(g),m=n(159),v=i(m),w=n(43),_=i(w);n(187),n(190),n(186),n(189),n(185),t.AppModel=_["default"],t.NoteModel=o["default"],t.Request=r["default"],t.UserModel=c["default"],t.LocalKVDB=h["default"],t.NativeKVDB=p["default"],t.ImageModel=u["default"],t.SyncQueue=v["default"]},function(e,t,n){(function(n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={_setState:function(e,t){this.isMounted()?this.setState(e,t):n.printStack()}};t["default"]=i,e.exports=t["default"]}).call(t,n(13))},,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(66),o=i(a),s=n(146),r=i(s),l=n(148),c=i(l),d=n(67),u=i(d),f=n(151),h=i(f),g=n(155),p=i(g),m=n(153),v=i(m),w=n(112),_=i(w),y=n(114),b=i(y),C=n(116),N=i(C),E=n(110),x=i(E),M=n(145),D=i(M),I=n(130),O=i(I),A=n(126),S=i(A),T=n(140),U=i(T),k=n(128),L=i(k),R=n(132),B=i(R),P=n(134),z=i(P),F=n(136),H=i(F),j=n(138),V=i(j),W=n(122),K=i(W),G=n(142),Y=i(G),q=n(124),Q=i(q),J=n(118),Z=i(J),X=n(120),$=i(X),ee=n(108),te=i(ee);t.App=o["default"],t.BackTop=r["default"],t.Dialog=c["default"],t.FeedbackPanel=u["default"],t.LoadingAnim=h["default"],t.StaticFn=p["default"],t.MergeTipsCover=v["default"],t.DropDownMenu=_["default"],t.HeaderMenu=b["default"],t.LoginMenu=N["default"],t.CreateNote=x["default"],t.Search=D["default"],t.EmbedBrowsers=te["default"],t.NoteList=O["default"],t.Note=S["default"],t.NoteTitle=U["default"],t.NoteContent=L["default"],t.NoteMeta=B["default"],t.NoteOp=z["default"],t.NoteSharePanel=H["default"],t.NoteSwitch=V["default"],t.NoResult=K["default"],t.NoteToggleEditor=Y["default"],t.MCEEditor=Q["default"],t.ImageViewer=Z["default"],t.MediaViewer=$["default"]},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),o=i(a),s={debug:function(e,t,n){return"string"!=typeof e?!1:void("debug_env"==o["default"].environment&&window.console&&console.debug("["+e+"]:",t,n||""))},log:function(){"debug_env"==o["default"].environment&&window.console&&console.log.apply(console,arguments)},printStack:function(e){try{throw new Error("[Debug - "+(e||"Stack")+"]:")}catch(t){console.log(t)}}};t["default"]=s,e.exports=t["default"]},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){(function(i,a,o){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),l=n(9),c=n(46),d=s(c),u={Globals:{protocol:"https"},generateID:function(e){var t=l.UserModel.getLocalUser(),n="";t&&t.uid&&(n=t.uid);var i=new Date(Date.now()).getHours();return i=i>9?i:"0"+i,(0,d["default"])(Date.now()+""+n+e?e:"")+""+i},generateSortby:function(){var e=l.LocalKVDB.get(i.NOTES_LAST_SORTBY,null),t=(new Date,parseInt(Date.now()/1e3,10)-1452212501);return e>=t&&(t=e+1),e=t,l.LocalKVDB.set(i.NOTES_LAST_SORTBY,e),t},getAPIRoot:function(){return this.Globals.protocol+"://"+i.API_DOMAIN+"/"+i.API_VERSION+"/"},getVersion:function(e){l.Request.get("/",e)},signRequest:function(e){this.signature&&Date.now()<1e3*(this.signature.expire-10)?e(this.signature):l.Request.get("images/sign_request",e)},ossupload:function(e,t,n,i,s){var l=new FormData,c=this;if(a.isFunction(n))s=i,i=n,n=r.ImageUtil.getCDNImageName(e,t.size);else if(!n){if(!e)return!1;n=r.ImageUtil.getCDNImageName(e,t.size)}this.signRequest(function(e){if(e&&e.policy){c.signature=e,l.append("policy",e.policy),l.append("OSSAccessKeyId",e.OSSAccessKeyId),l.append("Signature",e.Signature),l.append("key",n),l.append("file",t),l.append("success_action_status",200);var r={url:e.host,type:"POST",data:l,processData:!1,contentType:!1,complete:function(){a.isFunction(i)&&i("complete")},success:function(){a.isFunction(i)&&i("success")},error:function(){a.isFunction(i)&&i("error")},xhr:function d(){var d=a.ajaxSettings.xhr();return d.upload.onprogress=s,d.upload.onload=function(){o.log("DONE!")},d}};a.ajax(r)}})},clearLocalDB:function(){var e=l.LocalKVDB.get("version","");l.LocalKVDB.flush(),l.LocalKVDB.set("version",e)},testClearLocalDB:function(){l.LocalKVDB.set(i.NOTES_SORTBY_KEY_NAME,[]),l.LocalKVDB.set(i.GNID_SORTBY_BIND_KEY_NAME,{}),l.LocalKVDB.set(i.NOTES_ADD_KEY,{}),l.LocalKVDB.set(i.NOTES_EIDT_KEY,{}),l.LocalKVDB.set("deadline",0)},sendLog:function(e,t){return e?(t=t||"",void((new Image).src=this.getAPIRoot()+"analytics/log?ww="+window.screen.width+"&wh="+window.screen.height+"&ua="+(window._ENV.browser&&window._ENV.browser.toLowerCase())+"&v="+t+"&b="+e+"&t=image")):!1}};t["default"]=u,e.exports=t["default"]}).call(t,n(8),n(3),n(13))},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={get:function(){return jStorage.get.apply(jStorage,arguments)},set:function(){return jStorage.set.apply(jStorage,arguments)},deleteKey:function(){return jStorage.deleteKey.apply(jStorage,arguments)},listenKeyChange:function(){return jStorage.listenKeyChange.apply(jStorage,arguments)},flush:function(){return jStorage.flush.apply(jStorage,arguments)}};t["default"]=n,e.exports=t["default"]},function(e,t,n){(function(i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(9),r=(n(4),{getAPIRoot:function(){return s.AppModel.Globals.protocol+"://"+i.API_DOMAIN+"/"+i.API_VERSION+"/"},toQueryPair:function(e,t){return"undefined"==typeof t?e:e+"="+encodeURIComponent(null===t?"":String(t))},toQueryString:function(e){var t=this,n=[];for(var i in e){i=encodeURIComponent(i);var a=e[i];if(a&&a.constructor==Array){for(var o,s=[],r=0,l=a.length;l>r;r++)o=a[r],s.push(t.toQueryPair(i,o));n=n.concat(s)}else n.push(t.toQueryPair(i,a))}return n.join("&")},_call:function(e){var t={did:"ZlVsZm11aDArbHExd3RCcE1VZm1TVjVKWkthTHZJY1dPT3Z5aFVWb2Zqb0hHalFYSWFmOGZnRCtURGxqam1IdFpFbjFMbnZwa2xZNTNHNU5QazBKRDNoRUJsMCtib3ZHZkhtbFNuOG4vTlUwbXZWNnVxZTNsaDk0OWFYVklyK3EzQQ"};t&&(e.url=e.url.indexOf("?")>=0?e.url+"&"+this.toQueryString(t):e.url+"?"+this.toQueryString(t));var n=e.success;e.success=function(e){n&&n(e),-1012===e.status&&(s.UserModel.setLocalUser(""),a.log("已经退出"))};var i=e.error;e.error=function(e,t,n){i&&i(e),e.status>=500},e.crossDomain=!0,e.xhrFields={withCredentials:!0},o.ajax(e)}}),l={get:function(e,t,n,i,a){o.isFunction(t)&&(n=t,i=n,a=i);var s={type:"GET",url:r.getAPIRoot()+e,data:o.isFunction(t)?"":t,success:n?n:"",error:i?i:""};a&&(s=o.extend(s,a)),r._call(s)},put:function(e,t,n,i,a,s){o.isFunction(t)&&(t="",n=t,i=n,a=i,s=a),a&&(e=e.indexOf("?")>=0?"&"+e+r.toQueryString(a):e+"?"+r.toQueryString(a));var l={type:"PUT",url:r.getAPIRoot()+e,data:t,success:n?n:"",error:i?i:""};s&&(l=o.extend(l,s)),r._call(l)},post:function(e,t,n,i,a,s){o.isFunction(t)&&(t="",n=t,i=n,a=i,s=a),a&&(e=e.indexOf("?")>=0?"&"+e+r.toQueryString(a):e+"?"+r.toQueryString(a));var l={type:"POST",url:r.getAPIRoot()+e,data:t,success:n?n:"",error:i?i:""};s&&(l=o.extend(l,s)),r._call(l)},"delete":function(e,t,n,i,a,s){o.isFunction(t)&&(t="",n=t,i=n,a=i,s=a),a&&(e=e.indexOf("?")>=0?"&"+e+r.toQueryString(a):e+"?"+r.toQueryString(a));var l={type:"DELETE",url:r.getAPIRoot()+e,data:t,success:n?n:"",error:i?i:""};r._call(l)},head:function(e,t){var n=new XMLHttpRequest;n.open("head",e,!0);var i=setTimeout(function(){n.abort()},3e3);n.onreadystatechange=function(){if(4==n.readyState){clearTimeout(i);var e=n.getResponseHeader("Content-Type");t&&t.call&&t.call(null,e)}},n.send(null)}};t["default"]=l,e.exports=t["default"]}).call(t,n(8),n(13),n(3))},,,,,,,,,,,,,,,,,,,,,function(e,t,n){(function(i,a,o,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=n(4),c=n(9),d=n(12),u=n(107),f=n(10),h=i.createClass({displayName:"App",mixins:[u,f],getInitialState:function(){var e=c.UserModel.getLocalUser(),t=c.NoteModel.getSortBys();return l.LocaleUtil.init(),e.uid||t.length||(a.log("初始化加上初始贴纸"),d.CreateNote.relCreateNote({title:l.LocaleUtil.translate("ext_name"),content:l.LocaleUtil.translate("default_note_content")+'<br /><a href="'+o.origin+'/settings#help">'+l.LocaleUtil.translate("more_help")+"</a>",source:o.origin})),{user:e||null}},componentWillMount:function(){var e=this;s(document).ready(function(){s("body").addClass("doc-ready")}),s(window).on("load",function(){s("body").addClass("page-loaded")}),s(document).on("mousedown",function(t){var n=t.target,i=e.refs.DropDownMenu;e.state.isDropDown&&(s.contains(r.findDOMNode(i),n)||e.showDropDown())}),s(document).on("keydown",function(e){if((e.ctrlKey||e.metaKey)&&83==e.keyCode&&e.preventDefault(),e.altKey&&49==e.keyCode){var t=e.target,n=t.isContentEditable||t.tagName&&("INPUT"==t.tagName||"TEXTAREA"==t.tagName);n||(e.preventDefault(),d.StaticFn.closeApp())}}),s(document).on("dragenter",function(){window.top.postMessage({drag:"dragstart"},"*")})},componentDidMount:function(){var e=this;l.WindowMessager.listenPageEvent("notesloaded",function(){var e=s(".note-content img");l.LazyLoad.lazyLoad(e)}),l.WindowMessager.listenGlobalEvent("user-changed",function(){s("body").addClass("need-refresh")}),c.UserModel.listenProfileChange(function(t){e._setState({user:t})}),l.PageUtil.pageActiveDetect(this.onPageActive,this.onPageInActive),window.top==window&&this.handleAppOpen(),this.listenCustomEvent(),this.listenScroll(),this.initLayout(),this.listenWebsiteEvent(),s(".fp-tooltips").aloha()},initLayout:function(){s("#header").css({width:s("#note_list").width()})},listenWebsiteEvent:function(){s(window).on("message",function(e){var t=e.originalEvent,n=t.origin,i=t.data;if(/[\/\.]funp\.in$/.test(n)&&i.command)switch(i.command){case"update-user":var a=i.data;a&&a.uid&&c.UserModel.setLocalUser(a)}})},onPageActive:function(){var e=s("body").hasClass("app-opened");return s("body").hasClass("need-refresh")&&e?(location.reload(),!1):(s("body").hasClass("inactive")&&e&&(this.refs.note_list.pullUpdates(),l.AnalyticUtil.sendPage()),s("body").removeClass("inactive"),void(l.PageUtil.isHidden()?a.debug("队列","页面不活跃,不开启队列,等切换回来再start"):(a.debug("队列","页面活跃,start"),c.NoteModel.startQueue())))},onPageInActive:function(){s("body").addClass("inactive"),a.debug("队列","页面不活跃,stop"),c.NoteModel.stopQueue()},listenScroll:function(){var e,t=this,n=0,i=0,a=s("body"),r=function(r){l.LazyLoad.lazyLoad(),a.removeClass(o.no_scroll_state_class),t.constructor.hoverTimer&&clearTimeout(t.constructor.hoverTimer),t.constructor.hoverTimer=setTimeout(function(){a.addClass(o.no_scroll_state_class)},400),i=s(r.target).scrollTop(),e="app"==r.target.id?s(r.target).prop("scrollHeight"):s(r.target).height(),l.Ui.winHeight||(l.Ui.winHeight=s(window).height()),i>n&&e-i-l.Ui.winHeight<=o.OFFSET_TO_LOAD&&t.refs.note_list.loadMore(),n=i;var c=t.refs.backtop;i>0?c._setState({active:!0}):c._setState({active:!1})};s(window).add("#app").on("scroll",r)},listenCustomEvent:function(){var e=this;l.WindowMessager.listenPageEvent("appopen",function(t){e.handleAppOpen(t)}).listenPageEvent("appclose",function(){e.handleAppClose()}).listenPageEvent("loadmore",function(){e.refs.note_list.loadMore()})},handleAppOpen:function(e){return s("body").addClass("app-opened"),s("body").hasClass("need-refresh")?(location.reload(),!1):(l.LazyLoad.lazyLoad(),this.constructor.appOpened||(this.constructor.appOpened=Date.now(),s(document.body).hasClass("firefox")&&this.initLayout(),c.UserModel.userInfo(function(e){})),e&&this.refs.note_list.pullUpdates(),void l.AnalyticUtil.sendPage())},handleAppClose:function(){s("body").removeClass("app-opened")},handleShowApp:function(){s("body").removeClass("hide-sidebar"),s(window).trigger("resize")},render:function(){return this._render()}});t["default"]=h,e.exports=t["default"]}).call(t,n(2),n(13),n(8),n(3),n(11))},function(e,t,n){(function(i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),s=n(4),r=n(150),l=n(10),c=i.createClass({displayName:"FeedBackPanel",mixins:[r,l],render:function(){return this._render()},getInitialState:function(){return{types:"loading",message:s.LocaleUtil.translate("set_success"),show:!1}},componentDidMount:function(){var e=this;a(window).on("show_message",function(t,n){n&&(n.show?e._setState(n,function(){n.autoClose&&setTimeout(e.closeFeedback,1e3)}):e.closeFeedback())})},componentDidUpdate:function(e,t){!t.show&&this.state.show&&o.StaticFn.animAfterShow(this)},closeFeedback:function(){var e=this;o.StaticFn.animBeforeHide(this,310,function(){e._setState({show:!1})})}});t["default"]=c,e.exports=t["default"]}).call(t,n(2),n(3))},,function(e,t,n){(function(i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(4),r=n(9),l={scheme:{gnid:{type:"string"},title:{type:"string"},summary:{type:"string"},content:{type:"string"},sortby:{type:"number"},created:{type:"number"},modified:{type:"number"},publyc:{type:"number"},removed:{type:"number"},expunged:{type:"number"},images:{type:"object",scheme:["ImageObject","ImageObject"]}},notePull:function(e,t){var n=this,i=r.LocalKVDB.get("deadline",0);if(!r.UserModel.getLocalUser().uid||n.deadline===i)return e&&e({online:!1,status:0,message:"error",list:[]}),"";var a={deadline:i};r.Request.get("note/pull/",a,function(i){i&&1==i.status?(r.LocalKVDB.set("deadline",i.data.deadline),e&&e({online:!0,status:i.status,message:i.message,list:i.data.list}),t||n.insertLocalNotes(i.data.list)):e&&e({online:!0,status:0,message:"error",list:[]})},function(){e&&e({status:0,message:"error",list:[]})})},getNotes:function(e,t){var n=this;return e={offset:e.offset?e.offset:0,rows:e.rows?e.rows:30},!r.LocalKVDB.get("deadline",0)&&r.UserModel.getLocalUser().uid?(n.notePull(function(e){var i=n.insertLocalNotes(e.list);t&&t({online:e.online,status:e.status,message:e.message,list:i})},!0),""):r.UserModel.getLocalUser().uid?(e.rows=0,void r.Request.get("note/more",e,function(e){if(e&&1==e.status){var i=n.insertLocalNotes(e.data.list);t&&t({online:!0,status:e.status,message:e.message,list:i})}else t&&t({online:!0,status:0,message:"error",list:[]})},function(){t&&t({status:0,message:"error",list:[]})})):(t&&t({status:-1}),"")},getLocalNotes:function(e){var t=this.getSortBys(),n=0==e.offset?0:t.indexOf(parseInt(e.offset,10)),i=e.rows?n+e.rows:n+30;if(0!=e.offset){if(0>n||n+1==t.length)return[];n++,i++}for(var a=[],o=n;i>o;o++){var s=this.getNoteBySortby(t[o]);t[o]&&s&&a.push(s)}return a},insertLocalNotes:function(e){var t=this,n=[],o=r.LocalKVDB.get(i.GNID_SORTBY_BIND_KEY_NAME,{});return a(e).each(function(){if(1==this.removed||1==this.expunged)t.updateSortBys(null,null,this.gnid);else{var e=this,i=null;if(o){var a=o[e.gnid];i=t.getNoteBySortby(a)}!i||i.sortby<e.sortby?(t.setNoteBySortby(e),t.updateSortBys(e.sortby,"",e.gnid),n.push(e)):n.push(i)}}),n},insert:function(e,t){var n=this;return e&&e.content&&e.sortby?(e.content.indexOf("<img")>-1&&(e.upload=!0),n.setNoteBySortby(e),this.updateSortBys(e.sortby,"",e.gnid),this.extractImagesList(e),this.queueInsert(e.gnid,e.sortby),t&&t(e),e):!1},timelyCreate:function(e,t){var n=this;return e&&e.content&&e.sortby?(e.content.indexOf("<img")>-1&&(e.upload=!0),n.setNoteBySortby(e),n.updateSortBys(e.sortby,"",e.gnid),void n.noteInsert([e],function(i){t&&t(i),1==i.status?e.upload&&n.extractImagesList(e,function(e){n.uploadImagesInNote(e.imglist,e,function(e){e.images||a(e.imglist).each(function(t,n){return n.width>=300?(o.debug("图片上传","获取封面图为:"+n.url),e.images=n,!1):void 0}),delete e.upload,e.modified=e.modified+1,n.setNoteBySortby(e),s.WindowMessager.notifyTabs("data-changed",{type:"update",notes:[e]}),n.queueUpdate({gnid:e.gnid,sortby:e.sortby,content:e.content,images:e.images,imglist:e.imglist,modified:e.modified})})}):(n.queueInsert(e.gnid,e.sortby),n.extractImagesList(e))},function(){n.queueInsert(e.gnid,e.sortby)})):!1},extractImagesList:function(e,t){if(!e)return!1;var n=(e.gnid,e.sortby),i=e.content,r=this;s.ContentUtil.getImagesInContent(i,function(e){if(o.log("贴纸中检测到的图片:",e),e&&e.length>0){var i=r.getNoteBySortby(n);i.imglist=a.isArray(i.imglist)?i.imglist:[],i.imglist=i.imglist.concat(e),r.setNoteBySortby(i),t&&t(i)}})},uploadImagesInNote:function(e,t,n){if(a.isArray(e)&&0!=e.length){var i=0;o.debug("图片上传","上传贴纸中的图片"+e.length+"张"),r.ImageModel.uploadImages(e,function(r){i++,o.debug("图片上传","note.upload:"+(t.upload||i));var l={width:r.width,height:r.height,url:r.url,size:r.blob.size,type:r.blob.type};a(e).each(function(t){this.url==l.url&&(e[t]=l)});var c=document.createElement("div");c.innerHTML=t.content;var d=s.ImageUtil.getFullsizeImgViaSrc(l.url,l.size,l.width,l.height,l.type.indexOf("gif")>-1);a('img[src="'+l.url+'"]',c).attr("src",d).attr("_src",l.url).attr("data-width",l.width).attr("data-height",l.height),t.content=c.innerHTML,c=null,o.debug("图片上传","处理完队列贴纸("+t.upload+")中的第"+i+"张图片"),i==e.length&&(o.debug("图片上传成功!!!!!!!","处理完所有队列贴纸中的图片,删除标识,贴纸数据:"),o.log(t.content),t.imglist=e,n&&n.call(null,t))})}},uploadImagesInNoteAlpha:function(e,t){var n=this,i=e.sortby,a=e.imglist;o.debug("图片上传","上传贴纸中的图片"+a.length+"张"),r.ImageModel.uploadImages(a,function(e){n.updateImage(i,e,t)})},updateImage:function(e,t,n){o.debug("图片上传","准备更新贴纸中的图片数据");var i=this,r=i.getNoteBySortby(e),l={width:t.width,height:t.height,url:t.url,size:t.blob.size,type:t.blob.type};a.isArray(r.imglist)&&a(r.imglist).each(function(e){this.url==l.url&&(r.imglist[e]=l)});var c=document.createElement("div");c.innerHTML=r.content;var d=s.ImageUtil.getFullsizeImgViaSrc(l.url,l.size,l.width,l.height,l.type.indexOf("gif")>-1);a('img[src="'+l.url+'"]',c).attr("src",d).attr("_src",l.url).attr("data-width",l.width).attr("data-height",l.height),r.content=c.innerHTML,c=null,l.width>=300&&!r.images&&(o.debug("图片上传","获取封面图为:"+l.url),r.images=l),o.debug("图片上传","note.upload:"+r.upload),isNaN(r.upload)||r.upload===!0?r.upload=1:r.upload++,o.debug("图片上传","note.upload:"+r.upload),o.debug("图片上传","处理完队列贴纸中的第"+r.upload+"张图片"),r.upload>=r.imglist.length&&(o.debug("图片上传成功!!!!!!!","处理完所有队列贴纸中的图片,删除标识,贴纸数据:"),o.log(r.content),delete r.upload,n&&n(r)),i.setNoteBySortby(r)},update:function(e,t){if(!e.sortby)return!1;o.log("贴纸修改接口");var n=e.sortby,i=s.TimeUtil.time(),l=r.AppModel.generateSortby();if(e.modified=i,e.sortby=l,e.content){var c=s.ContentUtil.getSummaryData(e.content);e.summary=c.text||"",e.images=c.feature_img||null}var d=this.getNoteBySortby(n);return d?(d=a.extend(d,e),this.setNoteBySortby(d),1==e.removed?this.updateSortBys(null,n,e.gnid):this.updateSortBys(e.sortby,n,e.gnid),this.queueUpdate(e)):o.debug("贴纸更新","没找到本地贴纸gnid:"+e.gnid+",sortby:"+n),e},noteRemoved:function(e){r.Request.get("note/removed","",function(t){t&&1==t.status?(e&&e.call(null,{online:!0,status:"ok"}),s.WindowMessager.notifyAll("data-changed",{type:"new",notes:[note]})):e&&e({online:!0,status:0,message:"error",list:[]})},function(){e&&e({status:0,message:"error"})})},search:function(e,t){if(!e.keywords)return!1;var n=this,i=e.keywords,s=i.toLowerCase(),r=e.rows||30,l=e.offset||0,c=[],d=this.getSortBys(),u=d.indexOf(l),f=d.slice(u+1);f.sort(function(e,t){return t-e});var h=null;a(f).each(function(e,t){var i=n.getNoteBySortby(t);if(i&&0==i.removed&&(i.title.toLowerCase().indexOf(s)>=0||i.content.toLowerCase().indexOf(s)>=0)){if(!(c.length<=r))return!1;c.push(i),h=t}}),c.length<r?(a.isFunction(t)&&c.length>=0&&t.call(null,{status:1,localdone:!0,list:c}),r-=c.length,e.rows=r,e.offset=h||0,o.log("搜索","本地搜索出"+c.length+"条,去服务器继续搜索"+e.rows+"条"),this.searchOnline(e,function(e){o.log("搜索","服务器继续搜索到"+e.list.length+"条"),a.isFunction(t)&&t.call(null,e)})):a.isFunction(t)&&c.length>0&&t.call(null,{status:1,list:c})},getNoteUrl:function(e){if(!e)return"";var t=r.UserModel.getLocalUser();return t&&t.uid?i.origin+"/paper/"+e+"?u="+t.uid:i.origin+"/paper/"+e},searchOnline:function(e,t){if(!e.keywords)return!1;var n=e.keywords,i=e.rows||20,o=e.offset||0;r.Request.get("note/search",{offset:o,rows:i,keywords:n},function(e){1==e.status&&(e.online=!0,e.list=e.data.list,a.isFunction(t)&&t.call(null,e))})},verify:function(e,t){var n=0;for(n in e)if(e.hasOwnProperty(n)&&(!this.scheme[n]||this.scheme[n].type!=typeof e[n]))return t?t({status:"error"}):"",!1;return!0},getNoteBySortby:function(e){return r.LocalKVDB.get("note_"+e,"")},getNoteByNtid:function(e){var t=r.LocalKVDB.get(i.GNID_SORTBY_BIND_KEY_NAME,{});if(t){var n=t[e];if(n)return this.getNoteBySortby(n)}},setNoteBySortby:function(e){r.LocalKVDB.set("note_"+e.sortby,e)},deleteNoteBySortby:function(e){r.LocalKVDB.deleteKey("note_"+e)},getSortBys:function(){var e=r.LocalKVDB.get(i.NOTES_SORTBY_KEY_NAME,[]);return e.sort(function(e,t){return t-e}),e},updateSortBys:function(e,t,n,a){e=parseInt(e,10),t=parseInt(t,10);var s=r.LocalKVDB.get(i.NOTES_SORTBY_KEY_NAME,[]),l=r.LocalKVDB.get(i.GNID_SORTBY_BIND_KEY_NAME,{});if(t||(t=l[n]),e>0&&t>0&&t>e)return!1;if(t){var c=s.indexOf(t);c>-1&&s.splice(c,1),delete l[n],e!=t&&this.deleteNoteBySortby(t)}if(e){var c=s.indexOf(e);0>c?s.unshift(e):o.log(e),l[n]=e}r.LocalKVDB.set(i.NOTES_SORTBY_KEY_NAME,s),r.LocalKVDB.set(i.GNID_SORTBY_BIND_KEY_NAME,l)},getQueue:function(e){return"create"==e?r.NativeKVDB.get(i.NOTES_ADD_KEY,{}):"update"==e?r.NativeKVDB.get(i.NOTES_EIDT_KEY,{}):void 0},queueInsert:function(e,t){if(!e||!t)return!1;var n=a.extend({},r.NativeKVDB.get(i.NOTES_ADD_KEY,{}));n["@"+e]=t,r.NativeKVDB.set(i.NOTES_ADD_KEY,n),r.SyncQueue.notify();var s=this.queueSize("create");return o.debug("队列:创建:新数据","数据量有"+s+"条"),s},queueCount:function(){var e=0,t=this.getQueue("create");for(var n in t)t.hasOwnProperty(n)&&e++;var i=this.getQueue("update");for(var n in i)i.hasOwnProperty(n)&&e++;return e},queueSize:function(e){var t=this.getQueue(e);if(Object.keys){var n=Object.keys(t).length;return n}var n=0;for(var i in t)t.hasOwnProperty(i)&&n++;return n},queueUpdate:function(e){if(!e.gnid)return!1;var t=r.NativeKVDB.get(i.NOTES_ADD_KEY,{});if(t["@"+e.gnid]&&e.sortby)return t["@"+e.gnid]=e.sortby,r.NativeKVDB.set(i.NOTES_ADD_KEY,t),r.SyncQueue.notify(),!1;var n=r.NativeKVDB.get(i.NOTES_EIDT_KEY,{}),s=n["@"+e.gnid];s&&(e.imglist&&(s.imglist=a.extend([],s.imglist,e.imglist)),e=a.extend(s,e)),n["@"+e.gnid]=e,r.NativeKVDB.set(i.NOTES_EIDT_KEY,n),r.SyncQueue.notify();var l=this.queueSize("update");return o.debug("队列:更新:新数据","数据量有"+l+"条"),l},queueDelete:function(e,t){if(!e)return!1;if("create"==t){var n=r.NativeKVDB.get(i.NOTES_ADD_KEY,{});delete n["@"+e],r.NativeKVDB.set(i.NOTES_ADD_KEY,n)}else if("update"==t){var n=r.NativeKVDB.get(i.NOTES_EIDT_KEY,{});delete n["@"+e],r.NativeKVDB.set(i.NOTES_EIDT_KEY,n)}},noteInsert:function(e,t,n){var i=JSON.stringify(e);r.Request.post("note/insert",{notelist:i},t,n)},noteUpdate:function(e,t,n){var i=JSON.stringify(e);r.Request.post("note/update",{notelist:i},t,n)},startQueue:function(){var e=r.UserModel.getLocalUser();e&&e.uid&&r.SyncQueue.start()},flushQueue:function(e){var t=r.UserModel.getLocalUser();t&&t.uid&&r.SyncQueue.flush(e)},stopQueue:function(){r.SyncQueue.stop()}};t["default"]=l,e.exports=t["default"]}).call(t,n(8),n(3),n(13))},function(e,t,n){(function(i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(45),s=n(43),r=n(44),l={scheme:{uid:{type:"number"},nickname:{type:"string"},signature:{type:"string"},mail:{type:"string"},created:{type:"number"},avatar:{type:"number"},avatar_url:{type:"string"}},dataChangeHandlers:[],userInfo:function(e){var t=this;o.get("user/info/","",function(n){n&&1==n.status?(t.setLocalUser(n.data),e&&e({online:!0,status:n.status,message:n.message,data:n.data})):e&&e({online:!0,message:n.message,status:n.status,data:{}})},function(){e&&e({status:0,message:"error",data:{}})})},getLocalUser:function(){return r.get(i.USER_KEY_NAME,{})},setLocalUser:function(e){var t={};if(e){var n=this.getLocalUser();t=a.extend(n,e)}return a(this.dataChangeHandlers).each(function(e,n){n(t)}),r.set(i.USER_KEY_NAME,t)},listenProfileChange:function(e){a.isFunction(e)&&this.dataChangeHandlers.push(e)},logout:function(e){o.get("user/loginout","",function(t){t&&1==t.status&&(e&&e(t),s.clearLocalDB())})},getUserCdnAvatarUrl:function(e){return i.img_origin+"/avatar/"+e},verify:function(e,t){var n=0;for(n in e)if(e.hasOwnProperty(n)&&(!this.scheme[n]||this.scheme[n].type!=typeof e[n]))return t?t({status:"error"}):"",!1;return!0}};t["default"]=l,e.exports=t["default"]}).call(t,n(8),n(3))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(12),o=n(4),s=n(67),r={_render:function(){var e="";return e=this.state.user&&this.state.user.uid?i.createElement(a.HeaderMenu,{user:this.state.user,showDropDown:this.showDropDown}):i.createElement(a.LoginMenu,null),i.createElement("div",{className:"app-inner"},i.createElement("div",{id:"open_sider",onClick:this.handleShowApp},i.createElement("span",{className:"fp-ext-switch fp-tooltips","data-tooltip":"展开扩展","data-placement":"right"})),i.createElement("div",{className:"main-content"},i.createElement("div",{id:"header"},e,i.createElement("div",{className:"ext-switch"},i.createElement("a",{href:"#",className:"icon-btn fp-tooltips","data-tooltip":o.LocaleUtil.translate("collapse_ext"),"data-placement":"left",onClick:a.StaticFn.closeApp},i.createElement("span",{className:"fp-ext-switch-nav"})))),i.createElement("div",{id:"search"},i.createElement(a.Search,null)),i.createElement("div",{id:"note_list"},i.createElement(a.NoteList,{ref:"note_list"})),i.createElement(a.LoadingAnim,null),i.createElement(a.BackTop,{ref:"backtop"}),i.createElement(s,{ref:"feedbackpanel"}),i.createElement(a.NoteSharePanel,null)),i.createElement(a.EmbedBrowsers,null))}};t["default"]=r,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i,a,o){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(109),l=s(r),c=n(12),d=n(4),u=n(10),f=i.createClass({displayName:"EmbedBrowsers",mixins:[l["default"],u],render:function(){var e=this.renderFn();return e},statics:{},getInitialState:function(){return{openStack:[],showMergeTips:!1}},closeTips:function(){event.preventDefault(),this._setState({showMergeTips:!1})},componentDidMount:function(){var e=this;a(window).on("keyup",function(t){27==t.keyCode&&e.isThereAnyWindow()&&e.popWindow()}),d.WindowMessager.listenPageEvent("show-merge-tips",function(){e._setState({showMergeTips:!0})})},onOpenWindow:function(e){var t=this;this.isThereAnyWindow()||this.open(),a(this.state.openStack).each(function(n,i){this.name==e.name&&t.state.openStack.splice(n,1)}),this.state.openStack.push(e),this.arrangeLayoutStack()},onCloseWindow:function(e){var t=this;a(this.state.openStack).each(function(n,i){this.name==e.name&&(t.state.openStack.splice(n,1),o.findDOMNode(this).style.zIndex=0,this.state.isCurrent&&this._setState({isCurrent:!1}))}),this.arrangeLayoutStack(),this.isThereAnyWindow()||this.close()},arrangeLayoutStack:function(){var e=this;a(this.state.openStack).each(function(t){o.findDOMNode(this).style.zIndex=parseInt(t)+1,t==e.state.openStack.length-1?this.state.isCurrent||this._setState({isCurrent:!0}):this.state.isCurrent&&this._setState({isCurrent:!1})})},popWindow:function(){var e=this.state.openStack.pop();e&&e.close()},open:function(){a("body").addClass("full-page"),c.StaticFn.animAfterShow(this),c.StaticFn.handleFullPageOn()},close:function(){a("body").removeClass("full-page"),c.StaticFn.animBeforeHide(this,1e3),c.StaticFn.handleFullPageOff()},isThereAnyWindow:function(){return this.state.openStack.length>0}});t["default"]=f,e.exports=t["default"]}).call(t,n(2),n(3),n(11))},function(e,t,n){(function(i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),s={renderFn:function(){var e=this.state.animated?" anim":"",t="";i.editor_enabled&&(t=a.createElement(o.MCEEditor,{ref:"editor",handleOpen:this.onOpenWindow,handleClose:this.onCloseWindow}));var n="";return this.state.showMergeTips&&(n=a.createElement(o.MergeTipsCover,{handleClose:this.closeTips})),a.createElement("div",{id:"browse_area",className:e},a.createElement("div",{className:"max-space"},a.createElement("div",{className:"ground",id:"widgets"},t,a.createElement(o.ImageViewer,{ref:"image_viewer",handleOpen:this.onOpenWindow,handleClose:this.onCloseWindow}),a.createElement(o.MediaViewer,{ref:"media_viewer",handleOpen:this.onOpenWindow,handleClose:this.onCloseWindow}),n)))}};t["default"]=s,e.exports=t["default"]}).call(t,n(8),n(2))},function(e,t,n){(function(i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(4),r=n(9),l=n(111),c=n(10),d=i.createClass({displayName:"CreateNote",statics:{relCreateNote:function(e,t){
if(!e||!e.content)return!1;a("#app").scrollTop()>0&&a("#app").animate({scrollTop:0},200);var n=e.content,i=s.ContentUtil.filterContentFromOutside(e.content),o=s.ContentUtil.getLinksInContent(n),l=s.TimeUtil.time(),c=r.AppModel.generateSortby(),d=r.AppModel.generateID(c),u={gnid:d,title:e.title||s.ContentUtil.getTitle(e.content),content:i,source:e.source||"",device:e.device||(window._ENV&&_ENV.device?_ENV.device:""),publyc:0==e.publyc?0:1,removed:0,method:e.method||"",created:l,modified:l,sortby:c,bookmarks:o,images:null,imglist:e.images||[]},f=s.ContentUtil.getSummaryData(u.content);u.summary=f.text||"",a("body").hasClass("searching")&&s.WindowMessager.notifyCurrentPage("exit-search");var h=a.extend({is_new:!0},u);if(s.WindowMessager.notifyTabs("data-changed",{type:"new",notes:[h]}),s.WindowMessager.notifyTop({command:"note_saved",tmpId:e.tmpId,note:u}),1==e.publyc&&e.share){var g=r.UserModel.getLocalUser();g&&g.uid?r.NoteModel.timelyCreate(u,function(t){1==t.status&&s.WindowMessager.notifyTop({command:"share_note",url:r.NoteModel.getNoteUrl(u.gnid),tmpId:e.tmpId})}):(s.WindowMessager.notifyTop({command:"share_note",url:null,tmpId:e.tmpId}),alert("抱歉,使用此功能需要先登录"),s.LoginUtil.login(!1,function(e){1==e.status?(s.NotificationUtil.showMessage(s.LocaleUtil.translate("login_success")),s.WindowMessager.notifyTabs("user-changed"),location.reload()):s.NotificationUtil.showMessage(s.LocaleUtil.translate("login_error")+":"+e.status,"error")}),r.NoteModel.insert(u,t))}else r.NoteModel.insert(u,t)}},mixins:[l,c],getInitialState:function(){return{active:!1,publyc:0}},createNote:function(e){e&&e.preventDefault();var t=this.getContent(),n={content:t};n.publyc=this.state.publyc;this.constructor.relCreateNote(n),this.exit()},componentDidMount:function(){var e=a("#create_note .editable");a(e).focus(),a(e).on("keydown",this.handleKeydown),a(e).on("paste",this.handlePaste)},handlePaste:function(e){var t=this;e.preventDefault(),e=e.originalEvent;var n=e.clipboardData;s.CaretUtil.getCaretContainer()||a("#create_note .editable");s.ContentUtil.handleClipdataPaste(n,function(e){if(e&&e.html){var n=a("#create_note .editable");s.ContentUtil.pasteHtmlInEditable(e.html,n.get(0),t.insertContent)}},function(e){var n=e.okprogressID,i=t.progressBarExist(n),o=parseInt(e.loaded/e.total*100,10)+"%";i?(a(i).find(".pro").css({width:o}),"100%"==o&&a(i).remove()):t.insertProgressBar(n,o)})},progressBarExist:function(e){var t=o.findDOMNode(this),n=a("#upload_"+e,t);return n.length>0&&n.get(0)},insertProgressBar:function(e,t){var n=e,i=a("<div>",{"class":"uploadbar","data-id":n,id:"upload_"+n}).append(a("<div>",{}).append(a("<p>",{text:s.LocaleUtil.translate("uploading")})).append(a("<div>",{"class":"bar"}).append(a("<div>",{"class":"pro",style:"width:"+(t||0),text:"uploading"}))));return this.insertContent(a("<div>").append(i).html()),"100%"==t&&a("#upload_"+n).remove(),n},insertContent:function(e){e&&s.CaretUtil.pasteHtmlAtCaret(e)},getContent:function(){var e=a("#create_note .editable").html();return e=s.ContentUtil.removeSpaceBetweenTags(e)},handleKeydown:function(e){(e.ctrlKey||e.metaKey)&&83==e.keyCode&&(e.preventDefault(),this.createNote(e))},exit:function(){var e=a(o.findDOMNode(this)).find(".editable");a(e).empty(),a(e).blur(),this._setState({publyc:0,active:!1}),this.props.showEditingPanel()},togglePrivate:function(e){e.preventDefault(),this._setState({publyc:0==this.state.publyc?1:0})},render:function(){return this._render()}});t["default"]=d,e.exports=t["default"]}).call(t,n(2),n(3),n(11))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),o={_render:function(){var e="";return e+=this.state.active?" active":"",e+=0==this.state.publyc?" private":"",i.createElement("div",{id:"create_note",className:e},i.createElement("form",{className:"form"},i.createElement("div",{className:"field"},i.createElement("div",{className:"editable",contentEditable:"true",tabIndex:"0",spellCheck:"false"})),i.createElement("div",{className:"create-op"},i.createElement("div",{id:"private_btn"},i.createElement("a",{href:"#",onClick:this.togglePrivate},i.createElement("span",{className:"fp-icon-font fp-ext-done"})),i.createElement("span",null,a.LocaleUtil.translate("secret"))),i.createElement("div",{id:"cancel"},i.createElement("a",{onClick:this.exit,className:"cancel-btn",href:"#"},a.LocaleUtil.translate("cancel"))),i.createElement("div",{id:"save_btn",className:"btn"},i.createElement("input",{onClick:this.createNote,type:"submit",value:a.LocaleUtil.translate("save")})))))}};t["default"]=o,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(4),r=n(9),l=n(113),c=n(10),d=i.createClass({displayName:"DropDownMenu",mixins:[l,c],logout:function(){s.NotificationUtil.showMessage(s.LocaleUtil.translate("data_upload"),"loading",!1),r.NoteModel.flushQueue(function(e){s.NotificationUtil.hideMessage();var t=r.NoteModel.queueCount();if(t>0){var n=window.confirm(s.LocaleUtil.translate("upload_tips_f")+t+s.LocaleUtil.translate("upload_tips_b"));if(!n)return!1}else s.NotificationUtil.showMessage(s.LocaleUtil.translate("data_upload_complete"),"success");s.NotificationUtil.showMessage(s.LocaleUtil.translate("exiting"),"loading",!1),r.UserModel.logout(function(e){1==e.status?(s.NotificationUtil.showMessage(s.LocaleUtil.translate("exit_success"),"success"),s.WindowMessager.notifyTabs("user-changed"),location.reload()):s.NotificationUtil.showMessage(s.LocaleUtil.translate("exit_error"),"error")})})},setupAccount:function(e){e.preventDefault();var t=this,n=r.UserModel.getLocalUser();s.LoginUtil.login("edit",function(e,i){var a=r.UserModel.getLocalUser();a.mail&&(s.NotificationUtil.showMessage(s.LocaleUtil.translate("account_set_success")),n.uid!=a.uid&&(r.AppModel.clearLocalDB(),r.UserModel.setLocalUser(a),location.reload())),t._setState({profile:a})})},avatarError:function(){o.findDOMNode(this.refs.avatar).src=a.user_default_avatar},render:function(){return this._render()}});t["default"]=d,e.exports=t["default"]}).call(t,n(2),n(8),n(11))},function(e,t,n){(function(i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(n(9),n(4)),s={_render:function(){var e=this.props.user,t=o.ExtUtil.getCurrentExtVersion()||"",n=e.mail?e.mail:i.createElement("a",{href:"#",className:"perfect",onClick:this.setupAccount},o.LocaleUtil.translate("add_mailbox"));return i.createElement("div",{className:"drop-down-menu"},i.createElement("span",{className:"fp-icon-font fp-ext-close",onClick:this.props.showDropDown}),i.createElement("div",{className:"user-info"},i.createElement("div",{className:"avatar"},i.createElement("img",{ref:"avatar",src:e.avatar||a.user_default_avatar,onError:this.avatarError})),i.createElement("div",{className:"nick-name"},e.nickname||o.LocaleUtil.translate("no_nickname")),i.createElement("div",{className:"email"},n)),i.createElement("ul",{className:"op-menu"},i.createElement("li",null,i.createElement("a",{className:"settings",href:a.origin+"/settings",target:"_blank"},o.LocaleUtil.translate("settings"))),i.createElement("li",null,i.createElement("a",{className:"help",href:a.origin+"/help",target:"_blank"},o.LocaleUtil.translate("help"))),i.createElement("li",null,i.createElement("a",{className:"feedback",href:a.origin+"/feedback?product_version="+t+"&product=extension",target:"_blank"},o.LocaleUtil.translate("feedback"))),i.createElement("li",null,i.createElement("a",{className:"logout",onClick:this.logout,href:"#"},o.LocaleUtil.translate("logout")))))}};t["default"]=s,e.exports=t["default"]}).call(t,n(2),n(8))},function(e,t,n){(function(i,a,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(n(9),n(115)),l=n(10),c=i.createClass({displayName:"HeaderMenu",mixins:[r,l],getInitialState:function(){return{isDropDown:!1,isCreated:!1}},showEditingPanel:function(){this._setState({isCreated:!this.state.isCreated})},showDropDown:function(e){e.preventDefault(),this._setState({isDropDown:!this.state.isDropDown})},componentWillMount:function(){var e=this;a(document).on("mousedown",function(t){var n=t.target,i=e.refs.DropDownMenu;e.state.isDropDown&&(a.contains(o.findDOMNode(i),n)||e.showDropDown(t))})},avatarError:function(){o.findDOMNode(this.refs.avatar).src=s.user_default_avatar},render:function(){return this._render()}});t["default"]=c,e.exports=t["default"]}).call(t,n(2),n(3),n(11),n(8))},function(e,t,n){(function(i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),s=(n(9),n(4)),r={_render:function(){var e,t,n=this.props.user;return this.state.isDropDown&&(e=i.createElement(o.DropDownMenu,{user:n,ref:"DropDownMenu",showDropDown:this.showDropDown})),this.state.isCreated&&(t=i.createElement(o.CreateNote,{ref:"CreateNote",showEditingPanel:this.showEditingPanel})),i.createElement("div",{id:"header_menu"},i.createElement("div",{className:"left"},i.createElement("a",{href:"#",className:"jump fp-tooltips","data-tooltip":s.LocaleUtil.translate("ext_op_menu"),"data-placement":"bottom",onClick:this.showDropDown},i.createElement("img",{className:"avatar",ref:"avatar",src:n.avatar||a.user_default_avatar,onError:this.avatarError})),i.createElement("span",{className:"nickname"},n.nickname||s.LocaleUtil.translate("no_nickname"))),i.createElement("div",{className:"right"},i.createElement("a",{href:"#",className:"create-note-btn  fp-tooltips","data-tooltip":s.LocaleUtil.translate("create_note"),"data-placement":"bottom",onClick:this.showEditingPanel},i.createElement("span",{className:"fp-icon-font fp-ext-create"}))),t,e)}};t["default"]=r,e.exports=t["default"]}).call(t,n(2),n(8))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),o=n(117),s=n(10),r=i.createClass({displayName:"LoginMenu",mixins:[o,s],getInitialState:function(){return{isCreated:!1}},showEditingPanel:function(e){e.preventDefault(),this._setState({isCreated:!this.state.isCreated})},login:function(e){e.preventDefault(),a.LoginUtil.login(!1,function(e){1==e.status?(a.NotificationUtil.showMessage(a.LocaleUtil.translate("login_success")),a.WindowMessager.notifyTabs("user-changed"),location.reload()):a.NotificationUtil.showMessage(a.LocaleUtil.translate("login_error")+":"+e.status,"error")})},register:function(e){e.preventDefault(),a.LoginUtil.login(!0,function(e){1==e.status?(a.NotificationUtil.showMessage(a.LocaleUtil.translate("login_success")),a.WindowMessager.notifyTabs("user-changed"),location.reload()):a.NotificationUtil.showMessage(a.LocaleUtil.translate("register_error")+":"+e.statu,"error")})},render:function(){return this._render()}});t["default"]=r,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(12),o=n(4),s={_render:function(){var e="";return this.state.isCreated&&(e=i.createElement(a.CreateNote,{ref:"CreateNote",showEditingPanel:this.showEditingPanel})),i.createElement("div",{id:"login_menu"},i.createElement("div",{className:"left"},i.createElement("a",{className:"login",onClick:this.login,href:"#"},o.LocaleUtil.translate("login")),i.createElement("span",null,"/"),i.createElement("a",{className:"register",onClick:this.register,href:"#"},o.LocaleUtil.translate("register"))),i.createElement("div",{className:"right"},i.createElement("a",{href:"#",className:"create-note-btn fp-tooltips","data-tooltip":o.LocaleUtil.translate("create_note"),"data-placement":"bottom",onClick:this.showEditingPanel},i.createElement("span",{className:"fp-icon-font fp-ext-create"}))),e)}};t["default"]=s,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i,a,o,s){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var l=n(4),c=n(119),d=r(c),u=n(10),f=i.createClass({displayName:"ImageViewer",mixins:[d["default"],u],render:function(){var e=this.renderFn();return e},name:"image_viewer",statics:{imgW:"",imgH:""},getInitialState:function(){return{imgs:[],isCurrent:!1}},componentDidMount:function(){var e=this;l.WindowMessager.listenPageEvent("viewimage",function(t){e.state.opened||(e.openImageViewer(),e.props.handleOpen(e)),e._setState({opened:!0},function(){a(o.findDOMNode(e)).focus()}),e.start(t)}),a(window).on("resize",function(){e.state.opened&&(e.resizeTimeout&&clearTimeout(e.resizeTimeout),e.resizeTimeout=setTimeout(function(){var t=a(o.findDOMNode(e)).find("#maxid_image"),n=t[0].naturalWidth||t[0].width,i=t[0].naturalHeight||t[0].height;i&&n&&e.setContainerPos(n,i)},500))}),a(o.findDOMNode(e)).on("keydown",function(t){if(37==t.keyCode)e.prev(t);else if(39==t.keyCode)e.next(t);else if(38==t.keyCode){var n=o.findDOMNode(e.refs.scroll_con);a(o.findDOMNode(e.refs.scroll_con)).stop().animate({scrollTop:a(n).scrollTop()-(a(n).prop("scrollHeight")-a(n).height())/3})}else if(40==t.keyCode){var n=o.findDOMNode(e.refs.scroll_con);a(o.findDOMNode(e.refs.scroll_con)).stop().animate({scrollTop:a(n).scrollTop()+(a(n).prop("scrollHeight")-a(n).height())/3})}}),a(o.findDOMNode(e)).on("click",".fp-ext-download",function(){var t=a(o.findDOMNode(e)).find("#maxid_image");l.ImageUtil.downloadImages([t.attr("_src")||t.get(0).src])}),a("#image_viewer").on("click",function(t){var n=t.target;if(a(n).closest(".nav").length<=0){var i=a(o.findDOMNode(e)).find(".inner");e.state.opened&&i&&!a.contains(i.get(0),n)&&e.close(t)}})},openImageViewer:function(){a("body").addClass("view-image"),a("#image_viewer").showWithAnim("anim")},closeImageViewer:function(){a("body").removeClass("view-image"),a("#image_viewer").hide().removeClass("anim")},close:function(e){e&&e.preventDefault(),this._setState({opened:!1}),this.closeImageViewer(),this.props.handleClose(this);var t=o.findDOMNode(this.refs.img_node);t.src=""},start:function(e){a(e).addClass("current"),this.$imgs=a("#note_list .note-content img").filter(function(){return(this.width>=300||this.naturalWidth>=300||a(this).data("width")>=300)&&!a(this).parent().hasClass("media")}),this.$imgs=a(this.$imgs);var t;this.$imgs.each(function(n){return this==e&&a(this).hasClass("current")?(t=n,!1):void 0}),this.viewImgAtIndex(t)},viewImgAtIndex:function(e){var t=this;a("#note_list .note-content img.current").removeClass("current");var n=this.$imgs[e];a(n).addClass("current");var i=e-1>=0?e-1:0,r=e+1<=this.$imgs.length-1?e+1:this.$imgs.length-1,l=o.findDOMNode(this.refs.img_prev_node),c=o.findDOMNode(this.refs.img_next_node);e-1==-1?a(l).fadeOut():a(l).fadeIn(),e+1==this.$imgs.length?a(c).fadeOut():a(c).fadeIn(),a(l).data("index",i),a(c).data("index",r),n.src&&0!=n.src.indexOf("data:")&&this.loadImg(n),a(o.findDOMNode(t)).addClass("loading");var d=n.getAttribute("_src")||n.src;this.testImg(d,function(e){if(e)t.loadImg(e);else if(d.indexOf("//"+s.img_cdn_domain)<0){var i=null;n.src.indexOf("//"+s.img_cdn_domain)>=0?i=n.src:a(n).data("origin")&&a(n).data("origin").indexOf("//"+s.img_cdn_domain)>=0&&(i=a(n).data("origin")),i?t.testImg(i,function(e){t.loadImg(e),a(o.findDOMNode(t)).removeClass("loading")}):a(o.findDOMNode(t)).removeClass("loading")}else a(o.findDOMNode(t)).removeClass("loading");setTimeout(function(){a(o.findDOMNode(t)).removeClass("loading")},600)})},loadImg:function(e){var t=o.findDOMNode(this.refs.img_node),n=a(e).data("width"),i=a(e).data("width");n&&i||(n=e.naturalWidth||e.width,i=e.naturalHeight||e.height),this.imgW!=n||this.imgH!=i?this.setContainerPos(n,i):a(t).css({opacity:"1",transition:"none"}),t.src=e.src},testImg:function(e,t){e.indexOf(s.img_cdn_domain)>=0&&(e=l.ImageUtil.getFullsizeImgViaSrc(e));var n=new Image;n.onload=function(){t(n)},n.onerror=function(){t(!1),n.src=l.ImageUtil.getFullsizeImgViaSrc(e),n.onerror=null},n.src=e},setContainerPos:function(e,t){var n=a(o.findDOMNode(this)).find("#maxid_image");a(o.findDOMNode(this)).find(".fp-ext-download").length<=0&&n.after("<span class='fp-ext-download fp-tooltips' data-tooltip="+l.LocaleUtil.translate("download_img")+" data-placement='top'></span>"),this.imgW=e,this.imgH=t;var i,s,r,c,d=a("#image_viewer .con"),u=d.width(),f=d.height(),h=.7*u,g=f;if(e>=h){var p=t*(h/e);p>=g?(i=(u-h-20)/2,s=20):(i=(u-h-20)/2,s=(f-p-20)/2),r=h,c=p}else t>=g?(i=(u-e-20)/2,s=20):(i=(u-e-20)/2,s=(f-t-20)/2),r=e,c=t;var m=n.parents(".inner");m.css({width:r,height:c}),n.css({width:r,height:c,opacity:"",transition:""}),window.isTransformSupported?m.css({transform:"translate3d("+i+"px,"+s+"px,0)",transition:""}):m.css({left:i,top:s})},prev:function(e){e.preventDefault();var t=o.findDOMNode(this.refs.img_prev_node),n=a(t).data("index");this.viewImgAtIndex(n)},next:function(e){e.preventDefault();var t=o.findDOMNode(this.refs.img_next_node),n=a(t).data("index");this.viewImgAtIndex(n)}});t["default"]=f,e.exports=t["default"]}).call(t,n(2),n(3),n(11),n(8))},function(e,t,n){(function(n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={renderFn:function(){var e="widget",t="1";return this.state.isCurrent&&(t="0"),this.state.opened&&(e+=" opened"),n.createElement("div",{id:"image_viewer",tabIndex:"0",className:e,"data-hidden":t},n.createElement("div",{className:"mask"}),n.createElement("div",{className:"con",ref:"scroll_con"},n.createElement("div",{className:"inner"},n.createElement("img",{id:"maxid_image",ref:"img_node",src:""}))),n.createElement("div",{className:"nav"},n.createElement("a",{href:"#",className:"prev btn",ref:"img_prev_node",onClick:this.prev},n.createElement("span",{className:"fp-ext-left icon-font"})),n.createElement("a",{href:"#",className:"next btn",ref:"img_next_node",onClick:this.next},n.createElement("span",{className:"fp-ext-right icon-font"}))),n.createElement("a",{href:"#",className:"close btn",onClick:this.close},n.createElement("span",{className:"fp-ext-close icon-font"})))}};t["default"]=i,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i,a,o){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),l=n(121),c=s(l),d=n(10),u=i.createClass({displayName:"MediaViewer",mixins:[c["default"],d],name:"media_viewer",render:function(){var e=this.renderFn();return e},getInitialState:function(){return{}},componentDidMount:function(){var e=this;r.WindowMessager.listenPageEvent("viewMedia",function(t){e.state.opened||(e.openMediaViewer(),e.props.handleOpen(e)),e._setState({opened:!0},function(){a(o.findDOMNode(e)).focus()}),e.start(t)}),a("#media_viewer").on("click",function(t){var n=t.target,i=a(o.findDOMNode(e)).find(".inner");e.state.opened&&i&&!a.contains(i.get(0),n)&&e.close(t)})},start:function(e){var t=a(o.findDOMNode(this)).find(".inner"),n=o.findDOMNode(this.refs.media_node);a(n).css({width:"720px",height:"480px"});var i=a(e).data("media");i=this.setVideoAotoplay(i),a(n).attr("src",i),t.addClass("loading"),n.onload=n.onreadystatechange=function(){this.readyState&&"complete"!=this.readyState||(t.removeClass("loading"),a(n).css({opacity:1}))}},setVideoAotoplay:function(e){var t=a("<a href="+e+"></a>").get(0).host,n=e;return"player.youku.com"==t?n=e+"?autoplay=1":"v.qq.com"==t?n=e+"?autoplay=1":"www.letv.com"==t||"www.le.com"==t||("www.youtube.com"==t||"youtu.be"==t?n=e+"?autoplay=true":"player.vimeo.com"==t&&(n=e+"?autoplay=true")),n},openMediaViewer:function(){a("body").addClass("view-media"),a("#media_viewer").showWithAnim("anim")},closeMediaViewer:function(){a("body").removeClass("view-media"),a("#media_viewer").hide().removeClass("anim")},close:function(e){e&&e.preventDefault(),this._setState({opened:!1}),this.closeMediaViewer(),this.props.handleClose(this),a(o.findDOMNode(this.refs.media_node)).attr("src","")}});t["default"]=u,e.exports=t["default"]}).call(t,n(2),n(3),n(11))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(12),o={renderFn:function(){var e="widget",t="1";return this.state.isCurrent&&(t="0"),this.state.opened&&(e+=" opened"),i.createElement("div",{id:"media_viewer",tabIndex:"0",className:e,"data-hidden":t},i.createElement("div",{className:"mask"}),i.createElement("div",{className:"con",ref:"scroll_con"},i.createElement("div",{className:"inner"},i.createElement("iframe",{id:"maxid_media",ref:"media_node",src:""}),i.createElement(a.LoadingAnim,null))),i.createElement("a",{href:"#",className:"close btn",onClick:this.close},i.createElement("span",{className:"fp-ext-close icon-font"})))}};t["default"]=o,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i,a,o){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(123),l=s(r),c=n(4),d=i.createClass({displayName:"NoResult",mixins:[l["default"]],render:function(){var e=this.renderFn();return e},getInitialState:function(){return{}},componentDidMount:function(){var e=a(o.findDOMNode(this));e.on("click",".btn",function(){c.WindowMessager.notifyCurrentPage("newnote-active")})}});t["default"]=d,e.exports=t["default"]}).call(t,n(2),n(3),n(11))},function(e,t,n){(function(i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),s={renderFn:function(){var e="",t=o.LocaleUtil.translate("related_note"),n=o.LocaleUtil.translate("no_note"),s="fp-ext-tag-no-result";return i.createElement("div",{className:"note no-result "+e},i.createElement("div",{className:"main-cont"},i.createElement("div",{className:"des search"},i.createElement("div",{className:"sign-icon"},i.createElement("span",{className:"fp-ext-tag-no-result icon-font"})),i.createElement("span",null,t)),i.createElement("div",{className:"tag-result"},i.createElement("div",{className:"sign-icon"},i.createElement("span",{className:"icon-font "+s})),i.createElement("div",{className:"des"},n),i.createElement("div",{className:"help"},i.createElement("a",{href:a.origin+"/settings#help",target:"_blank",className:"btn"},o.LocaleUtil.translate("help"))))))}};t["default"]=s,e.exports=t["default"]}).call(t,n(2),n(8))},function(e,t,n){(function(a,o,s,r,l){"use strict";function c(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var d=n(4),u=n(9),f=n(12),h=n(125),g=c(h),p=n(272),m=n(10),v=a.createClass({displayName:"MCEEditor",mixins:[g["default"],m],noteData:null,render:function(){var e=this.renderFn();return e},getInitialState:function(){return{isCurrent:!1}},loadEditor:function(e,t){var n=this;if(window.tinymce)o.isFunction(e)&&e.call(null);else{n._setState({loading:!0});var i=document.createElement("script");i.onload=function(){n._setState({loading:!1}),n.initEditor(e)},i.onerror=function(){n._setState({loading:!1}),o.isFunction(t)&&t()},i.src="https://cdn.quickwis.com/common/js/tinymce/tinymce.js",document.body.appendChild(i)}},initEditor:function(e){var t=this;this.initializeMCE(function(){t.initMCEUI(),t.watchTitleField(),t.watchContentField(),t.setBindings(),t.dragMerge(),o.isFunction(e)&&e.call(null)})},dragMerge:function(){function e(){var e=w.offset();a=e.left,r=e.top,l=w.width(),c=0;var t=window.__MCEEDITOR.getBody().lastChild;if(t)if(3==t.nodeType){var n=document.createRange();n.selectNode(blocks[i]),c=n.getBoundingClientRect().bottom}else c=t.getBoundingClientRect().bottom;v={left:a,right:a+l,top:r,bottom:c}}function t(e){h=e.x,g=e.y;var t=g-v.top;if(h>v.left&&h<v.right){var n=w.get(0).contentDocument,i=n.getElementById("tinymce");if(m.show(),t>v.bottom)o(i).append(m);else if(25>=t)o(i).prepend(m);else{var a=p.getEntryPos(i,t);a&&o(a).after(m)}}else m.hide()}function n(e,t,n){h=t.x,g=t.y;g-v.top;if(h>v.left&&h<v.right){var i=f.NoteList._notes,a=o(n).index();if(a>=0&&i[a]){var r=i[a];u.NativeKVDB.get("dragMerge")||d.WindowMessager.notifyCurrentPage("show-merge-tips"),"false"==window.__MCEEDITOR.getBody().contentEditable&&p.enterEditMode(e);var l="";if(r.source){var c=d.UrlUtil.getDomainForUrl(r.source).toUpperCase();l='<div><span style="font-size: 12px;">'+d.LocaleUtil.translate("source_link")+": <a href="+r.source+">"+c+"</a></span></div><br/>"}m.addClass("to-be-removed");var w=m;if(m.closest("ul").length>0||m.closest("ol").length>0){var _=m.closest("ul").length>0?m.closest("ul").get(0):m.closest("ol").get(0),y=m.get(0),b=0==y.childNodes.length?0:y.childNodes.length,C=d.DomUtil.splitNode(_,y,b);C&&(w=o(C))}w.after("<div><br/></div><h2>"+r.title+"</h2>"+r.content+l),o(".to-be-removed",window.__MCEEDITOR.getBody()).remove(),p.triggerResize(),p.saveContent(),e.altKey||e.metaKey||d.WindowMessager.notifyCurrentPage("delete-note",{gnid:r.gnid})}else s.debug("拖拽合并","没找到贴纸")}m.remove()}var a,r,l,c,h,g,p=this,m=o("<div><div>").css({height:"10px",width:"100%",background:"#ffec00",opacity:"0.8"}),v={},w=o("#mce_instance_ifr");d.DragMerge.drag(".note .handle",{keepOrigin:!0},e,t,n)},getEntryPos:function(e,t){var n,i,a=this,s=e.childNodes;if(0==s.length)return e;if(1==s.length&&3==s[0].nodeType)return e;for(var r=0,l=s.length;l>r;r++){if(1==s[r].nodeType)n=s[r].getBoundingClientRect().top,i=o(s[r]).height();else if(3==s[r].nodeType){var c=document.createRange();c.selectNode(s[r]);var d=c.getBoundingClientRect();n=d.top,i=d.bottom-n}if(t>n&&n+i>t)return"false"==o(s[r]).attr("contenteditable")?s[r]:"false"==o(s[r]).closest("div").attr("contenteditable")?o(s[r]).closest("div"):a.getEntryPos(s[r],t)}},toggleSharePanel:function(e){var t=o("#note_share_content");"show"==e?t.addClass("show-mec-share"):(t.removeClass("show-mec-share"),o(".mce-note-share-panel").removeClass("secret"))},componentDidMount:function(){var e=this,t=r.findDOMNode(this);o(t).on("click",".mce-share",function(){var t=u.UserModel.getLocalUser();if(t&&t.uid){var n=e.getNote();e.creatQrcodeContent(n),e.toggleSharePanel("show")}else alert("抱歉,使用此功能需要先登录"),d.LoginUtil.login(!1,function(e){1==e.status?(d.NotificationUtil.showMessage(d.LocaleUtil.translate("login_success")),d.WindowMessager.notifyTabs("user-changed"),location.reload()):d.NotificationUtil.showMessage(d.LocaleUtil.translate("login_error")+":"+e.status,"error")})}),o(t).on("mousedown",function(e){var t=o(this).find(".share-bg").get(0);if(t){var n=o("#note_share_content");!o.contains(t,e.target)&&n.hasClass("show-mec-share")&&n.removeClass("show-mec-share")}}),o(t).on("click",".check-box",function(){if(event.preventDefault(),o(this).closest(".note-toggle-secret").toggleClass("checked"),o(this).closest(".note-toggle-secret").hasClass("checked")){o(".mce-note-share-panel").addClass("secret");var t={publyc:0};e.save(t)}else{o(".mce-note-share-panel").removeClass("secret");var t={publyc:1};e.save(t)}var n=e.getNote();e.creatQrcodeContent(n)}),o(t).on("click",".share-content a",function(t){if(t.preventDefault(),o(".mce-note-share-panel").hasClass("secret"))return!1;var n=o(this).data("app");n&&e.shareTo(n)}),d.WindowMessager.listenPageEvent("maximize",function(t){e.props.handleOpen(e),e.toggleSharePanel(),e.onOpen(),e.loadEditor(function(){if(e.state.noteComponent&&e.state.noteComponent.state.gnid!=t.state.gnid){var n=e.getNote();n.maximized=!1,n.modified>e.state.noteComponent.state.modified?d.WindowMessager.notifyTabs("data-changed",{type:"update",notes:[n]}):e.state.noteComponent._setState({maximized:!1})}else e.listenCursorChange();t&&(e.noteData=o.extend({},t.state)),e._setState({noteComponent:t},function(){this.triggerResize(),e.clearEditHistory()})},function(){d.NotificationUtil.showMessage(d.LocaleUtil.translate("load_editer_error"),"error"),t&&t._setState({maximized:!1}),e.close()})}),d.WindowMessager.listenPageEvent("minimize",function(t){e.close()}),d.WindowMessager.listenGlobalEvent("data-changed",function(t,n){return e.state.noteComponent?(s.log("editor:data-changed",t,n),void(t&&"update"==t.type&&o(t.notes).each(function(){var t=e.getNote();return this.gnid==t.gnid?((this.modified>t.modified||this.sortby>t.sortby)&&(1==this.removed?e.close():(e.noteData=o.extend({},this),e.updateData(this))),!1):void 0}))):!1}),d.PageUtil.pageActiveDetect(function(){},function(){if(e.state.noteComponent){var t=e.getNote();t.modified>e.state.noteComponent.state.modified&&(s.debug("editor:data-changed","贴纸切换时被更新了，通知其他tab更新"),setTimeout(function(){var e=o.extend({},t);d.WindowMessager.notifyTabs("data-changed",{type:"update",notes:[e]})},0))}})},creatQrcodeContent:function(e){var t=r.findDOMNode(this),n=o(t).find(".qrcode");n.empty(),e.publyc&&1==e.publyc?(o(".mce-note-share-panel").removeClass("secret"),n.css({"background-image":"none"}).qrcode({size:162,color:"#FFF",text:u.NoteModel.getNoteUrl(e.gnid)})):(o(".mce-note-share-panel").addClass("secret"),n.css({"background-image":"url("+p+")"}))},shareTo:function(e){event.preventDefault();var t=this,n=l.share_default_url,i=t.getNote();if(0!=i.publyc&&(n=u.NoteModel.getNoteUrl(i.gnid)),e)if("link"==e)t.copyLink(n);else{var a=o("<div><div/>").get(0).innerHTML=i.content,s=o(a).find("img").first().attr("src")||"";a=null;var r={title:i.title,content:i.content,img_url:s,share_url:n||""};d.ShareUtil.setShareInfo(r),d.ShareUtil.shareTo(e)}},copyLink:function(e){if(document.execCommand&&document.execCommand("copy")){var t=o("<input>",{id:"copy_input",style:"z-index:-199999;opacity:0;position:absolute;top: 100000000px;",value:e});o("body").append(t),t.focus().select(),document.execCommand("copy")?(d.NotificationUtil.showMessage(d.LocaleUtil.translate("copy_link_success")),t.remove()):window.prompt(d.LocaleUtil.translate("copy_link_tips"),e)}else window.prompt(d.LocaleUtil.translate("copy_link_tips"),e);o("#editor").addClass("editing-content")},initMCEUI:function(){this.insertTitleField(),this.insertMetaField(),this.insertShareContent(),this.insertSaveTips(),this.insertMinimizeBtn(),this.uploadimgInput(),window.__MCEEDITOR.getBody().style.paddingBottom="0px"},uploadimgInput:function(){var e='<input id="upload_img" type="file" accept="image/*" multiple style="position: absolute;cursor:pointer;width: 100%;left: 0;top: 0;opacity: 0;height: 100%;z-index: 99999;">',t=o(r.findDOMNode(this)).find(".mce-i-image");t.closest("button").after(o(e)),t.closest(".mce-widget").removeAttr("id")},setBindings:function(){var e=this;e.updateToolbarFloatOnScroll(),e.listenTodo(),e.listenDelete(),e.listenImageFileInsert(),o(window.__MCEEDITOR.getDoc()).on("dragstart",function(e){e.originalEvent.dataTransfer;window.top.postMessage({drag:"dragstart"},"*")}),o(window.__MCEEDITOR.getDoc()).on("dragend",function(){window.top.postMessage({drag:"dragend"},"*")})},listenImageFileInsert:function(){var e=this;o("#editor").on("change","#upload_img",function(t){for(var n,i=t.target.files,a=(e.getNote()&&e.getNote().id,window.__MCEEDITOR.selection.getRng(),0);n=i[a];a++)if(0==n.type.indexOf("image/")){var s=n.slice(0,n.size);s=new Blob([s],{type:n.type}),d.ContentUtil.handleImageFileInsert(s,function(t){if(t.html){e.insertContent(t.html);var n=window.__MCEEDITOR.getDoc().createElement("div"),i=window.__MCEEDITOR.getDoc().createElement("br");n.appendChild(i);var a=o("#img_"+t.domID,window.__MCEEDITOR.getDoc());a.length>0&&(a.after(n),e.DOMUtil.placeCaretAfterNode(n),a.removeAttr("id")),e.saveContent()}t.image&&e.save({imglist:[t.image]})},function(t){e.showUploadProgress(t)})}this.value=""}),o(window.__MCEEDITOR.getBody()).on("paste",e.handlePaste)},handlePaste:function(e){var t=this;e.preventDefault();var n=e.originalEvent,i=n.clipboardData,a=this.getNote();a&&a.id;d.ContentUtil.handleClipdataPaste(i,function(e){e&&(e.html&&(d.ContentUtil.pasteHtmlInEditable(e.html,window.__MCEEDITOR.getBody(),t.insertContent),t.addUndoHistory(),t.saveContent()),o.isArray(e.images)&&e.images.length>0?t.save({imglist:e.images}):d.ContentUtil.getImagesInContent(e.html,function(e){u.NoteModel.uploadImagesInNote(e,{content:t.getContentHtml()},function(e){e.imglist&&(o(e.imglist).each(function(e,t){var n=d.ImageUtil.getFullsizeImgViaSrc(t.url,t.size,t.width,t.height,t.type.indexOf("gif")>-1);o('img[src="'+t.url+'"]',window.__MCEEDITOR.getBody()).attr("src",n).attr("_src",t.url).attr("data-width",t.width).attr("data-height",t.height).removeAttr("data-mce-src")}),t.constructor._saveTimeout&&clearTimeout(t.constructor._saveTimeout),t.handleInput(e))})}))},function(e){t.showUploadProgress(e);
})},showUploadProgress:function(e){var t=e.okprogressID,n=this.progressBarExist(t),i=parseInt(e.loaded/e.total*100,10)+"%";n?(o(n).find(".pro").css({width:i}),"100%"==i&&o(n).remove()):this.insertProgressBar(t,i)},progressBarExist:function(e){var t=window.__MCEEDITOR.getBody(),n=o("#upload_"+e,t);return n.length>0&&n.get(0)},insertProgressBar:function(e,t){var n=e,i=o("<div>",{"class":"uploadbar","data-id":n,id:"upload_"+n}).append(o("<div>",{}).append(o("<p>",{text:d.LocaleUtil.translate("uploading")})).append(o("<div>",{"class":"bar"}).append(o("<div>",{"class":"pro",style:"width:"+(t||0),text:"uploading..."})))),a=o("<div>").append(i).html();this.insertContent(a);var s=this.progressBarExist(n);return this.DOMUtil.placeCaretAfterNode(s),"100%"==t&&s&&o(s).remove(),n},insertContent:function(e,t){if(t){var n=window.__MCEEDITOR.selection.getRng();if(n.startContainer){var i=o(n.startContainer).parentsUntil("body");if(i.length>0){var a=i.get(0),s=window.__MCEEDITOR.getDoc().createElement("div");a.nextSibling?a.parentNode.insertBefore(s,a.nextSibling):a.parentNode.appendChild(s);var r=window.__MCEEDITOR.getDoc().createRange();r.startContainer=s,r.endContainer=s,r.startOffset=0,r.endOffset=0;var l=window.__MCEEDITOR.selection.getSel();l.removeAllRanges(),l.addRange(r)}}}window.__MCEEDITOR.insertContent(e),this.triggerResize()},triggerResize:function(){setTimeout(function(){window.__MCEEDITOR&&window.__MCEEDITOR.execCommand("mceAutoResize")},500)},addUndoHistory:function(){window.__MCEEDITOR&&window.__MCEEDITOR.undoManager.add()},clearEditHistory:function(){window.__MCEEDITOR&&window.__MCEEDITOR.undoManager.clear()},listenDelete:function(){o(window.__MCEEDITOR.getBody()).on("keydown",function(e){if("8"==e.keyCode){var t=window.__MCEEDITOR.selection.getRng();if(t.collapsed&&0==t.startOffset){var n=o(t.startContainer).prev();0==n.length&&(n=o(t.startContainer.parentNode).prev()),n.length>0&&"false"==n.attr("contenteditable")&&n.remove()}}})},listenTodo:function(){var e=this;o(window.__MCEEDITOR.getBody()).on("mousedown",".todo-item",function(e){var t=18,n=23;o(this).hasClass("font-size-1")?(t=15,n=17):o(this).hasClass("font-size-2")?(t=18,n=23):o(this).hasClass("font-size-3")?(t=20,n=26):o(this).hasClass("font-size-4")?(t=24,n=32):o(this).hasClass("font-size-5")&&(t=30,n=41),o(e.target).hasClass("todo-item")||(t=1),e.offsetX<=t&&e.offsetY<=n&&e.preventDefault()}),o(window.__MCEEDITOR.getBody()).on("click",".todo-item",function(t){var n=18,i=23;o(this).hasClass("font-size-1")?(n=15,i=17):o(this).hasClass("font-size-2")?(n=18,i=23):o(this).hasClass("font-size-3")?(n=20,i=26):o(this).hasClass("font-size-4")?(n=24,i=32):o(this).hasClass("font-size-5")&&(n=30,i=41),o(t.target).hasClass("todo-item")||(n=1),t.offsetX<=n&&t.offsetY<=i&&(o(this).hasClass("done")?o(this).removeClass("done"):o(this).addClass("done"),e.addUndoHistory(),e.saveContent())})},setContentFieldMinHeight:function(){var e=o("#mce_instance_ifr");if(e.length>0){var t=o(window).height()-221;e.css("min-height",t+"px")}},insertTitleField:function(){var e=o(".mce-toolbar-grp");if(e.length>0&&0==o("#ok_note_title").length){var t=o("<div>",{id:"ok_note_title","class":"title-field"}).append(o("<input>",{placeholder:d.LocaleUtil.translate("no_title")}));e.after(t)}},insertMetaField:function(){var e=o(".mce-toolbar-grp");if(e.length>0&&0==o("#ok_note_meta").length){var t=o("<div>",{"class":"top-info",id:"ok_note_meta"}).append(o("<span>",{"class":"create-time",text:d.LocaleUtil.translate("create_time")+": "}).append(o("<span>",{"class":"create-time-date",text:""}))).append(o("<span>",{"class":"update-time",text:d.LocaleUtil.translate("modify_time")+": "}).append(o("<span>",{"class":"update-time-date",text:""})));e.append(t)}},insertSaveTips:function(){var e=o(".mce-last.mce-btn-group");if(e.length>0&&0==o("#fp_note_save_tips").length){var t=o("<div>",{"class":"top-info-save",id:"fp_note_save_tips"}).append(o("<span>",{"class":"saving",text:d.LocaleUtil.translate("saving")})).append(o("<span>",{"class":"saved",text:d.LocaleUtil.translate("saved")}));e.append(t)}},insertShareContent:function(){var e=o("#mceu_15-body"),t='<div class="mce-note-share-panel"><div class="share-bg"><div class="note-toggle-secret"><a class="check-box" href="#" ><span class="fp-ext-done"></span></a><span>'+d.LocaleUtil.translate("secret")+'</span><span class="tips">'+d.LocaleUtil.translate("secret_desc")+'</span></div><div class="share-content"><div class="qrcode"></div><ul><li><a href="#dt_weibo" data-app="weibo"><span class="fp-ext-weibo"></span></a></li><li><a href="#dt_qzone" data-app="qzone"><span class="fp-ext-zone"></span></a></li><li><a href="#dt_twitter" data-app="twitter"><span class="fp-ext-twitter"></span></a></li><li><a href="#dt_link" data-app="link"><span class="fp-ext-share-link"></span></a></li></ul></div></div></div>';if(e.length>0&&0==o("#note_share_content").length){var n=o("<div>",{id:"note_share_content"}).append(o("<span>",{"class":"mce-share",text:"分享"})).append(o(t));e.append(n)}},insertMinimizeBtn:function(){var e=this,t=o(".mce-toolbar-grp");if(t.length>0){var n=o("<a>",{href:"#","class":"minimize"}).append(o("<span>",{"class":"icon-font fp-ext-shrink fp-tooltips",style:"font-family:'icomoon'","data-tooltip":"最小化编辑器","data-placement":"left"}));n.on("click",function(t){t.preventDefault(),e.onMinimize(t)}),t.append(n)}},updateUIOnResize:function(e){var t=this,n=null;e?o(window).on("resize.editor",function(){n&&clearTimeout(n),n=setTimeout(function(){t.setContentFieldMinHeight();var e=o(".mce-toolbar-grp");e.width(o(".spaceholder").width())},300)}):o(window).off("resize.editor")},updateNoteMeta:function(e){var t=d.TimeUtil.getLocaleDate(1e3*e.created),n=d.TimeUtil.getLocaleDate(1e3*e.modified);o(".top-info .create-time-date").text(t||""),t!=n?o(".top-info .update-time").show().find(".update-time-date").text(n||""):o(".top-info .update-time").hide()},updateToolbarFloatOnScroll:function(){var e=this,t=o(".mce-toolbar-grp");if(0==t.length)return!1;var n=o(".mce-toolbar-grp .mce-btn");if(n.length>0&&"block"==n.css("display"))return setTimeout(function(){e.updateToolbarFloatOnScroll()},1e3),!1;var i=parseInt(o("#editor_con").css("padding-top"),10);i=isNaN(i)?0:i;var a=0,s=t.height()?t.innerHeight():0,r=o("<div>",{id:"toolbar_placeholder"}).css({height:s-i+"px",display:"none"});0==o("#toolbar_placeholder").length&&t.before(r),o("#widgets").on("scroll.editor",function(){e.state.noteComponent&&(this.scrollTop>=a?t.hasClass("fixed")||(t.width(t.width()).addClass("fixed").css({position:"fixed",top:a+"px"}),s||r.height(t.outerHeight()-i),r.show()):(t.width(t.width()).removeClass("fixed").css({position:""}),r.hide()))})},onMinimize:function(e){e.preventDefault(),this.close()},onOpen:function(){var e=o("#editor_con");setTimeout(function(){e.css("transform","none")},1e3),this.unmarkModified(),this.unmarkDirty(),this.updateUIOnResize(!0),this.setContentFieldMinHeight(),window.__MCEEDITOR&&window.__MCEEDITOR.setDisabled()},listenCursorChange:function(e){if(e)o(document).off("keydown.dragmerge").off("keyup.dragmerge"),window.__MCEEDITOR&&o(window.__MCEEDITOR.getDoc()).off("keydown.dragmerge").off("keyup.dragmerge"),o(document).off("mousemove.dragmerge"),o(document).off("mouseenter.dragmerge").off("mouseleave.dragmerge");else{var t=window.__MCEEDITOR?window.__MCEEDITOR.getDoc():[];o(document).add(t).off("keydown.dragmerge").off("keyup.dragmerge").on("keydown.dragmerge keyup.dragmerge",function(e){"keydown"==e.type?(e.altKey||e.metaKey)&&o(".note .handle.hover").closest(".note").addClass("copy"):o(".note .handle.hover").closest(".note").removeClass("copy")}),o(document).off("mousemove.dragmerge").on("mousemove.dragmerge",".note .handle",function(e){e.altKey||e.metaKey?o(this).closest(".note").addClass("copy"):o(this).closest(".note").removeClass("copy")}),o(document).off("mouseenter.dragmerge").off("mouseleave.dragmerge").on("mouseleave.dragmerge mouseenter.dragmerge",".note .handle",function(e){"mouseenter"==e.type?o(this).addClass("hover"):o(this).removeClass("hover")})}},closeEditorWindow:function(){o("#editor").hide().removeClass("anim"),o("body").removeClass("open-editor")},close:function(){if(this.listenCursorChange(!0),d.AudioPlayer.isPlaying()&&d.AudioPlayer.pause(),this.constructor._saveTimeout&&(clearTimeout(this.constructor._saveTimeout),this.constructor._saveTimeout=null),this.state.noteComponent){this.saveTitle(!0),this.saveContent(!0);var e=this.getNote();e.maximized=!1,e.modified>this.state.noteComponent.state.modified?d.WindowMessager.notifyTabs("data-changed",{type:"update",notes:[e]}):this.state.noteComponent._setState({maximized:!1}),this._setState({noteComponent:null})}var t=o("#editor_con");t.css("transform",""),this.updateUIOnResize(!1),o(r.findDOMNode(this)).removeClass("editing-content"),this.closeEditorWindow(),this.props.handleClose(this),this.clearEditHistory()},addCustomWidgets:function(e){var t=this;e.addButton("uploadimg",{icon:"image",tooltip:"Upload Image"}),e.addButton("todolist",{icon:"task",tooltip:"Insert Todolist",stateSelector:"li.todo-item",onclick:function(){var n=e.selection.getRng(),i=n.endOffset,a=n.startOffset,r=(n.collapsed,n.startContainer),l=n.endContainer,c=t.DOMUtil.getSelectedVisualBlocks();0==c.length&&(s.debug("insertlist","插入todo list时选中的block长度为0"),c.push(n.startContainer));var u=!0;if(o(c).each(function(){return o(this).hasClass("todo-item")||0!=o(this).closest("li.todo-item").length?void 0:(u=!1,!1)}),u){var f=document.createElement("div");o(c).each(function(e){if(0==e){var t=o(this).closest("ul").get(0)||o(this).closest("ol").get(0);t?d.DomUtil.splitList(t,this,f):this.parentNode.insertBefore(f,this)}var n=o(this).hasClass("todo-item")?this:o(this).closest("li.todo-item").get(0);if(n){var i=o(n).contents(),a=document.createElement("div");o(i).each(function(){a.appendChild(this)}),f.appendChild(a),d.DomUtil.containsBlock(a)&&d.DomUtil.unwrapNode(a),o(n).remove()}}),d.DomUtil.unwrapNode(f)}else t.DOMUtil.insertList("todo"),t.resizeLiFont();t.DOMUtil.restoreCursor(r,a,l,i),t.addUndoHistory(),t.saveContent()}})},listenCommand:function(e){var t=this;e.on("ExecCommand",function(n){var i=n.command;n.value;switch(i){case"FontSize":t.resizeLiFont();break;case"mceToggleFormat":break;case"mceBlockQuote":var a=!1;o("blockquote",e.getDoc()).each(function(){o("li",this).each(function(){o(this).removeClass("font-size-1 font-size-2 font-size-3 font-size-4 font-size-5"),a=!0}),o("span",this).each(function(){"15px"!=o(this).css("font-size")&&(o(this).css("font-size","15px").removeAttr("data-mce-style"),a=!0)})}),a&&t.addUndoHistory();break;case"undo":break;case"redo":break;case"InsertUnorderedList":t.resizeLiFont();break;case"InsertOrderedList":t.resizeLiFont();break;case"InsertHorizontalRule":break;case"mceInsertContent":}"mceAutoResize"!=i&&t.saveContent()}),e.on("BeforeExecCommand",function(n){var i=n.command;n.value;switch(i){case"FontSize":var a=window.__MCEEDITOR.selection.getRng(),s=o(a.startContainer).closest("blockquote"),r=o(a.endContainer).closest("blockquote");if(s.length>0&&r.length>0&&s.get(0)==r.get(0))return alert("引用中不允许自定义字体大小"),!1;break;case"InsertUnorderedList":var l=t.fixConflictWithTodoList("ul");if(l)return t.resizeLiFont(),t.saveContent(),!1;break;case"InsertOrderedList":var l=t.fixConflictWithTodoList("ol");if(l)return t.resizeLiFont(),t.saveContent(),!1;break;case"InsertHorizontalRule":var a=e.selection.getRng();if(a&&a.startContainer&&o(a.startContainer).closest("li").length>0)return o(a.startContainer).closest("li").after("<hr>"),t.addUndoHistory(),!1}}),e.on("BeforeAddUndo",function(e){return e.lastLevel&&e.level&&"string"==typeof e.lastLevel.content&&"string"==typeof e.level.content&&e.lastLevel.content.indexOf("uploadbar")<0&&e.level.content.indexOf("uploadbar")>=0?!1:void 0})},initializeMCE:function(e){var t=this;window.tinymce&&!window.__MCEEDITOR&&window.tinymce.init({selector:"textarea#mce_instance",menubar:!1,statusbar:!1,elementpath:!1,object_resizing:!1,content_css:"./editor.css",plugins:["link autoresize hr"],toolbar:"fontsizeselect | blockquote bold italic | todolist bullist numlist | unlink link uploadimg hr | undo redo ",fontsize_formats:"12px 16px 18px 22px 28px",resize:!1,language:"zh_CN",force_br_newlines:!1,force_p_newlines:!0,forced_root_block:"div",body_padding:80,element_format:"html",extended_valid_elements:"img[_src|src|alt|title|data-width|data-height|data-video],a[href|class|title|data-translated|data-media|data-type|data-duration]",init_instance_callback:function(n){window.__MCEEDITOR=n,window.__MCEEDITOR.setDisabled=t.disableEditor,window.__MCEEDITOR.setEnabled=t.enableEditor,o.isFunction(e)&&e.call(null,n)},setup:function(e){t.addCustomWidgets(e),t.listenCommand(e)}})},fixConflictWithTodoList:function(e){var t=window.__MCEEDITOR.selection.getSelectedBlocks(),n=!1;if(o(t).each(function(){o(this).closest(".todo-item").length>0&&(o(this).closest(".todo-item").removeAttr("class"),n=!0),o(this).hasClass("todo-item")&&(n=!0,o(this).removeAttr("class")),o(this).find(".todo-item").length>0&&(n=!0,o(this).find(".todo-item").removeAttr("todo-item"))}),n&&("ul"==e||"ol"==e)){var i=window.__MCEEDITOR.selection.getRng(),a=i.endOffset,s=i.startOffset,r=(i.collapsed,i.startContainer),l=i.endContainer;this.DOMUtil.insertList(e),this.DOMUtil.restoreCursor(r,s,l,a),this.addUndoHistory();var c=!0;return c}},toggleTodo:function(e){var t=!1,n=!1,i=!1,a={},s=window.__MCEEDITOR.selection.getRng(),r=s.collapsed,l=s.endContainer,c=s.startContainer;if(r||l==c){var d=s.startContainer;if("LI"==d.tagName&&o(d).hasClass("todo-item"))o(d).removeClass("todo-item"),t=!0,o(d).closest("ul").length>0?n=!0:o(d).closest("ol").length>0&&(i=!0);else if(o(d).closest("li.todo-item").length>0){var u=o(d).closest("li.todo-item");u.removeClass("todo-item"),t=!0,u.closest("ul").length>0?n=!0:u.closest("ol").length>0&&(i=!0)}}return a={bool:t,isUl:n,isOl:i}},replaceDom:function(e){var t=document.createElement("div");o(t).attr("data-mark","mark");var n=o(e).contents();o(t).append(n),o(e).replaceWith(t)},resizeLiFont:function(){o("li",window.__MCEEDITOR.getDoc()).each(function(e,t){var n=[],i=o("span",t);if(1==i.length&&o.trim(i.text())==o.trim(o(t).text())&&n.push(i.css("font-size")),n=o.unique(n),1==n.length){var a=l.fontsize_level[n[0]];a&&o(t).removeClass("font-size-1 font-size-2 font-size-3 font-size-4 font-size-5").addClass("font-size-"+a)}})},resizeListitemSymbol:function(e){var t=this,n=window.__MCEEDITOR.selection.getRng(),i=null;if(n&&n.commonAncestorContainer&&(i=o(n.commonAncestorContainer).is("li")?o(n.commonAncestorContainer):null,i||(i=o(n.commonAncestorContainer).find("li").length>0?o(n.commonAncestorContainer).find("li"):null),i||(i=o(n.commonAncestorContainer).closest("li").length>0?o(n.commonAncestorContainer).closest("li"):null)),i&&i.length>0){var a=window.__MCEEDITOR.selection.getSel();i.each(function(n,i){var s=t.DOMUtil.selectionContainsFullNode(a,this);s&&o(this).removeClass("font-size-1 font-size-2 font-size-3 font-size-4 font-size-5").addClass("font-size-"+e)})}},getFirstTextNode:function(e){return e&&1==e.nodeType?(e=e.firstChild,this.getFirstTextNode(e)):e&&3==e.nodeType?e:void 0},getlastTextNode:function(e){return e&&1==e.nodeType?(e=e.lastChild,this.getlastTextNode(e)):e&&3==e.nodeType?e:void 0},enterReadMode:function(){window.__MCEEDITOR.setDisabled();var e=d.ContentUtil.processContent(this.getContentHtml());this.setContentHtml(e)},enterEditMode:function(){"false"==window.__MCEEDITOR.getBody().contentEditable&&(d.ContentUtil.restoreContent(window.__MCEEDITOR.getBody()),window.__MCEEDITOR.setEnabled()),o(r.findDOMNode(this)).addClass("editing-content")},enableEditor:function(){window.__MCEEDITOR&&window.__MCEEDITOR.getBody().setAttribute("contenteditable","true")},disableEditor:function(){window.__MCEEDITOR&&window.__MCEEDITOR.getBody().setAttribute("contenteditable","false")},watchContentField:function(){var e=this,t=window.__MCEEDITOR.getBody();o(t).on("click","a",function(e){e.preventDefault();var n=o(this).data("media");if(n){var i=o(this).data("type"),a=o(this).closest(".media");/audio/.test(i)&&(d.AudioPlayer.isPlaying(n)?(d.AudioPlayer.pause(),a.removeClass("playing")):(a.addClass("loading"),d.AudioPlayer.play(n,function(e){switch(e){case"playing":case"timeupdate":case"loadedmetadata":a.addClass("playing").removeClass("loading");break;case"ended":case"pause":a.removeClass("playing");break;case"error":a.removeClass("loading").addClass("error").removeClass("playing")}})))}else if("false"==t.contentEditable){var s=o(this).attr("href");if(o(e.target).hasClass("fp-ext-zoom-in"))return!1;"#"!=s&&window.open(this.href)}}),o(t).on("mousedown",function(n){var i=n.target,a=i.tagName&&("A"==i.tagName||"IMG"==i.tagName),s=o(i).hasClass("ok-extension-download");a||s||"false"!=t.contentEditable||e.enterEditMode(n);var r=o("#note_share_content");r.hasClass("show-mec-share")&&r.removeClass("show-mec-share")}).on("click",function(n){if("false"==t.contentEditable){var i=n.target;if(o(i).hasClass("dl")||o(i).parent().hasClass("dl")){n.preventDefault();var a=o(i).closest(".img").find("img");return void(a.length>0&&d.ImageUtil.downloadImages([a.attr("_src")||a.get(0).src]))}switch(i.tagName){case"A":n.preventDefault();var s=i.getAttribute("href");"#"!=s&&window.open(i.href);break;case"IMG":}}else if(t.contentEditable){var r=window.__MCEEDITOR.selection.getRng(),l=(r.collapsed,n.pageY),c=t.lastChild;t.firstChild;if(c){var u=o(c).height(),f=c.offsetTop;if(l>f+u){var h=null;if(e.isEmptyLine(c))h=c;else{var h=document.createElement("div"),g=document.createElement("br");g.setAttribute("data-mce-bogus",1),h.appendChild(g),t.appendChild(h)}var p=window.__MCEEDITOR.getDoc().createRange();p.setStart(h,0),p.setEnd(h,0);var m=window.__MCEEDITOR.getWin().getSelection();m.removeAllRanges(),m.addRange(p)}}}}).on("keydown",function(t){(t.ctrlKey||t.metaKey)&&83==t.keyCode?(t.preventDefault(),e.saveContent()):8!=t.keyCode&&13!=t.keyCode||(e.markAsModified(),e.saveContent())}).on("input",function(){e.markAsModified(),e.saveContent()}).on("keyup",function(e){o(window.__MCEEDITOR.getBody()).find(".img").each(function(){0==o(this).find("img").length&&o(this).removeAttr("class").find("a.dl").remove()})}),window.__MCEEDITOR.on("focus",function(){o(r.findDOMNode(e)).addClass("editing-content")}).on("blur",function(t){o(r.findDOMNode(e)).hasClass("editing-content")&&(e.saveContent(),e.enterReadMode(),o(r.findDOMNode(e)).removeClass("editing-content"))}).on("ObjectSelected",function(){"false"==t.contentEditable&&e.enterEditMode(event)})},isEmptyLine:function(e){return e?o(e.firstChild).is("br")||"&nbsp;"==o(e).html():!1},deferSave:function(e){var t=this;this.markAsModified(),t.constructor._saveTimeout&&clearTimeout(t.constructor._saveTimeout),t.constructor._saveTimeout=setTimeout(function(){t.saveContent()},e||l.save_delay)},watchTitleField:function(){var e=this;o("#editor_con .title-field input").on("focus",function(){o(this).addClass("editing")}).on("blur",function(t){o(this).removeClass("editing"),e.saveTitle(!0)}).on("input",function(t){e.saveTitle(!1)}).on("keydown",function(t){(t.ctrlKey||t.metaKey)&&83==t.keyCode&&(t.preventDefault(),e.saveTitle(!0))})},setContentHtml:function(e){window.__MCEEDITOR.getBody().innerHTML=e},getContentHtml:function(){var e=window.__MCEEDITOR.getContent();return e=d.ContentUtil.removeSpaceBetweenTags(e),e=d.ContentUtil.removeEmptyTag(e)},getNote:function(){var e=this.state.noteComponent&&this.state.noteComponent.state;return this.noteData&&this.noteData.gnid==e.gnid?this.noteData:(this.noteData=o.extend({},e),this.noteData)},getTitleValue:function(){return o("#editor_con .title-field input").val()||""},handleInput:function(e){var t=this;if(this.constructor._saveTimeout){var n=this.constructor._delayedProps[this.constructor._saveTimeout];n&&(e=o.extend({},n,e)),clearTimeout(this.constructor._saveTimeout)}else this.constructor._delayedProps||(this.constructor._delayedProps={});this.constructor._saveTimeout=setTimeout(function(){t.save(e),delete t.constructor._delayedProps[t.constructor._saveTimeout]},l.save_delay),this.constructor._delayedProps[this.constructor._saveTimeout]=e},saveTitle:function(e){o("#editor_con .title-field input").removeClass("editing modified");var t=this.getTitleValue(),n=this.getNote();if(n&&t!=n.title){var i={title:t};e?this.save(i):this.handleInput(i)}},isModified:function(){return o("#editor").hasClass("content-modified")},unmarkModified:function(){o("#editor").removeClass("content-modified")},markAsModified:function(){o("#editor").addClass("content-modified"),this.markDirty()},markDirty:function(){o("#editor").addClass("dirty")},unmarkDirty:function(){o("#editor").removeClass("dirty")},saveContent:function(e){var t=this,n=this.getContentHtml(),i=this.getNote();if(i&&n!=i.content){t.isModified()||t.markAsModified();var a={content:n};return e?this.save(a):this.handleInput(a)}},save:function(e){var t=this.getNote();e.gnid=t.gnid,e.sortby=t.sortby,e.content&&(e.content=d.ContentUtil.filterContentFromOutside(e.content));var n=u.NoteModel.update(e);return this.noteData=o.extend(this.noteData,n),n?("string"==typeof e.content&&this.unmarkModified(),n):void 0},componentDidUpdate:function(e,t){var n=t.noteComponent?t.noteComponent.state:null,i=this.state.noteComponent?this.state.noteComponent.state:null;i&&(n&&n.gnid==i.gnid&&n.title==i.title&&n.content==i.content||this.updateData(i))},updateData:function(e){if(o("#editor_con .title-field input").val(e.title),window.__MCEEDITOR){var t=d.ContentUtil.processContent(e.content);this.setContentHtml(t),this.setContentFieldMinHeight()}this.updateNoteMeta(e),0==e.publyc?o("#editor_con .note-toggle-secret").addClass("checked"):o("#editor_con .note-toggle-secret").removeClass("checked")},DOMUtil:{hasChildNodeInSelection:function(e,t){if(!e||0==e.childNodes.length)return!1;var n=this,i=!1;return t.containsNode&&o(e.childNodes).each(function(){return t.containsNode(this)?(i=!0,!1):n.hasChildNodeInSelection(this,t)?(i=!0,!1):void 0}),i},getSelectedVisualBlocks:function(e){if(!window.__MCEEDITOR)return[];e||(e=window.__MCEEDITOR.selection.getSelectedBlocks());for(var t=[],n=null,i=0,a=e.length;a>i;i++)if(n=e[i])if(d.DomUtil.containsBlock(n)){var s=d.DomUtil.textBlockInNode(n);s.length>0&&(t=t.concat(s))}else if(d.DomUtil.textBlockInNode(n).length>1){var r=this.getSelectedVisualBlocks(n.childNodes);r.length>0&&(t=t.concat(r))}else if(d.DomUtil.isBlock(n))t.indexOf(n)<0&&t.push(n);else if(d.DomUtil.isTextBlock(n))t.indexOf(n)<0&&!o(n).is("br")&&t.push(n);else{if(o(n).is("br"))continue;var l=document.createElement("div");if(n){n.parentNode.insertBefore(l,n);var c=n.nextSibling;if(l.appendChild(n),c){for(;c&&!d.DomUtil.isTextBlock(c);)l.appendChild(c),c=c.nextSibling,i++;c&&(l.appendChild(c),i++)}t.indexOf(n)<0&&t.push(l)}}var u=window.__MCEEDITOR.selection.getSel(),f=this;return u.containsNode&&o(t).each(function(e,n){u.containsNode(n)||f.hasChildNodeInSelection(n,u)||t.splice(e,1)}),t},insertList:function(e){e=e||"ul";var t="todo"==e?"ul":e,n=this.getSelectedVisualBlocks()||[];if(0==n.length){var i=window.__MCEEDITOR.selection.getRng();s.debug("insertlist","插入list时选中的block长度为0"),n.push(i.startContainer)}var a=null,r=null,l=document.createElement(t);return o(n).each(function(t,n){if(n){if(0==t){var i=o(this).closest("ul").get(0)||o(this).closest("ol").get(0);i?a=d.DomUtil.splitList(i,n,l):this.parentNode.insertBefore(l,this)}this.tagName&&"LI"==this.tagName?r=this:o(this).closest("li").length>0?r=o(this).closest("li").get(0):(d.DomUtil.isTextBlock(this)&&o(this).next().is("br")&&o(this).next().remove(),r=document.createElement("li"),r.appendChild(this)),"todo"==e&&o(r).addClass("todo-item"),l.appendChild(r)}}),a&&o(a).each(function(){this&&0==this.childNodes.length&&o(this).remove()}),l},selectionContainsFullNode:function(e,t){var n=!0;if(e.rangeCount>0){var i="";return o(e.getRangeAt(0).cloneContents().childNodes).each(function(){i+=o("<div>").append(this).html()}),i.indexOf(o(t).html())>=0?!0:1==t.childNodes.length?i.indexOf(o(t.childNodes[0]).html())>=0:!1}return 1==t.childNodes.length?e.containsNode(t.childNodes[0])||(n=this.selectionContainsFullNode(e,t.childNodes[0])):o(t.childNodes).each(function(){return e.containsNode(this)?void 0:(n=!1,!1)}),n},placeCaretAfterNode:function(e){if(e){var t=(window.__MCEEDITOR.selection.getRng(),window.__MCEEDITOR.selection.getSel(),window.__MCEEDITOR.getDoc().createRange(),null);if(e.nextSibling)t=e.nextSibling;else{var n=window.__MCEEDITOR.getDoc().createElement("span");e.parentNode.appendChild(n),t=n}t&&this.restoreCursor(t,0,t,0)}},restoreCursor:function(e,t,n,i){if(window.getSelection){var a=window.__MCEEDITOR.getDoc().createRange();a.setStart(e,t),a.setEnd(n,i);var o=window.__MCEEDITOR.getWin().getSelection();o.removeAllRanges(),window.__MCEEDITOR.getDoc().contains(a.startContainer)&&window.__MCEEDITOR.getDoc().contains(a.endContainer)&&o.addRange(a)}}}});t["default"]=v,e.exports=t["default"]}).call(t,n(2),n(3),n(13),n(11),n(8))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(12),o={renderFn:function(){var e="widget",t="1";this.state.isCurrent&&(t="0");var n="";return this.state.loading&&(n=i.createElement(a.LoadingAnim,null)),i.createElement("div",{id:"editor",className:e,"data-hidden":t},i.createElement("div",{id:"editor_con"},i.createElement("div",{className:"spaceholder"},i.createElement("textarea",{id:"mce_instance"}),n)))}};t["default"]=o,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i,a,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),l=n(9),c=n(12),d=n(127),u=n(10),f=i.createClass({displayName:"Note",mixins:[d,u],getInitialState:function(){var e=this.constructNoteState(this.props.note);return e.showExpand=!1,e.isDeleting=!1,e.maximized=!1,e.opened=!1,e},handleOpen:function(e){e&&e.preventDefault();var t=this,n="",i=a(o.findDOMNode(this)).find(".note-content").get(0);if(n=a(i).css("max-height"),this.state.opened){a(i).css({"max-height":a(i).data("maxHeight")});var s=a(o.findDOMNode(this)).offset();if(s.top<0){document.body.scrollTop>0&&a(document.body).animate({scrollTop:document.body.scrollTop+s.top-60},300,function(){a(o.findDOMNode(t)).addClass("glowing"),setTimeout(function(){a(o.findDOMNode(t)).removeClass("glowing")},2500)});var r=a("#app").get(0);a(r).animate({scrollTop:r.scrollTop+s.top-60},300,function(){a(o.findDOMNode(t)).addClass("glowing"),setTimeout(function(){a(o.findDOMNode(t)).removeClass("glowing")},2500)})}}else a(i).data("maxHeight",n),a(i).css({"max-height":"inherit"});this._setState({opened:!this.state.opened})},constructNoteState:function(e){var t=a.extend({},e);return t._content=r.ContentUtil.processContent(t.content),t._content=r.LazyLoad.makeUrl(t._content),t},componentWillUnmount:function(){var e=a("#note_list .note").length;5>e&&r.WindowMessager.notifyCurrentPage("loadmore")},componentDidMount:function(){var e=this;e.initLayout(),a(document.body).hasClass("firefox")&&r.WindowMessager.listenPageEvent("appopen",function(t){e.initLayout()}),r.WindowMessager.listenPageEvent("delete-note",function(t){t.gnid&&e.state.gnid==t.gnid&&e.deleteNote()})},initLayout:function(){var e=this,t=a(o.findDOMNode(this)).find(".note-content").get(0),n=a(t).prop("scrollHeight"),i=this.calcMaxHeight();n>i?this._setState({showExpand:!0}):this._setState({showExpand:!1}),a(t).css({"max-height":i+"px"}),a(t).data("maxHeight",i);var l,c,d,u=a(".note-content img",o.findDOMNode(this)).first();if(u.length){u.parent().hasClass("media")&&(d=!0);var f=u.height();f||u.on("load",function(){l=this.naturalWidth||this.width,c=this.naturalHeight||this.height;var n=l/c;d?(a(this).addClass("img big-img"),u.parent().find(".media-cover").length<=0&&a(this).after('<span class="media-cover"></span>')):(a(this).wrap("<div class='img big-img'></div>"),a(this).css({width:s.content_img_maxwidth+"px",height:s.content_img_maxwidth/n+"px"}),l>300&&a(this).after('<span class="img-icon icon-font fp-ext-zoom-in fp-tooltips" data-tooltip='+r.LocaleUtil.translate("view_big_img")+' data-placement="top"></span>')),u.attr("data-width",l),u.attr("data-height",c);var i=a(t).prop("scrollHeight"),o=e.calcMaxHeight();i>o?e._setState({showExpand:!0}):e._setState({showExpand:!1}),a(t).css({"max-height":o+"px"}),a(t).data("maxHeight",o)})}},calcMaxHeight:function(){var e=a(o.findDOMNode(this)).find(".note-content").get(0),t=a(o.findDOMNode(this)).find(".note-content .img.big-img").get(0);if(!t)return a(e).prop("scrollHeight")>119?120:a(e).prop("scrollHeight");var n=256,i=t.offsetTop-e.offsetTop;if(i>119)return 120;if(0==i){var s=a(t).height();return s}if(i>0&&119>i){var s=a(t).height();return s>=n?n+i:s+i}},componentDidUpdate:function(e,t){if(this.state.content!=t.content){var n=a(o.findDOMNode(this)).find("img");n.length>0&&r.LazyLoad.lazyLoad(n);var i=a(o.findDOMNode(this)).find(".note-content").get(0),s=a(i).prop("scrollHeight"),l=this.calcMaxHeight(),c=!1;s>l&&(c=!0),a(i).data("maxHeight",l),t.opened?t.showExpand?a(i).css({"max-height":s}):(a(i).css({"max-height":l}),s>l&&this._setState({opened:!1})):a(i).css({"max-height":l}),this._setState({showExpand:c})}},shareNote:function(e){if(e&&e.preventDefault(),0==this.state.publyc)return!1;var t=l.UserModel.getLocalUser();return t&&t.uid?void r.WindowMessager.notifyCurrentPage("start_share",this.state):(r.NotificationUtil.showMessage(r.LocaleUtil.translate("login_and_share"),"error"),r.LoginUtil.login(!1,function(e){1==e.status?(r.NotificationUtil.showMessage(r.LocaleUtil.translate("login_success")),r.WindowMessager.notifyTabs("user-changed"),location.reload()):r.NotificationUtil.showMessage(r.LocaleUtil.translate("login_error")+":"+e.status,"error")}),!1)},deleteNote:function(e){var t=this;e&&e.preventDefault();var n=a(o.findDOMNode(t)).height();a(o.findDOMNode(t)).height(parseInt(n)),t._setState({isDeleting:!0},function(){var e=400;setTimeout(function(){t.save({removed:1})},e)})},switchSecret:function(e){e.preventDefault(),1==this.state.publyc?this.save({publyc:0}):this.save({publyc:1}),this._setState({publyc:1==this.state.publyc?0:1})},showMoreContent:function(){this._setState({showMore:!this.state.showMore})},saveTitle:function(e){var t={title:e};if(this.constructor._saveTimeout){var n=this.constructor._delayedProps[this.constructor._saveTimeout];n&&(t=a.extend({},n,t)),clearTimeout(this.constructor._saveTimeout)}this.save({title:e})},save:function(e){if(!e)return!1;e.gnid=this.state.gnid,e.sortby=this.state.sortby;var t=l.NoteModel.update(e);t&&(a("body").hasClass("searching")&&(c.NoteList.isDirty=!0),r.WindowMessager.notifyTabs("data-changed",{type:"update",notes:[t]}))},handleInput:function(e){if(!e)return!1;var t=this;if(this.constructor._saveTimeout){var n=this.constructor._delayedProps[this.constructor._saveTimeout];n&&(e=a.extend({},n,e)),clearTimeout(this.constructor._saveTimeout)}else this.constructor._delayedProps||(this.constructor._delayedProps={});this.constructor._saveTimeout=setTimeout(function(){t.save(e),delete t.constructor._delayedProps[t.constructor._saveTimeout]},s.save_delay),this.constructor._delayedProps[this.constructor._saveTimeout]=e},handleMaximize:function(e){e&&e.preventDefault(),this.state.maximized?(this.minimizeNote(this),this._setState({maximized:!1})):(this.maximizeNote(this),this._setState({maximized:!0}))},minimizeNote:function(e){r.WindowMessager.notifyCurrentPage("minimize",e),c.StaticFn.handleFullPageOff("editor")},maximizeNote:function(e){this.openEditorWindow(),r.WindowMessager.notifyCurrentPage("maximize",e),c.StaticFn.handleFullPageOn("editor")},openEditorWindow:function(){a("body").addClass("open-editor"),a("#editor").showWithAnim("anim")},shouldComponentUpdate:function(e,t){if(t&&(t.modified>this.state.modified||t.sortby>this.state.sortby))return!0;if(e.note.modified>this.state.modified||e.note.sortby>this.state.sortby){var n=e.note;return"string"==typeof e.note.content&&this.state.content!=e.note.content&&(n=this.constructNoteState(e.note)),
e.note.maximized&&!this.state.maximized&&(n.maximized=!1),this._setState(n),!1}return t.showExpand!==this.state.showExpand?!0:t.isDeleting!==this.state.isDeleting?!0:t.isNew!==this.state.isNew?!0:t.maximized!==this.state.maximized?!0:t.opened!==this.state.opened},render:function(){return this._render()}});t["default"]=f,e.exports=t["default"]}).call(t,n(2),n(3),n(11),n(8))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),o=n(12),s={_render:function(){var e="";this.state.showExpand&&(e=i.createElement(o.NoteSwitch,{open:this.state.opened,handleOpen:this.handleOpen}));var t="note";return this.state.isDeleting&&(t+=" note-leave"),this.state.is_new&&(t+=" note-enter"),0==this.state.publyc&&(t+=" private"),this.state.maximized&&(t+=" expand"),this.state.opened&&(t+=" opened"),i.createElement("div",{className:t},i.createElement("div",{className:"handle fp-tooltips","data-tooltip":a.LocaleUtil.translate("drag_merge"),"data-placement":"bottom"}),i.createElement("div",{className:"note-inner"},i.createElement(o.NoteTitle,{saveTitle:this.saveTitle,onInput:this.handleInput,title:this.state.title}),i.createElement(o.NoteContent,{content:this.state._content,onInput:this.handleInput}),e,i.createElement(o.NoteMeta,{source:this.state.source}),i.createElement(o.NoteOp,{publyc:this.state.publyc,handleMaximize:this.handleMaximize,shareNote:this.shareNote,onDelete:this.deleteNote,switchSecret:this.switchSecret})),i.createElement(o.NoteToggleEditor,{handleMaximize:this.handleMaximize}))}};t["default"]=s,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(4),r=n(129),l=i.createClass({displayName:"NoteContent",mixins:[r],componentDidMount:function(){var e=a.findDOMNode(this);o(e).on("click",".res a",function(e){e.preventDefault();var t=o(this).closest(".media");if(t.length>0){var n=t.find("a[data-media]"),i=n.data("media");if(i);else s.NotificationUtil.showMessage(s.LocaleUtil.translate("not_found_media_files"),"error")}}),o(e).on("click","a",function(e){e.preventDefault();var t=o(this).attr("href");if(o(e.target).hasClass("fp-ext-zoom-in"))return!1;if("#"!=t)window.open(this.href);else{var n=o(this).data("media"),i=o(this).data("type"),a=o(this).closest(".media");/audio/.test(i)&&(s.AudioPlayer.isPlaying(n)?(s.AudioPlayer.pause(),a.removeClass("playing")):(a.addClass("loading"),s.AudioPlayer.play(n,function(e){switch(e){case"playing":case"timeupdate":case"loadedmetadata":a.addClass("playing").removeClass("loading");break;case"ended":case"pause":a.removeClass("playing");break;case"error":a.removeClass("loading").addClass("error").removeClass("playing")}})))}}),o(e).on("click",".img-icon",function(e){s.WindowMessager.notifyCurrentPage("viewimage",o(this).closest(".img").find("img"))}),o(e).on("click",".media-cover",function(e){s.WindowMessager.notifyCurrentPage("viewMedia",o(this).closest(".media").find("img"))}),this.listenTodo()},listenTodo:function(){var e=this,t=a.findDOMNode(this);o(t).on("mousedown",".todo-item",function(e){var t=18,n=23;o(this).hasClass("font-size-1")?(t=15,n=17):o(this).hasClass("font-size-2")?(t=18,n=23):o(this).hasClass("font-size-3")?(t=20,n=26):o(this).hasClass("font-size-4")?(t=24,n=32):o(this).hasClass("font-size-5")&&(t=30,n=41),o(e.target).hasClass("todo-item")||(t=1),e.offsetX<t&&e.offsetY<n&&e.preventDefault()}),o(t).on("click",".todo-item",function(t){var n=18,i=23;o(this).hasClass("font-size-1")?(n=15,i=17):o(this).hasClass("font-size-2")?(n=18,i=23):o(this).hasClass("font-size-3")?(n=20,i=26):o(this).hasClass("font-size-4")?(n=24,i=32):o(this).hasClass("font-size-5")&&(n=30,i=41),o(t.target).hasClass("todo-item")||(n=1),t.offsetX<n&&t.offsetY<i&&(o(this).hasClass("done")?o(this).removeClass("done"):o(this).addClass("done"),e.saveContent())})},saveContent:function(){var e=a.findDOMNode(this),t=e.innerHTML;t=s.ContentUtil.filterContentFromOutside(t),this.props.onInput({content:t})},render:function(){return this._render()}});t["default"]=l,e.exports=t["default"]}).call(t,n(2),n(11),n(3))},function(e,t,n){(function(n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={_render:function(){return n.createElement("div",{className:"note-content",dangerouslySetInnerHTML:{__html:this.props.content||""}})}};t["default"]=i,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i,a,o){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),l=n(9),c=n(131),d=s(c),u=n(10),f=s(u),h=i.createClass({displayName:"NoteList",statics:{_notes:[],_notesBeforeSearch:[],_searchState:{},storeNotesBeforeSearch:function(){this._notesBeforeSearch=this._notes,this.clearNotes()},getNotesBeforeSearch:function(){return this._notesBeforeSearch},saveSearchState:function(e){this._searchState=e||{}},getSearchState:function(){return this._searchState},clearNotes:function(){this._notes=[]},deleteNoteAt:function(e){this._notes.splice(e,1)},updateNoteAt:function(e,t){var n=this._notes[e];n&&(this._notes[e]=a.extend(n,t))},highlightText:function(e){a("#note_list .note-content").each(function(){r.CaretUtil.removeHighlightStyle(this),0==a(".kws-highlight",this).length&&r.CaretUtil.highlightText(e,this)}),a("#note_list .note-title").each(function(){var t=a(this).find("input");t.after('<div class="title-placeholder">'+a(t).val()+"</div>"),r.CaretUtil.removeHighlightStyle(this),0==a(".kws-highlight",this).length&&r.CaretUtil.highlightText(e,this)})}},mixins:[d["default"],f["default"]],getInitialState:function(){return{}},componentDidMount:function(){var e=this;r.WindowMessager.listenPageEvent("search",function(t){t&&e.searchNotes(t)}),r.WindowMessager.listenPageEvent("exit-search",function(){e.exitSearch()}),r.WindowMessager.listenPageEvent("pull-updates",function(){e.pullUpdates()}),r.WindowMessager.listenGlobalEvent("data-changed",function(t,n){o.log("data-changed",t,n),t&&t.type&&e.applyUpdates(t)}),this.loadInitialNotes()},getNotes:function(){return this.constructor._notes||[]},setNotes:function(e){return a.isArray(e)?void(this.constructor._notes=e):!1},renderNotes:function(e,t){this.constructor._notes=e,this._setState(this.state,function(){a.isFunction(t)&&t.call(null),r.WindowMessager.notifyCurrentPage("notesloaded")})},loadInitialNotesAlpha:function(){var e=this,t={offset:0,rows:30};a("body").addClass("loading"),l.NoteModel.getNotes(t,function(t){if(1==t.status){var n=t.list||[];if(t.online){var i=[];n=i.concat(n)}e.renderNotes(n,function(){a("body").removeClass("loading")})}else a("body").removeClass("loading")})},loadInitialNotes:function(){var e=this,t={offset:0,rows:10},n=l.NoteModel.getLocalNotes(t);if(n.length>0){var i=e.getNotes(),s=i.concat(n);a("body").addClass("loading"),this.renderNotes(s,function(){a("body").removeClass("loading")});var r=s[s.length-1];r&&r.sortby&&(t.offset=r.sortby)}o.debug("第一次加载","本地加载"+n.length+"条");var c=t.rows-n.length,d=l.UserModel.getLocalUser();c>0&&d&&d.uid&&(o.debug("第一次加载","远程加载剩余"+c+"条"),t.rows=c,a("body").addClass("loading"),l.NoteModel.getNotes(t,function(t){if(1==t.status){var n=e.getNotes(),i=n.concat(t.list);e.renderNotes(i,function(){a("body").removeClass("loading")})}else a("body").removeClass("loading")}))},loadMore:function(){var e=this;if(!a("body").hasClass("loading-more")){var t=this.getNotes().length,n=this.getNotes()[t-1];if(n&&n.sortby)if(a("body").addClass("loading-more"),a("body").hasClass("searching")){var i=h.getSearchState();i.keywords&&e.searchNotes(i.keywords)}else{var o={offset:n.sortby,rows:30},s=l.NoteModel.getLocalNotes(o);if(s.length>0){n=s[s.length-1];var r=this.getNotes().concat(s);this.renderNotes(r)}var c=o.rows-s.length;c>0?(o.rows=c,o.offset=n.sortby,l.NoteModel.getNotes(o,function(t){if(1==t.status){var n=e.getNotes();if(t.list.length){var i=n.concat(t.list);e.renderNotes(i,function(){a("body").removeClass("loading-more")})}else a("body").removeClass("loading-more")}else a("body").removeClass("loading-more")})):a("body").removeClass("loading-more")}}},shouldNoteRenderInList:function(e){return 1!=e.removed&&1!=e.expunged},applyUpdates:function(e){if(!e||!a.isArray(e.notes))return!1;var t=this,n=this.getNotes(),i=null;if("new"==e.type)i=e.notes.concat(n);else if("update"==e.type){o.log("applyUpdates",e.notes);var s={},r={},l=[];a(e.notes).each(function(e,t){s[t.gnid]=t,r[t.sortby]=t,l.push(t.sortby)}),l=a.unique(l);var c=[];if(a(n).each(function(e,a){if(s[a.gnid]){t.shouldNoteRenderInList(s[a.gnid])?(n[e]=s[a.gnid],i=i||[],i.push(s[a.gnid]),o.log("applyUpdates","放入list")):(i=i||[],o.log("applyUpdates","不应该加载，从list中删除"));var r=l.indexOf(s[a.gnid].sortby);r>=0&&l.splice(r,1)}else i=i||[],i.push(a);c.push(n[e].sortby)}),l.length>0){o.debug("applyUpdates","不存在与当前list的sortby"),o.debug("applyUpdates",l);var d=c[0]||0,u=c[c.length-1]||0;l.sort(function(e,t){return e-t}),a(l).each(function(e,n){if(t.shouldNoteRenderInList(r[n]))if(n>d)i=i||[],i.unshift(r[n]),o.log("applyUpdates","大于最大sortby放入当前list上方");else if(n>u){c.push(n),c.sort(function(e,t){return t-e});var a=c.indexOf(n);i=i||[],i.splice(a,0,r[n]),o.log("applyUpdates","处于最大sortby和最小sortby中间,则放入适当的位置")}})}}i&&(o.log("applyUpdates","应用更新后的贴纸list",i.length),this.renderNotes(i))},pullUpdates:function(){l.NoteModel.notePull(function(e){1==e.status&&(o.log("applyUpdates",e.list),r.WindowMessager.notifyTabs("data-changed",{type:"update",notes:e.list}))})},exitSearch:function(){if(a("#keywords_field").val(""),a("#note_list .note-content").each(function(){r.CaretUtil.removeHighlightStyle(this)}),a("#note_list .note-title .title-placeholder").remove(),a("body").removeClass("searching local-search-done"),h.saveSearchState(null),h.isDirty)h.isDirty=!1,h.clearNotes(),this.loadInitialNotes();else{var e=h.getNotesBeforeSearch();this.renderNotes(e)}},searchNotes:function(e,t){var n=this;a("body").hasClass("searching")||(h.storeNotesBeforeSearch(),a("body").addClass("searching"));var i=h.getSearchState();i.keywords!=e&&(a("body").removeClass("local-search-done"),h.clearNotes());var o=n.getNotes(),s=o[o.length-1]&&o[o.length-1].sortby,r={keywords:e,offset:s||0,rows:30};h.saveSearchState(r),a("body").addClass("loading");var c=function(t){a("body").removeClass("loading"),1==t.status?(t.localdone&&a("body").addClass("local-search-done"),a.isArray(t.list)&&(o=o.concat(t.list),n.renderNotes(o,function(){(t.list.length==r.rows||t.online)&&a("body").removeClass("loading-more"),t.list.length>0&&n.constructor.highlightText(e)}))):a("body").removeClass("loading-more")};a("body").hasClass("local-search-done")?l.NoteModel.searchOnline(r,c):l.NoteModel.search(r,c)},render:function(){return this._render()}});t["default"]=h,e.exports=t["default"]}).call(t,n(2),n(3),n(13))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(12),o={_render:function(){var e="",t=this.getNotes();return e=t&&t.length>0?t.map(function(e,t,n){return e?(e.dataIndex=t,i.createElement(a.Note,{key:e.gnid,note:e})):void 0}):i.createElement(a.NoResult,null),i.createElement("div",null,e)}};t["default"]=o,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(133),o=i.createClass({displayName:"NoteMeta",mixins:[a],openSource:function(e){e.preventDefault(),window.open(this.props.source)},render:function(){return this._render()}});t["default"]=o,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),o={_render:function(){var e=a.UrlUtil.getDomainForUrl(this.props.source).toUpperCase(),t="";return t=this.props.source?i.createElement("a",{className:"fp-tooltips","data-tooltip":a.LocaleUtil.translate("source_link"),"data-placement":"top",href:this.props.source,title:this.props.source,onClick:this.openSource},i.createElement("span",{className:"fp-icon-font fp-ext-link"}),i.createElement("span",{className:"slink"},e)):i.createElement("a",{href:"#",className:"no-source",title:a.LocaleUtil.translate("no_source")},i.createElement("span",{className:"fp-icon-font fp-ext-link"}),a.LocaleUtil.translate("no_source")),i.createElement("div",{className:"note-meta"},t)}};t["default"]=o,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(135),r=n(10),l=i.createClass({displayName:"NoteOp",mixins:[s,r],getInitialState:function(){return{switchOp:!1}},switchOp:function(e){e&&e.preventDefault(),this._setState({switchOp:!this.state.switchOp})},handleEdit:function(e){this.props.handleMaximize(e),this.switchOp(e)},componentDidMount:function(){var e=this;a(document).on("mousedown",function(t){var n=t.target,i=e.refs.opPanel;e.state.switchOp&&o.findDOMNode(i)&&!a.contains(o.findDOMNode(i),n)&&e.switchOp(t)})},render:function(){return this._render()}});t["default"]=l,e.exports=t["default"]}).call(t,n(2),n(3),n(11))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),o={_render:function(){var e="note-op ";e+=1==this.props.publyc?"public":"secret",e+=this.state.switchOp?" show-op":"";var t="",n={};1!=this.props.publyc&&(t=i.createElement("span",{className:"secret-symbol"}),n={color:"#BB0000"});var o="note-toggle-secret ";o+=1==this.props.publyc?"":"checked";var s="";return this.state.switchOp&&(s=i.createElement("ul",{className:"op-panel",ref:"opPanel"},i.createElement("li",{className:"note-share",onClick:this.props.shareNote},i.createElement("a",{href:"#"},a.LocaleUtil.translate("share"))),i.createElement("li",{className:"note-editor",onClick:this.handleEdit},i.createElement("a",{href:"#"},a.LocaleUtil.translate("edit"))),i.createElement("li",{className:o,onMouseDown:this.props.switchSecret,onMouseUp:this.switchOp},i.createElement("span",null,a.LocaleUtil.translate("secret")),i.createElement("a",{className:"check-box",href:"#"},i.createElement("span",{className:"fp-icon-font fp-ext-done"}))),i.createElement("li",{className:"note-delete",onClick:this.props.onDelete},i.createElement("a",{href:"#"},a.LocaleUtil.translate("delete"))))),i.createElement("div",{className:e},i.createElement("a",{className:"publyc-mark fp-tooltips","data-tooltip":a.LocaleUtil.translate("menu"),"data-placement":"top",href:"#",onClick:this.switchOp},t,i.createElement("span",{style:n,className:"fp-icon-font fp-ext-more"})),s)}};t["default"]=o,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i,a,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),l=n(9),c=n(137),d=n(10);n(68);var u=i.createClass({displayName:"NoteSharePanel",mixins:[c,d],getInitialState:function(){return{}},close:function(){a("body").removeClass("show-share")},componentDidMount:function(){var e=this,t=o.findDOMNode(this);a(t).on("click",".close",function(){e.close()}),a(t).on("click",function(t){var n=a(".share-bg",n).get(0);a.contains(n,t.target)||e.close()}),r.WindowMessager.listenPageEvent("start_share",function(t){e.creatQrcodeContent(t),e._setState({noteData:t})}),a(".note-share-panel").css({width:a("#note_list").width()})},creatQrcodeContent:function(e){var t=o.findDOMNode(this),n=a(t).find(".qrcode");n.empty(),n.qrcode({size:186,color:"#FFF",text:l.NoteModel.getNoteUrl(e.gnid)}),a("body").addClass("show-share")},shareTo:function(e,t){t.preventDefault();var n=this,i=s.share_default_url;if(0!=n.state.noteData.publyc&&(i=l.NoteModel.getNoteUrl(n.state.noteData.gnid)),e)if("link"==e)n.copyLink(i);else{var o=a("<div><div/>").get(0).innerHTML=n.state.noteData.content,c=a(o).find("img").first().attr("src")||"";o=null;var d={title:n.state.noteData.title,content:n.state.noteData.content,img_url:c,share_url:i||""};r.ShareUtil.setShareInfo(d),r.ShareUtil.shareTo(e)}},copyLink:function(e){if(document.execCommand&&document.execCommand("copy")){var t=a("<input>",{id:"copy_input",style:"z-index:-199999;opacity:0;position:absolute;top: 100000000px;",value:e});a("body").append(t),t.focus().select(),document.execCommand("copy")?(r.NotificationUtil.showMessage(r.LocaleUtil.translate("copy_link_success")),t.remove()):window.prompt(r.LocaleUtil.translate("copy_link_tips"),e)}else window.prompt(r.LocaleUtil.translate("copy_link_tips"),e)},render:function(){return this._render()}});t["default"]=u,e.exports=t["default"]}).call(t,n(2),n(3),n(11),n(8))},function(e,t,n){(function(n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={_render:function(){return n.createElement("div",{className:"note-share-panel"},n.createElement("div",{className:"share-bg"},n.createElement("div",{className:"share-content"},n.createElement("div",{className:"qrcode"}),n.createElement("ul",null,n.createElement("li",null,n.createElement("a",{href:"#dt_weibo",onClick:this.shareTo.bind(null,"weibo")},n.createElement("span",{className:"icon-font fp-ext-weibo"}))),n.createElement("li",null,n.createElement("a",{href:"#dt_qzone",onClick:this.shareTo.bind(null,"qzone")},n.createElement("span",{className:"icon-font fp-ext-zone"}))),n.createElement("li",null,n.createElement("a",{href:"#dt_twitter",onClick:this.shareTo.bind(null,"twitter")},n.createElement("span",{className:"icon-font fp-ext-twitter"}))),n.createElement("li",null,n.createElement("a",{href:"#dt_link",onClick:this.shareTo.bind(null,"link")},n.createElement("span",{className:"icon-font fp-ext-share-link"}))))),n.createElement("a",{className:"close",href:"#dt_share_close"},n.createElement("span",{className:"icon-font fp-ext-close"}))))}};t["default"]=i,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(139),o=n(10),s=i.createClass({displayName:"NoteSwitch",mixins:[a,o],getInitialState:function(){return{}},componentDidMount:function(){},render:function(){return this._render()}});t["default"]=s,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),o={_render:function(){return i.createElement("div",{className:"note-switch"},i.createElement("a",{className:"open",onClick:this.props.handleOpen,href:"#"},a.LocaleUtil.translate("unfold_note"),i.createElement("span",{className:"icon-font fp-ext-list-expend"})),i.createElement("a",{className:"close",onClick:this.props.handleOpen,href:"#"},a.LocaleUtil.translate("collapse_note"),i.createElement("span",{className:"icon-font fp-ext-list-up"})))}};t["default"]=o,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(n(9),n(4)),r=n(141),l=n(10),c=i.createClass({displayName:"NoteTitle",mixins:[r,l],getInitialState:function(){return{editingMode:!1}},componentDidMount:function(){var e=this;a(o.findDOMNode(this.refs.input)).on("keydown",function(t){e.handleKeydown(t)})},getValue:function(){return o.findDOMNode(this.refs.input).value||""},handleBlur:function(e){this._setState({editingMode:!1}),this.state.modified&&this.save()},handleFocus:function(e){a("body").hasClass("searching")&&a(o.findDOMNode(this)).find(".title-placeholder").remove(),this._setState({editingMode:!0})},handleInput:function(e){var t=this.getValue();this.props.title!=t?this._setState({modified:!0}):this._setState({modified:!1}),this.props.onInput({title:t})},handleKeydown:function(e){((e.ctrlKey||e.metaKey)&&83==e.keyCode||13==e.keyCode)&&(e.preventDefault(),this.state.modified&&this.save())},componentWillReceiveProps:function(e){if(e.title&&this.props.title!=e.title){var t=o.findDOMNode(this.refs.input);t.value=e.title}},save:function(){var e=this.getValue();this.props.saveTitle(e),s.NotificationUtil.showMessage(s.LocaleUtil.translate("title_modification_success")),this._setState({modified:!1}),a(o.findDOMNode(this.refs.input)).blur()},render:function(){return this._render()}});t["default"]=c,e.exports=t["default"]}).call(t,n(2),n(3),n(11))},function(e,t,n){(function(i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),s={_render:function(){var e=this.state.editingMode?" editing-title":"";return i.createElement("h2",{className:"note-title fp-tooltips"+e,"data-tooltip":o.LocaleUtil.translate("edit_title"),"data-placement":"bottom"},i.createElement("input",{ref:"input",placeholder:a.TITLE_PLACEHOLDER,defaultValue:this.props.title||o.LocaleUtil.translate("no_title"),onBlur:this.handleBlur,onInput:this.handleInput,spellCheck:!1,onFocus:this.handleFocus}))}};t["default"]=s,e.exports=t["default"]}).call(t,n(2),n(8))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(10),o=n(143),s=i.createClass({displayName:"NoteToggleEditor",mixins:[o,a],getInitialState:function(){return{}},render:function(){return this._render()}});t["default"]=s,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),o={_render:function(){return i.createElement("div",{className:"note-toggle-editor"},i.createElement("a",{className:"shrink-editor fp-tooltips","data-tooltip":a.LocaleUtil.translate("collapse_editor"),"data-placement":"top",href:"#",onClick:this.props.handleMaximize},i.createElement("span",{className:"icon-font fp-ext-shrink"})),i.createElement("a",{className:"expend-editor fp-tooltips","data-tooltip":a.LocaleUtil.translate("unfold_editor"),"data-placement":"top",href:"#",onClick:this.props.handleMaximize},i.createElement("span",{className:"icon-font fp-ext-expand"})))}};t["default"]=o,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),o={_render:function(){return i.createElement("div",{id:"search_box"},i.createElement("span",{className:"fp-icon-font fp-ext-search "}),i.createElement("form",{onSubmit:this.onSearch},i.createElement("input",{onBlur:this.inputBlur,onFocus:this.inputFocus,id:"keywords_field",ref:"keywords",type:"search",placeholder:a.LocaleUtil.translate("search_desc"),autoComplete:"off"})),i.createElement("a",{href:"#",onClick:this.exitSearch},i.createElement("span",{className:"fp-icon-font fp-ext-close "})))}};t["default"]=o,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(4),r=n(10),l=n(144),c=i.createClass({displayName:"Search",mixins:[l,r],getKeywords:function(){return a.findDOMNode(this.refs.keywords).value},exitSearch:function(e){e.preventDefault(),a.findDOMNode(this.refs.keywords).value="",s.WindowMessager.notifyCurrentPage("exit-search")},onSearch:function(e){e.preventDefault();var t=this.getKeywords();t&&s.WindowMessager.notifyCurrentPage("search",t)},inputFocus:function(e){e.preventDefault(),o("#search_box").css("backgroundColor","#fff"),o("#search_box .fp-ext-search").css("borderColor","#c0c0c0"),o("#search_box .fp-ext-close").css("color","#c0c0c0")},inputBlur:function(e){e.preventDefault(),o("#search_box").css("backgroundColor",""),o("#search_box .fp-ext-search").css("borderColor",""),o("#search_box .fp-ext-close").css("color","")},render:function(){return this._render()}});t["default"]=c,e.exports=t["default"]}).call(t,n(2),n(11),n(3))},function(e,t,n){(function(i,a,o){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(147),l=s(r),c=n(10),d=i.createClass({displayName:"BackTop",mixins:[l["default"],c],render:function(){var e=this.renderFn();return e},getInitialState:function(){return{active:!1}},componentDidMount:function(){var e,t=a(o.findDOMNode(this)),n=a(window).height()-88;t.css({top:n}),t.on("click",function(e){document.body.scrollTop>0&&a(document.body).animate({scrollTop:0},500),a("#app").animate({scrollTop:0},500)}),a(window).on("resize",function(){e&&clearTimeout(e),e=setTimeout(function(){n=a(window).height()-88,t.css({top:n})},300)})}});t["default"]=d,e.exports=t["default"]}).call(t,n(2),n(3),n(11))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(n(4),{renderFn:function(){var e=this.state.active?"show":"hide";return i.createElement("div",{id:"back_top",className:e},i.createElement("div",{className:"pos-cont"},i.createElement("span",{className:"fp-ext-up"})))}});t["default"]=a,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i,a,o){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(149),l=s(r),c=n(4),d=n(10),u=i.createClass({displayName:"Dialog",mixins:[l["default"],d],render:function(){var e=this.renderFn();return e},getInitialState:function(){return{active:!1,cancelText:c.LocaleUtil.translate("cancel"),confirmText:c.LocaleUtil.translate("confirm"),content:"",title:"",classNames:"",callback:null}},componentDidMount:function(){var e=this;a(window).on("dialog",function(t,n){e._setState(n,function(){n.callback&&a(".btn.confirm",o.findDOMNode(e)).on("click.dialog",n.callback)})}).on("closedialog",function(){e.close()}),a(o.findDOMNode(this)).on("mousedown",function(e){e.preventDefault()})},ui:{animID:null,animAfterShow:function(e){this.animID&&clearTimeout(this.animID),setTimeout(function(){e._setState({animated:!0})},0)},animBeforeHide:function(e,t){var n=310;e._setState({animated:!1}),this.animID=setTimeout(function(){a.isFunction(t)&&t.call(null)},n)}},close:function(e){e&&e.preventDefault();var t=this;this.ui.animBeforeHide(this,function(){t._setState({active:!1})})},didClose:function(){this._setState({cancelText:c.LocaleUtil.translate("cancel"),confirmText:c.LocaleUtil.translate("confirm"),content:"",title:"",classNames:"",callback:null}),a(".btn.confirm",o.findDOMNode(this)).off("click.dialog")},componentDidUpdate:function(e,t){t.active&&!this.state.active?this.didClose():!t.active&&this.state.active&&this.ui.animAfterShow(this)}});t["default"]=u,e.exports=t["default"]}).call(t,n(2),n(3),n(11))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),o={renderFn:function(){var e="";return e+=this.state.classNames?" "+this.state.classNames:"",e+=this.state.animated?" anim":"",e+=this.state.active?" active":"",i.createElement("div",{id:"dialog",className:e},i.createElement("div",{className:"overlay",onClick:this.close}),i.createElement("div",{className:"wrapper"},i.createElement("div",{className:"title-con"},i.createElement("h1",{className:"title"},this.state.title)),i.createElement("div",{className:"desc-con"},i.createElement("div",{className:"desc"},this.state.content)),i.createElement("div",{className:"error"}),i.createElement("div",{className:"btns"},i.createElement("a",{className:"btn cancel",href:"#",onClick:this.close},a.LocaleUtil.translate("cancel")),i.createElement("a",{className:"btn confirm",href:"#"},this.state.confirmText)),i.createElement("a",{href:"#",className:"btn close",onClick:this.close},i.createElement("span",{className:"ok-icon-font ok-extension-close"}))))}};t["default"]=o,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(12),o={_render:function(){var e=this.state.show?"show":"";e+=this.state.animated?" anim":"";var t=this.state.types,n="";return n="info"==t?"fp-ext-info":"warning"==t||"error"==t?"fp-ext-warning":"fp-ext-success",i.createElement("div",{id:"feedback_panel",className:this.state.types+" "+e},i.createElement("div",{className:"main-cont"},i.createElement("div",{className:"message"},i.createElement("span",{className:"ok-icon-font "+n}),i.createElement(a.LoadingAnim,null),this.state.message)))}};t["default"]=o,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(152),o=i.createClass({displayName:"LoadingAnim",mixins:[a],render:function(){return this._render()},shouldComponentUpdate:function(){return!1}});t["default"]=o,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={_render:function(){return n.createElement("div",{id:"loading_gif"},n.createElement("div",{className:"rect1"}),n.createElement("div",{className:"rect2"}),n.createElement("div",{className:"rect3"}),n.createElement("div",{className:"rect4"}),n.createElement("div",{className:"rect5"}))}};t["default"]=i,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(n(12),n(9)),o=n(154),s=n(10),r=i.createClass({displayName:"MergeTipsCover",mixins:[o,s],render:function(){return this._render()},getInitialState:function(){return{checked:!1}},componentDidMount:function(){},componentDidUpdate:function(e,t){},setShowState:function(e){e.preventDefault(),this.props.handleClose(),this.state.checked?a.NativeKVDB.set("dragMerge",!0):a.NativeKVDB.set("dragMerge",!1)},toggleChecked:function(e){e.preventDefault(),this._setState({checked:!this.state.checked})}});t["default"]=r,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(n(12),n(4)),o={_render:function(){var e="";return e+=this.state.checked?" checked":"",i.createElement("div",{id:"merge_tips_cover",className:e},i.createElement("div",{className:"content"},i.createElement("h3",null,a.LocaleUtil.translate("merge_notes")),i.createElement("div",{className:"info"},i.createElement("div",{className:"left"},i.createElement("span",null),i.createElement("p",null,a.LocaleUtil.translate("merge_tips_1"))),i.createElement("div",{className:"right"},i.createElement("span",null),i.createElement("p",null,a.LocaleUtil.translate("merge_tips_2")))),i.createElement("div",{className:"btn"},i.createElement("a",{onClick:this.setShowState,href:"#"},a.LocaleUtil.translate("i_know"))),i.createElement("div",{id:"iknow"},i.createElement("a",{href:"#",onClick:this.toggleChecked},i.createElement("span",{className:"fp-ext-done"})),i.createElement("span",null,a.LocaleUtil.translate("never_remind")))))}};t["default"]=o,e.exports=t["default"]}).call(t,n(2))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),o={animID:null,animAfterShow:function(e){this.animID&&clearTimeout(this.animID),setTimeout(function(){e.setState({animated:!0})},0)},animBeforeHide:function(e,t,n){var a=t;e.setState({animated:!1}),this.animID=setTimeout(function(){i.isFunction(n)&&n.call(null)},a)},closeApp:function(){var e=i("body").hasClass("full-page");e?(i("body").toggleClass("hide-sidebar"),i(window).trigger("resize")):a.WindowMessager.notifyTop({command:"toggle_app"})},handleFullPageOn:function(e){e=e||"",a.WindowMessager.notifyTop({command:"maximize_app",widget:e})},handleFullPageOff:function(e){e=e||"",a.WindowMessager.notifyTop({command:"minimize_app",widget:e});var t=i("body").hasClass("hide-sidebar");t&&i("body").removeClass("hide-sidebar")}};t["default"]=o,e.exports=t["default"]}).call(t,n(3))},function(e,t,n){"use strict";var i=n(4),a=function(){this.init()};a.prototype={init:function(){i.EnvUtil.initENV(),i.ExtUtil.setExtBindings()}};var o=new a;e.exports=o},function(e,t,n){(function(i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(9),r=n(4),l={Globals:{imagesData:{},uploadingList:{},_imageSrcCache:{},imagesNotSaved:[]},cacheImagesData:function(e){var t=this;e&&i.isArray(e)&&i(e).each(function(){if(this.size){var e=t.Globals.imagesData[this.url];e?i.isArray(e)?t.Globals.imagesData[this.url].push(this):t.Globals.imagesData[this.url]=[e,this]:t.Globals.imagesData[this.url]=this}})},getImageData:function(e){var t=this,n=t.Globals.imagesData[e];return n?i.isArray(n)?n.length>1?n.shift():1==n.length?(t.Globals.imagesData[e]=n[0],t.Globals.imagesData[e]):void 0:n:null},ossupload:function(e,t,n,o){var s=new FormData,l=this,c=e.url,d=e.blob,u=e.width,f=e.height;if(i.isFunction(t))o=n,
n=t,t=r.ImageUtil.getCDNImageName(c,d.size,u,f,d.type.indexOf("gif")>-1);else if(!t){if(!c)return!1;t=r.ImageUtil.getCDNImageName(c,d.size,u,f,d.type.indexOf("gif")>-1)}this.signRequest(function(e){if(e&&e.policy){l.signature=e,s.append("policy",e.policy),s.append("OSSAccessKeyId",e.OSSAccessKeyId),s.append("Signature",e.Signature),s.append("key",t),s.append("file",d),s.append("success_action_status",200);var r={url:e.host,type:"POST",data:s,processData:!1,contentType:!1,complete:function(){i.isFunction(n)&&n("complete")},success:function(){i.isFunction(n)&&n("success")},error:function(){i.isFunction(n)&&n("error")},xhr:function c(){var c=i.ajaxSettings.xhr();return c.upload.onprogress=o,c.upload.onload=function(){a.log("DONE!")},c}};i.ajax(r)}})},signRequest:function(e){this.signature&&Date.now()<1e3*(this.signature.expire-10)?e(this.signature):s.Request.get("auth/cdncode",{app:1},e)},getBlobViaAjax:function(e,t){var n=new XMLHttpRequest;n.open("get",e,!0),n.responseType="blob",n.onload=function(){if(200==this.status){var n=this.response;n&&n.type&&("image/gif"==n.type&&n.size<10485760?t(n,e):r.ImageUtil.resizeImage(n,function(n,i,a){t(n,e,i,a)}))}},n.send(null)},directSendBlobImages:function(e,t){var n=(e.length,this);a.debug("图片上传","开始上传图片数据..."),a.log(e),i(e).each(function(e,o){a.debug("图片上传","第"+(e+1)+"张图片上传开始..."),n.ossupload(o,function(e){"complete"==e?(a.debug("图片上传",o.url+"上传完成"),delete n.Globals.uploadingList[o.url+"_"+o.blob.size],i.isFunction(t)&&t.call(null,o)):"success"==e&&(n.Globals._imageSrcCache[o.url]=r.ImageUtil.getSidebarImgViaSrc(o.url,o.blob.size,o.width,o.height))},function(e){var t=parseInt(e.loaded/e.total*100,10)+"%";a.debug("图片上传",t)})})},sendBlobImages:function(e,t){var n=new FormData,a=!1;i(e).each(function(e,t){_this.Globals.uploadingList[t.url+"_"+t.blob.size]||(n.append("image"+e,t.blob),n.append("image"+e,t.url),_this.Globals.uploadingList[t.url+"_"+t.blob.size]=t,a=!0)}),a&&i.ajax({url:s.AppModel.getAPIRoot()+"/images/upload",type:"POST",data:n,processData:!1,contentType:!1,success:t,complete:function(){i(e).each(function(e,t){delete _this.Globals.uploadingList[t.url+"_"+t.blob.size]})}})},getCachedCDNSrc:function(e){return e.indexOf("//"+o.img_cdn_domain)>=0?e:_this.Globals._imageSrcCache[e]?_this.Globals._imageSrcCache[e]:""},uploadImagesInNote:function(e,t){if(!e||!t)return!1;var n=this;r.ContentUtil.getImagesInContent(t,function(t,a){a&&a.length>0&&n.createImages(e,a,function(){i(window).trigger("imagesuploaded",{images:a})})})},uploadImages:function(e,t){t=i.isFunction(t)?t:null;var n=this,o=[],r=0,l=e.length;a.debug("图片上传","开始获取二进制数据"),i(e).each(function(e,i){var c=i.url;c&&0==c.indexOf("//")&&(c=s.AppModel.Globals.protocol+":"+c),n.getBlobViaAjax(c,function(e,s,c,d){r++,a.debug("图片上传","第"+r+"张二进制"),o.push({blob:e,url:s,height:d?d:i.height,width:c?c:i.width}),i.size=e.size,i.type=e.type,n.Globals.imagesData[s]=i,r==l&&(a.debug("图片上传","最后一张完成,准备开始上传"),a.log(o),n.directSendBlobImages(o,t))})})},sendBlobImage:function(e,t,n){var a=new FormData;a.append("images",e),a.append("url",t),i.ajax({url:s.AppModel.getAPIRoot()+"/images/upload",type:"POST",data:a,processData:!1,contentType:!1,success:n})}};t["default"]=l,e.exports=t["default"]}).call(t,n(3),n(13),n(8))},function(e,t,n){(function(n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={get:function(e,t){var i=localStorage.getItem(e);if(null===i)return t||i;if("string"==typeof i)try{i=JSON.parse(i)}catch(a){n.debug("NativeKVDB","get:解析错误:"+i)}return i},set:function(e,t){if("object"==typeof t&&null!==t)try{var i=JSON.stringify(t);localStorage.setItem(e,i)}catch(a){n.debug("NativeKVDB","set:解析错误:"+t)}else localStorage.setItem(e,t)},deleteKey:function(e){localStorage.removeItem(e)},listenKeyChange:function(e,t){},flush:function(){for(var e in localStorage)localStorage.hasOwnProperty(e)&&null!==localStorage.getItem(e)&&localStorage.removeItem(e)}};t["default"]=i,e.exports=t["default"]}).call(t,n(13))},function(e,t,n){(function(i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),s=n(9),r={syncMax:200,timeMax:3e3,timeId:null,timeKey:"key-nowtime-last",_createRunningList:[],_updateRunningList:[],_uploadRunningList:[],isInRunningList:function(e,t){return"create"==t?this._createRunningList.indexOf(e)>=0:"update"==t?this._updateRunningList.indexOf(e)>=0:"upload"==t?this._uploadRunningList.indexOf(e)>=0:void 0},addToRunningList:function(e,t){return"create"==t?this._createRunningList.push(e):"update"==t?this._updateRunningList.push(e):"upload"==t?this._uploadRunningList.push(e):void 0},removeInRunningList:function(e,t){if("create"==t){var n=this._createRunningList.indexOf(e);n>=0&&this._createRunningList.splice(n,1)}else if("update"==t){var n=this._updateRunningList.indexOf(e);n>=0&&this._updateRunningList.splice(n,1)}else if("upload"==t){var n=this._uploadRunningList.indexOf(e);n>=0&&this._uploadRunningList.splice(n,1)}},setLastTime:function(){var e=this,t=(new Date).getTime();s.LocalKVDB.set(e.timeKey,t),i.log("通知操作:"+t)},isSync:function(){var e=this,t=(new Date).getTime(),n=s.LocalKVDB.get(e.timeKey,0),i=t-Number(n);return i>=e.timeMax&&0!=n},syncFuc:function(){var e=r.isSync();i.log("监测是否执行:"+(e?"Y":"N")),e&&(this.syncCreate(),this.syncUpdate())},syncAll:function(e){var t=this;t.syncCreate(function(){t.syncUpdate(e)})},syncCreate:function(e,t){a.isFunction(e)&&(t=e,e=1e7),isNaN(e)&&(e=this.syncMax);var n,r,l,c=this,d=s.NoteModel.getQueue("create"),u=[];if(Object.keys){var f=Object.keys(d).length;f>0&&i.debug("队列:创建","队列包含"+f+"贴纸需要被创建")}for(var h in d)if(l=h.replace("@",""),d.hasOwnProperty(h)&&!c.isInRunningList(l,"create"))if(c.addToRunningList(l,"create"),i.debug("队列:创建",l),n=d[h],r=s.NoteModel.getNoteBySortby(n),r.upload&&r.imglist&&r.imglist.length>0)c.isInRunningList(l,"upload")||(c.addToRunningList(l,"upload"),i.debug("队列:创建:图片上传",l+","+r.imglist.length),s.NoteModel.uploadImagesInNote(r.imglist,r,function(e){e.images||a(e.imglist).each(function(t,n){return n.width>=300?(i.debug("图片上传","获取封面图为:"+n.url),e.images=n,!1):void 0}),delete e.upload,e.modified=e.modified+1,s.NoteModel.setNoteBySortby(e),o.WindowMessager.notifyTabs("data-changed",{type:"update",notes:[e]}),c.removeInRunningList(e.gnid,"upload"),c.removeInRunningList(e.gnid,"create")}));else{if(!(r&&u.length<e))break;u.push(r)}else i.debug("队列:创建",h+"在队列中运行，这里跳过");u.length>0?(i.debug("队列:创建","总共"+u.length+"条开始插入服务器"),s.NoteModel.noteInsert(u,function(e){1==e.status&&a(u).each(function(e,t){s.NoteModel.queueDelete(t.gnid,"create"),c.removeInRunningList(t.gnid,"create"),i.debug("队列:创建:成功",t.gnid+","+u.length+"条")}),a.isFunction(t)&&t()})):a.isFunction(t)&&t()},syncUpdate:function(e,t){a.isFunction(e)&&(t=e,e=1e7),isNaN(e)&&(e=this.syncMax);var n,o,r=this,l=s.NoteModel.getQueue("update"),c=[];if(Object.keys){var d=Object.keys(l).length;d>0&&i.debug("队列:修改","队列包含"+d+"贴纸需要被修改")}for(var u in l)if(o=u.replace("@",""),l.hasOwnProperty(u)&&!r.isInRunningList(o,"update")){if(r.addToRunningList(o,"update"),i.debug("队列:修改",o),n=l[u],!(n&&c.length<e))break;c.push(n)}else i.debug("队列:修改",u+"在队列中运行，这里跳过");c.length>0?s.NoteModel.noteUpdate(c,function(e){1==e.status&&a(c).each(function(e,t){s.NoteModel.queueDelete(t.gnid,"update"),r.removeInRunningList(t.gnid,"update"),i.debug("队列:修改:成功",t.gnid+","+c.length+"条")}),a.isFunction(t)&&t()}):a.isFunction(t)&&t()}},l={time:1e3,status:1,notify:function(){r.setLastTime()},flush:function(e){var t=this;this.stop(),r.syncAll(function(){i.log("清空队列: DONE!"),t.start(),a.isFunction(e)&&e()}),i.log("清空队列:"+l.status)},start:function(){var e=this;e.stop(),l.status=1,r.timeId=window.setInterval(function(){r.syncFuc()},e.time),i.log("开启队列:"+l.status)},stop:function(){if(!r.timeId)return!1;l.status=0,window.clearInterval(r.timeId),i.log("关闭队列:"+l.status)}};t["default"]=l,e.exports=t["default"]}).call(t,n(13),n(3))},function(e,t,n){(function(i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(9),s={recordFailedAjax:function(){i.ajaxSetup({beforeSend:function(e,t){if(t.url.indexOf("insertlist")>-1||t.url.indexOf("tags")>-1)return"";var n=t.type.toLowerCase();if("post"==n||"put"==n||"delete"==n){var i=t.okajaxid||"okajax_"+Date.now();t.okajaxid=i;var s=o.LocalKVDB.get("ajaxStack",{})||{},r={};for(var l in t)t.hasOwnProperty(l)&&"object"!=typeof t[l]&&"function"!=typeof t[l]&&(r[l]=t[l]);s[i]=r,a.debug("AJAX","记录ajax请求"+i),o.LocalKVDB.set("ajaxStack",s)}t.url.indexOf(".okay.do/")>0&&e.setRequestHeader("Request-Client","Extension")},complete:function(e,t){},success:function(){},timeout:function(){},error:function(e,t,n){if(this.okajaxid){var i=o.LocalKVDB.get("ajaxStack",{});i[this.okajaxid]&&(delete i[this.okajaxid],o.LocalKVDB.get("ajaxStack",i))}}}),i(document).ajaxComplete(function(e,t,n){var i=n.type.toLowerCase();if(("post"==i||"put"==i||"delete"==i)&&"ok"==t.statusText.toLowerCase()&&n.okajaxid){var s=o.LocalKVDB.get("ajaxStack",{});s[n.okajaxid]&&delete s[n.okajaxid],a.debug("AJAX",":):) 完成ajax请求"+n.okajaxid),o.LocalKVDB.set("ajaxStack",s)}switch(t.statusText.toLowerCase()){case"ok":case"abort":break;case"error":}}).ajaxStart(function(e,t,n){})},resumePausedAjax:function(){var e,t=o.LocalKVDB.get("ajaxStack",{});for(var n in t)t.hasOwnProperty(n)&&(e=t[n],e.url&&e.data&&(a.debug("AJAX","恢复未完成的ajax请求"+n+"\n	->"+e.type+" "+e.url),i.ajax(e)))}};t["default"]=s,e.exports=t["default"]}).call(t,n(3),n(13))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(9),a={loaded:!1,load:function(){this.loaded=!0,window._gaq=window._gaq||[],window._gaq.push(["_setAccount","UA-78440113-1"]),function(e,t,n,i,a,o,s){e.GoogleAnalyticsObject=a,e[a]=e[a]||function(){(e[a].q=e[a].q||[]).push(arguments)},e[a].l=1*new Date,o=t.createElement(n),s=t.getElementsByTagName(n)[0],o.async=1,o.src=i,s.parentNode.insertBefore(o,s)}(window,document,"script","https://cdn.quickwis.com/common/js/analytics/ext_ga.js","ga");var e=e||[];window._vds=e,function(){e.push(["setAccountId","a11dc02e31faf2cd"]);var t=i.UserModel.getLocalUser();t&&t.uid>0&&(e.push(["setCS1","user_id",t.uid]),e.push(["setCS2","mail",t.mail]),e.push(["setCS3","nickname",t.nickname])),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://cdn.quickwis.com/common/js/analytics/vds.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()}()},sendPage:function(){this.loaded||this.load(),window._gaq&&_gaq.push&&_gaq.push(["_trackPageview"])},sendEvent:function(){this.loaded||this.load(),window._gaq&&_gaq.push&&_gaq.push(["_trackEvent"])}};t["default"]=a,e.exports=t["default"]},function(e,t,n){(function(n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={_player:null,_player_id:"audio_player",_eventHandler:null,initPlayer:function(e){return this._player=document.getElementById(this._player_id),this._player?this._player:(this._player=document.createElement("audio"),this._player.id=this._player_id,this._player.autoplay=!0,document.body.appendChild(this._player),this._player)},play:function(e,t){t=n.isFunction(t)?t:function(){};return this._player||this.initPlayer(),this._player.src&&e!=this._player.src&&n.isFunction(this._eventHandler)&&this._eventHandler.apply(this._player,["ended"]),this._eventHandler=t,this._player.src!=e||isNaN(this._player.duration)?(this._player.onloadedmetadata=t.bind(this._player,"loadedmetadata"),this._player.onload=t.bind(this._player,"load"),this._player.onerror=t.bind(this._player,"error"),this._player.onplay=t.bind(this._player,"play"),this._player.onpause=t.bind(this._player,"pause"),this._player.oncanplaythrough=t.bind(this._player,"canplaythrough"),this._player.ondurationchange=t.bind(this._player,"canplay"),this._player.onloadstart=t.bind(this._player,"loadstart"),this._player.onloadeddata=t.bind(this._player,"loadeddata"),this._player.onplaying=t.bind(this._player,"playing"),this._player.oncanplay=t.bind(this._player,"canplay"),this._player.ontimeupdate=t.bind(this._player,"timeupdate"),this._player.onended=t.bind(this._player,"ended"),this._player.src=e,void this._player.play()):(n.isFunction(t)&&t.apply(this._player,["loaded"]),this._player.currentTime=0,this._player.play(),this)},isPlaying:function(e){return this._player?e&&this._player.src!=e?!1:!this._player.paused:!1},pause:function(){return this._player?void this._player.pause():!1}};t["default"]=i,e.exports=t["default"]}).call(t,n(3))},function(e,t,n){(function(n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={insertTextAtCursor:function(e,t){var n,i,a=e.value;"undefined"!=typeof e.selectionStart&&"undefined"!=typeof e.selectionEnd?(n=e.selectionEnd,e.value=a.slice(0,e.selectionStart)+t+a.slice(n),e.selectionStart=e.selectionEnd=n+t.length):"undefined"!=typeof document.selection&&"undefined"!=typeof document.selection.createRange&&(e.focus(),i=document.selection.createRange(),i.collapse(!1),i.text=t,i.select())},printRange:function(e){if(window.getSelection){var t=window.getSelection();if(t.rangeCount>0){var i=t.getRangeAt(0);n.log(e,i.startContainer,i.startOffset,i.endContainer,i.endOffset)}}},optimizeEditor:function(e,t){var n=this;t=t||window,i(t.document).on("keydown",e,function(e){9===e.keyCode&&(e.preventDefault(),n.pasteHtmlAtCaret("&nbsp;&nbsp;&nbsp;&nbsp;",t))})},placeCaretInEl:function(e,t){var n=!1;if(t=t?t:n,e.focus(),"undefined"!=typeof window.getSelection&&"undefined"!=typeof document.createRange){var i=document.createRange();i.selectNodeContents(e),i.collapse(t);var a=window.getSelection();a.removeAllRanges(),a.addRange(i)}else if("undefined"!=typeof document.body.createTextRange){var o=document.body.createTextRange();o.moveToElementText(e),o.collapse(t),o.select()}},highlightCaret:function(){var e=window.getSelection(),t=e.getRangeAt(0);t.isCollapsed&&t.deleteContents();var n=document.createElement("span");n.style.borderLeft="1px solid red",n.text="";var i=document.createDocumentFragment();i.appendChild(n),t.insertNode(i),t.setStartAfter(n),e.removeAllRanges(),e.addRange(t)},pasteHtmlAtCaret:function(e,t){t=t||window;var n,i;if(t.getSelection){if(n=t.getSelection(),n.getRangeAt&&n.rangeCount){i=n.getRangeAt(0),i.deleteContents();var a=t.document.createElement("div");a.innerHTML=e;for(var o,s,r=t.document.createDocumentFragment();o=a.firstChild;)s=r.appendChild(o);i.insertNode(r),s&&(i=i.cloneRange(),i.setStartAfter(s),i.collapse(!0),n.removeAllRanges(),n.addRange(i))}}else t.document.selection&&"Control"!=t.document.selection.type&&t.document.selection.createRange().pasteHTML(e)},getCaretContainer:function(){var e=null;if(window.getSelection){var t=window.getSelection();if(t.rangeCount>0){var n=t.getRangeAt(0);e=n.startContainer}}return e},getCaretCharacterOffsetWithin:function(e){var t,n=0,i=e.ownerDocument||e.document,a=i.defaultView||i.parentWindow;if("undefined"!=typeof a.getSelection){if(t=a.getSelection(),t.rangeCount>0){var o=a.getSelection().getRangeAt(0),s=o.cloneRange();s.selectNodeContents(e),s.setEnd(o.endContainer,o.endOffset),n=s.toString().length}}else if((t=i.selection)&&"Control"!=t.type){var r=t.createRange(),l=i.body.createTextRange();l.moveToElementText(e),l.setEndPoint("EndToEnd",r),n=l.text.length}return n},setCaretPosition:function(e,t){for(var n=document.createRange(),i=window.getSelection(),a=null,o=null,s=0;s<e.childNodes.length;s++){for(o=a,a=e.childNodes[s];a.childNodes.length>0;)a=a.childNodes[0];if(null!=o&&(t-=o.length),t<=a.length)break}null!=a&&(n.setStart(a,t),n.collapse(!0),i.removeAllRanges(),i.addRange(n))},saveSelection:function(){if(window.getSelection){if(sel=window.getSelection(),sel.getRangeAt&&sel.rangeCount)return sel.getRangeAt(0)}else if(document.selection&&document.selection.createRange)return document.selection.createRange();return null},restoreSelection:function(e,t){t=t||window,e&&(t.getSelection?(sel=t.getSelection(),sel.removeAllRanges(),sel.addRange(e)):document.selection&&e.select&&e.select())},removeHighlightStyle:function(e){return e?void i(".kws-highlight",e).each(function(){1==this.childNodes.length?(i(this).after(this.childNodes),i(this).remove()):i(this).removeClass("kws-highlight")}):!1},highlightText:function(e,t,n){if(""==e)return!1;if(n=n?n:"kws-highlight",document.createRange){t||(t=document.body);var i=t.childNodes,a=[];if(t.className==n)return;for(var o=0,s=i.length;s>o;o++){var r=i[o];if(r.childNodes.length>0)this.highlightText(e,r);else if(r.textContent)for(var l=0;r.textContent.indexOf(e,l)>=0;){var c=document.createRange();c.setStart(r,r.textContent.indexOf(e,l)),c.setEnd(r,r.textContent.indexOf(e,l)+e.length),l=r.textContent.indexOf(e,l)+e.length,a.push(c)}else if(r.innerText)for(var l=0;r.innerText.indexOf(e,l)>=0;){var c=document.createRange();c.setStart(r,r.innerText.indexOf(e,l)),c.setEnd(r,r.innerText.indexOf(e,l)+e.length),l=r.innerText.indexOf(e,l)+e.length,c.surroundContents(b)}}for(var d=0,s=a.length;s>d;d++){var u=a[d],f=document.createElement("span");f.className=n,u.surroundContents(f)}}}};t["default"]=a,e.exports=t["default"]}).call(t,n(13),n(3))},function(e,t,n){(function(i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(4),r=n(9),l={EMAIL_FIELD_REGEXP:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i,LINK_REGEXP:/((http\:\/\/|https\:\/\/|ftp\:\/\/|\/\/)?([a-z0-9\-]+\.){0,5}[a-z0-9\-]+\.(?:com|edu|cn|hr|io|org|do|fr|jp|tv|name|mobi|pro|it|de|us|st|fm|asia|net|gov|tel|la|travel|so|biz|info|hk|im|me|cc|in|at|bz|ag|eu|in|co|ly)\b(?:\:[\d+])?[^\<\>\s\,\"\'\[\]\{\}\<\u4E00-\u9FA5]{0,})/gi,IP_LINK_REGEXP:/((http\:\/\/|https\:\/\/|ftp\:\/\/|\/\/)?[\d]{1,3}\.[\d]{1,3}\.[\d]{1,3}\.[\d]{1,3}\b(?:\:[\d+])?[^\<\>\)\(\s\"\'\[\]\{\}\<\u4E00-\u9FA5]{0,})/gi,supported_attrs:{img:["src","_src","data-width","data-height","data-media","data-type","title","alt"],a:["target","title","href","data-media","data-duration","data-type","data-translated"],div:["contenteditable","class"],li:["class"],span:["style"]},supported_classes:["fp-more","media","res","todo-item","fromtxt","done","font-size-1","font-size-2","font-size-3","font-size-4","font-size-5"],supported_style:{"font-size":["12px","16px","18px","22px","28px"]},supported_tags:["i","b","u","ul","ol","li","br","hr","strong","img","sub","sup","pre","a","em","span","p","div","h1","h2","h3","h4","h5","h6","small","code","section","article","blockquote"],processContent:function(e){if(!e)return"";e=this.removeSpaceBetweenTags(e);var t="http://m.okay.do";return e=e.replace(this.LINK_REGEXP,function(n,i,a,o,s,l){if(n&&n.indexOf(t)<0){if((">"==l[s-1]||"<"==l[s+n.length])&&l.substr(s+n.length,4).indexOf("</a>")>=0)return n;if(l.substr(s-2-t.length,t.length)==t)return n;if("2f"==l.substr(s,2).toLowerCase()&&"%"==l.substr(s-1,1))return n;if(l.substr(s-7,7).indexOf("href")>=0)return n;if(('"'==e[s-1]||"'"==e[s-1])&&"="==e[s-2])return n;if(n.match(/[^\/]+\.(?:png|jpg|jpeg|svg|bmp|gif|tiff)\b/i))return'[[img src="'+n+'" _src="'+n+'" style="max-width:100%;" class="fromtxt"]]';var c=n;return a||(c=0!=n.indexOf("//")?"http://"+n:r.AppModel.Globals.protocol+":"+n),'[[a class="open encoded-link" href="'+c+'"]]'+n+"[[/a]]"}return n}),e=this.cleanContent(e),e=this.ensureHtmlTagClosed(e)},filterContentFromOutside:function(e){if(!e)return"";return e=this.removeSpaceBetweenTags(e),e=this.ensureSystemTagStripped(e),e=this.cleanContent(e),e=e.replace(/(\<br\>|\<br[\s]\/\>|\<br\/\>){2,}/g,"<div><br></div>"),e=this.removeEmptyTag(e),e=this.ensureHtmlTagClosed(e)},cleanContent:function(e){if(!e)return"";var t=this;return e=e.replace(/\<(noscript|script)[^>]{0,}\>[^><]{0,}\<\/(noscript|script)\>/gi,""),e=e.replace(/\<\!\-\-[^>]+\-\-\>/g,""),e=e.replace(/\<(div|span|a|li)\>/gi,"[[$1]]"),e=e.replace(/\<(h6|h5|h4|h3|h2|h1|blockquote|p|u|i|b|strong|em|ul|ol|br|hr|sub|sup|pre|small|code|section|article)\b[^>]{0,}\>/gi,"[[$1]]"),e=e.replace(/\<\/(a|h6|h5|h4|h3|h2|h1|blockquote|p|span|u|i|b|strong|em|ul|ol|li|div|sub|sup|pre|small|code|section|article)\b[^>]{0,}\>/gi,"[[/$1]]"),e=e.replace(/\<(div|a|img|span|li)\s([^><]{0,})\>/gi,function(e,n,a,o,s){var r,l=a.match(/[a-z0-9\-\_]+\=['"][^'"]{0,}['"]/g),c="";return l&&i(l).each(function(e,a){if(r=a.replace("=","==fp-separator==").split("==fp-separator=="),2==r.length&&t.supported_attrs[n].indexOf(r[0])>=0){if("href"==r[0])r[1].match(/^[\'\"]?\/\//)&&(a=a.replace("//","http://"));else if("class"==r[0]){var o=r[1].replace(/[\"\']/g,"").split(" ");i(o).each(function(e,n){n&&t.supported_classes.indexOf(i.trim(n))<0&&(r[1]=r[1].replace(n,""))}),i.trim(r[1])&&(a="",c+="class="+r[1]+" ")}else if("src"==r[0]||"_src"==r[0])r[1].match(/^[\'\"]?\/\//)&&(a=a.replace("//","http://"));else if("href"==r[0])r[1].match(/^[\'\"]?\/\//)&&(a=a.replace("//","http://"));else if("style"==r[0])if("span"==n.toLowerCase()){var s="",l=r[1].replace(/[\'\"]/g,"").split(";");i.isArray(l)&&l.length>0&&(s="",i(l).each(function(e,n){if(0==i.trim(n).indexOf("font-size")){var a=n.split(":");return i.isArray(a)&&2==a.length&&t.supported_style["font-size"].indexOf(i.trim(a[1]))>=0&&(s=' style="',s+=n,s+='"'),!1}})),a=s}else a="";a&&(c+=a+" ")}}),"[["+n+" "+i.trim(c)+"]]"}),e=e.replace(/(<([^>]+)>)/gi,""),e=e.replace(/\[\[/gi,"<"),e=e.replace(/\]\]/gi,">"),e=e.replace(/\/\]\]/gi,"/>")},stripHTML:function(e){return e.replace(/[&<>"'\/]/g,"")},escape:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"},n=/[&<>"'\/]/g;return(""+e).replace(n,function(e){return t[e]})},wrapBlockContent:function(e){if(!e)return"";var t=this,n=document.createElement("div");n.innerHTML=e;var a;return i(n.childNodes).each(function(){if(a=this.tagName,i(this).find("img").length>0&&""!=i.trim(i(this).text())&&(this.innerHTML=t.wrapBlockContent(this.innerHTML)),"IMG"==a||""==i.trim(i(this).text())||"BR"==a||i(this).hasClass("img")||i(this).hasClass("dl")||i(this).hasClass("pad-block")||i(this).find("img").length>0);else{var e=i(this).find(".pad-block").length>0;e&&i(this).find("pad-block").removeClass("pad-block"),"DIV"==a?i(this).addClass("pad-block"):i(this).wrap(i("<div>",{"class":"pad-block"}))}}),e=n.innerHTML,n=null,e},removeSpaceBetweenTags:function(e){return e?e=e.replace(/>\s+</g,"><"):""},ensureSystemTagStripped:function(e){if(!e)return"";var t=document.createElement("div");return t.innerHTML=e,i(".video-img",t).each(function(){var e=this;i(".vmask",this).remove(),i("img",this).length>0?(i(this.childNodes).each(function(){"img"!=this.tagName&&(i(this).hasClass("img")&&i(this).removeClass("img"),i(e).after(this))}),i(this).replaceWith(i("img",this))):i(this).removeAttr("class")}),i(".uploadbar",t).each(function(){i(this).remove()}),i(".img",t).each(function(){var e=this;i(".dl",this).remove(),i("img",this).length>0?(i(this.childNodes).each(function(){"img"!=this.tagName&&(i(this).hasClass("img")&&i(this).removeClass("img"),i(e).after(this))}),i(this).replaceWith(i("img",this))):i(this).removeAttr("class")}),i("img",t).each(function(){this.src.indexOf("//"+a.img_cdn_domain)>=0?this.src=this.src.replace(/\@.+/,""):this.src&&0!=this.src.indexOf("data:")||i(this).data("origin")&&(i(this).data("origin").indexOf("//"+a.img_cdn_domain)>=0?this.src=i(this).data("origin").replace(/\@.+/,""):this.src=i(this).data("origin"))}),i(".newline",t).each(function(){""==i(this).text()?1==this.childNodes.length&&"br"==this.childNodes[0].tagName.toLowerCase()&&i(this).remove():i(this).removeClass("newline")}),i(".dl,.icon-font,.gif",t).remove(),i(".encoded-link",t).each(function(){i(this).replaceWith(i(this).text())}),i("span",t).each(function(){this.getAttribute("class")||""!=i(this).text()||0!=i(this).find("img").length||i(this).remove()}),t.innerHTML},ensureHtmlTagClosed:function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.innerHTML;return i(t).find("img").attr("src",""),t=null,n},restoreContent:function(e){return e?(i(".video-img",e).each(function(){i(".vmask",this).remove(),i(this).replaceWith(i("img",this))}),i(".img",e).each(function(){i(".dl",this).remove()}),void i(".encoded-link",e).each(function(){i(this).replaceWith(i(this).text())})):""},getLinksInContent:function(e,t){var n=i.parseHTML(e),a=[],o=[];return i(n).find("a").each(function(){-1==o.indexOf(this.href)&&(o.push(this.href),a.push({url:this.href,title:i(this).text()||this.href}))}),i.isFunction(t)&&t(o,a),a},getImageLinksInContent:function(e,t){var n=[],a=document.createElement("div");a.innerHTML=e,i("img",a).each(function(e){n.push(this.src),this.src=""});var o=e.match(this.LINK_REGEXP)||[],r=e.match(this.IP_LINK_REGEXP)||[],l=o.concat(r);if(l=i.unique(l),l=i.grep(l,function(e){return e.indexOf("//")>=0&&n.indexOf(e)<0}),0==l.length)i.isFunction(t)&&t(n);else{i.isFunction(t)&&t(n);var c=[],d=0;i(l).each(function(e,n){s.UrlUtil.getUriType(n,function(e){d++,e&&e.indexOf("image")>=0&&c.push(n),d==l.length&&(c=i.unique(c),i.isFunction(t)&&t(c))})})}},getImagesInContent:function(e,t){this.getImageLinksInContent(e,function(e){var n=0,a=[];i(e).each(function(o,r){s.ImageUtil.isImageUrl(r,function(o,s){n++,s&&a.push({url:s.src,width:s.naturalWidth||s.width,height:s.naturalHeight||s.height}),n==e.length&&i.isFunction(t)&&t(a)})})})},getImagesInContentAlpha:function(e,t){var n=e.match(this.LINK_REGEXP)||[],a=e.match(this.IP_LINK_REGEXP)||[],o=n.concat(a);if(o=i.unique(o),o=i.grep(o,function(e){return e.indexOf("//")>=0}),o.length>0){var r=[],l=[],c=[],d=0;i(o).each(function(e,n){0==n.indexOf("//")&&(n="http:"+n),s.ImageUtil.isImageType(this,function(e,n){d++,n?(r.push(e),l.push({url:n.src,width:n.naturalWidth||n.width,height:n.naturalHeight||n.height})):c.push(e),d==o.length&&i.isFunction(t)&&t(r,l)})})}else i.isFunction(t)&&t([])},getTitle:function(e){if(!e)return"无标题";e=e.replace(/\&nbsp\;/gi," "),e=e.replace(/\<br[^<>]{0,}\>/,"\n"),e=e.replace(/(<([^>]+)>)/gi,"");var t="";return e.match(/^[^\n\,\.\;\'\"\，\。\、\；\’\”]+/)&&(t=e.match(/^[^\n\,\.\;\'\"\，\。\、\；\’\”]+/)[0]),t=t?t.substr(0,24):e.substr(0,24),i.trim(t)||"无标题"},getSummaryData:function(e){if(!e)return"";var t=i(i.parseHTML(e));t=i("<div>").append(t);var n,o=t.find("img"),s=null,r=null,l=0,c=0;t.find("a").each(function(){var e=i(this).data("media");if(e){var t=i(this).data("type"),n=i(this).data("duration");return s={url:e,type:t,duration:n,featured:1},!1}}),o.each(function(){return this.src.indexOf("//"+a.img_cdn_domain)>=0&&(n=this.src.match(/\_W(\d+)\_H(\d+)/),n&&(l=n[1],c=n[2])),l||(l=this.naturalWidth||this.width,c=this.naturalHeight||this.height),0==l?s={url:this.getAttribute("_src")||this.src,type:"image/png",featured:1}:l>120&&(s={url:this.getAttribute("_src")||this.src,type:"image/png",width:l,height:c,featured:1}),s?(i(this).data("video")&&(r={url:i(this).data("video"),type:"video",featured:1}),!1):void 0}),e=e.replace(/\<a[^><]{0,}href\=["']?([^'"><]+)["']?[^><]{0,}\>[^<>]{0,}\<\/a\>/gi,function(e,t,n,i){var a=e.match(/\<a[^><]{0,}\>([^<>]{0,})\<\/a\>/i);return a=a?a[1]:null,t&&a&&(e='[[a href="'+t+'"]]'+a+"[[/a]]"),e}),e=e.replace(/\<\/(div|p|h1|h2|h3|h4|h5|h6|section|code|blockquote|li|ul|ol|article)\>/g,"\n"),e=e.replace(/\<br[\s\/]{0,2}\>/g,"\n"),e=e.replace(/\n{2,}/g,"\n"),e=e.replace(/(<([^>]+)>)/gi,""),e=e.replace(/\[\[/gi,"<"),e=e.replace(/\]\]/gi,">");var d=i(i.parseHTML(e));d.find(".media").remove();var u=0,f="",h="";d.each(function(){if(100>u&&i(this).text())if(f=i.trim(i(this).text().replace(/\s+/," ")),this.href)f.length<100?(u+=f.length,i(this).text(f),h+=i("<div>").append(this).html()):(i(this).text(f.slice(0,100-u)),h+=i("<div>").append(this).html(),u=100);else{var e=f.slice(0,100-u);h+=e,u+=e.length}});var g=this.ensureHtmlTagClosed(s?"<p>"+h+"</p>":'<p class="noimage">'+h+"</p>");g=g.replace(/\&nbsp\;/g," ");var p={text:g,feature_img:s,feature_video:r};return p},getSummary:function(e){if(!e)return"";var t=i(o.parseHTML(e));t=i("<div>").append(t);var n=t.find("img"),a=null,s=0,r=0;n.each(function(){if(s=this.naturalWidth||this.width,r=this.naturalHeight||this.height,0==s)a=this;else if(s>120)return a=this,a.setAttribute("data-width",s),a.setAttribute("data-height",r),!1}),e=e.replace(/\<a[^><]{0,}href\=["']?([^'"><]+)["']?[^><]{0,}\>[^<>]{0,}\<\/a\>/gi,function(e,t,n,i){var a=e.match(/\<a[^><]{0,}\>([^<>]{0,})\<\/a\>/i);return a=a?a[1]:null,t&&a&&(e='[[a href="'+t+'"]]'+a+"[[/a]]"),e}),e=e.replace(/(<([^>]+)>)/gi,""),e=e.replace(/\[\[/gi,"<"),e=e.replace(/\]\]/gi,">");var l=i(i.parseHTML(e)),c=0,d="",u="";l.each(function(){if(100>c&&i(this).text())if(d=i.trim(i(this).text().replace(/\s+/," ")),this.href)d.length<100?(c+=d.length,i(this).text(d),u+=i("<div>").append(this).html()):(i(this).text(d.slice(0,100-c)),u+=i("<div>").append(this).html(),c=100);else{var e=d.slice(0,100-c);u+=e,c+=e.length}});var f=a?i("<div>").append(a).html()+"<p>"+u+"</p>":'<p class="noimage">'+u+"</p>";return this.ensureHtmlTagClosed(f)},handleImageFileInsert:function(e,t,n){var a=URL.createObjectURL(e),o=new Image;o.onload=function(){var l=btoa(Math.random()+Date.now()).replace(/\=/g,""),c=function(e){var t="";"image/gif"==e.type&&(t=" gif");var n='<div class="img'+t+'"><img src="'+e.src+'" _src="'+e.src+'" data-width="'+e.width+'" data-height="'+e.height+'" _src="'+e.url+'"></div>';return n};if(URL.revokeObjectURL(a),"image/gif"==e.type){var d=s.ImageUtil.getFullsizeImgViaSrc(a,e.size,o.width,o.height,!0),u={url:a,width:o.width,height:o.height,type:e.type,size:e.size,blob:e};r.ImageModel.ossupload(u,function(n){if("complete"==n){var a=s.ImageUtil.getFullsizeImgViaSrc(d,e.size,u.width,u.height,!0);u.src=a,u.url=a;var o={};o.image=u,o.html=c(u),i.isFunction(t)&&t(o)}},function(e){e.okprogressID=l,i.isFunction(n)&&n(e)}),o=null}else s.ImageUtil.resizeImage(e,function(e){var d=s.ImageUtil.getFullsizeImgViaSrc(a,e.size,o.width,o.height,!1),u={url:a,width:o.width,height:o.height,type:e.type,size:e.size,blob:e};r.ImageModel.ossupload(u,function(n){if("complete"==n){var a=s.ImageUtil.getFullsizeImgViaSrc(d,e.size,u.width,u.height,!1);u.src=a,u.url=a;var o={};o.image=u,o.html=c(u),i.isFunction(t)&&t(o)}},function(e){e.okprogressID=l,i.isFunction(n)&&n(e)}),o=null})},o.src=a},handleClipdataPaste:function(e,t,n){var a=e,o=this;a.types.indexOf||(DOMStringList.prototype.indexOf=function(e){var t=-1;return i(this).each(function(n,i){return i==e?(t=n,!0):void 0}),t});var s="";if(!(a.types.indexOf("Files")>=0)){s||a.types.indexOf("text/html")>=0&&(s=a.getData("text/html")),s||(s=a.getData("text/uri-list"),s=s?'<a href="'+s+'">'+s+"</a>":a.getData("text/plain")),(s.toLowerCase().indexOf("schemas-microsoft-com:office:office")>=0||s.toLowerCase().indexOf("mso-")>=0)&&(s=a.getData("text/plain")),s=i.trim(s);return s=this.filterContentFromOutside(s),s?(i.isFunction(t)&&t({html:s,images:[]}),s):void 0}if(a.items.length>0)for(var r in a.items){var l=a.items[r];if(l.getAsFile){var c=l.getAsFile();c&&c.type.indexOf("image")>=0&&o.handleImageFileInsert(c,function(e){var n=e.image;e.images=[n],i.isFunction(t)&&t(e)},n)}}},removeEmptyTag:function(e){if(e)for(var t=e.match(/\<([^\>\/]+)\>\<\/([^\>]+)\>/);t&&t[1]==t[2];)e=e.replace(/\<([^\>\/]+)\>\<\/([^\>]+)\>/g,function(e,t,n,i,a){return t==n?"":e}),t=e.match(/\<([^\>\/]+)\>\<\/([^\>]+)\>/);return e},processContentAlpha:function(e,t){if(!e)return"";e=this.removeSpaceBetweenTags(e);var e=this.ensureSystemTagStripped(e);e=e.replace(/\<(li class\=\"[a-z0-9\-\s]{0,}todo\-item(\sdone)?[a-z0-9\-\s]{0,}\")[^>]{0,}\>/gi,"[[$1]]"),e=e.replace(/\<(h5|h4|h3|h2|h1|blockquote|p|span|u|i|b|strong|em|div|ul|ol|li|br|hr)\b([^>]{0,})\>/gi,"[[$1$2]]"),e=e.replace(/\<\/(h5|h4|h3|h2|h1|blockquote|p|span|u|i|b|strong|em|div|ul|ol|li)\b[^>]{0,}\>/gi,"[[/$1]]"),e=e.replace(/\<img[^><]{0,}\ssrc\=["']?([^'"><]+)["']?[^><]{0,}\>/gi,function(e,t,n,i){var o,l,c=e.match(/\<img[^><]{0,}data\-width\=["']?([^'"><]+)["']?[^><]{0,}\>/i),d=e.match(/\<img[^><]{0,}data\-height\=["']?([^'"><]+)["']?[^><]{0,}\>/i),u=e.match(/\<img[^><]{0,}data\-video\=["']?([^'"><]+)["']?[^><]{0,}\>/i),f=e.match(/\<img[^><]{0,}_src\=["']?([^'"><]+)["']?[^><]{0,}\>/i),h=s.ImageUtil.getCachedCDNSrc(t);h||(t=f?f[1]:t?t:a.img_placeholder,h=s.ImageUtil.getCachedCDNSrc(t)||t),
0==h.indexOf("//")&&0==h.indexOf("data")&&(h="http:"+h),c&&c.length>1&&(o=c[1]),d&&d.length>1&&(l=d[1]);var g=o&&l?' data-width="'+o+'" data-height="'+l+'"':"",p=u?' data-video="'+u[1]+'"':"";if(128>o&&h.indexOf(a.img_cdn_domain)>=0&&(h=s.ImageUtil.getFullsizeImgViaSrc(h)),p)return e.replace(/\<img[^><]{0,}src\=["']?([^'"><]+)["']?[^><]{0,}\>/gi,'<div class="img video-img" ><img src="'+h+'" '+g+p+' _src="$1"><a class="vmask okmemo-link" href="'+u[1]+'"'+p+"></a></div>");var m="";if(f){var v=f[1];v&&r.ImageModel.getImageData(v)&&"image/gif"==r.ImageModel.getImageData(v).type&&(m="gif")}return e.replace(/\<img[^><]{0,}src\=["']?([^'"><]+)["']?[^><]{0,}\>/gi,'<div class="img '+m+'"><img src="'+h+'" '+g+' _src="$1"><a class="dl okmemo-link ok-tooltips" data-tooltip="下载图片" data-placement="top" href="#"><span class="gifmark">GIF</span><span class="ok-icon-font ok-extension-download"></span></a></div>')}),e=e.replace(/\<a[^><]{0,}href\=["']?([^'"><]+)["']?[^><]{0,}\>([^><]{0,})(?:\<\/a\>)?/gi,function(e,t,n,i,a){return e.match(/okmemo\-link/)?e:e.match(/\<a[^><]{0,}href\=["']?([^'"><]+)["']?[^><]{0,}rel\=["']?image["']?[^><]{0,}\>([^><]{0,})(?:\<\/a\>)?/)?e.replace(/\<a[^><]{0,}href\=["']?([^'"><]+)["']?[^><]{0,}rel\=["']?image["']?[^><]{0,}\>([^><]{0,})(?:\<\/a\>)?/gi,'<div class="img"><img class="open type-image" src="$1" _src="$1"><a class="dl okmemo-link" href="#"><span class="ok-extension-download ok-icon-font"></span></a></div>'):"#"==t?e:e.replace(/\<a[^><]{0,}href\=["']?([^'"><]+)["']?[^><]{0,}\>([^><]{0,})(?:\<\/a\>)?/gi,'<a class="open" href="$1" rel="link">$2</a>')});var n="http://m.okay.do";return e=e.replace(this.LINK_REGEXP,function(t,i,a,o,s,l){if(t&&t.indexOf(n)<0){if((">"==l[s-1]||"<"==l[s+t.length])&&l.substr(s+t.length,4).indexOf("</a>")>=0)return t;if(l.substr(s-2-n.length,n.length)==n)return t;if("2f"==l.substr(s,2).toLowerCase()&&"%"==l.substr(s-1,1))return t;if(l.substr(s-7,7).indexOf("href")>=0)return t;if(('"'==e[s-1]||"'"==e[s-1])&&"="==e[s-2])return t;if(t.match(/[^\/]+\.(?:png|jpg|jpeg|svg|bmp|gif|tiff)\b/i))return'<div class="img"><img src="'+t+'" _src="'+t+'" style="max-width:100%;" class="fromtxt"><a class="dl" href="#"><span class="ok-download icon-font"></span></a></div>';var c=t;return a||(c=0!=t.indexOf("//")?"http://"+t:r.AppModel.Globals.protocol+":"+t),'<a class="open encoded-link" href="'+c+'">'+t+"</a>"}return t}),e=e.replace(/\[\[/gi,"<"),e=e.replace(/\]\]/gi,">"),e=e.replace(/\/\]\]/gi,"/>")},pasteHtmlInEditable:function(e,t,n){var a=t.ownerDocument,o=a.getSelection();if(o.rangeCount>0){var r=o.getRangeAt(0);r.collapsed||r.deleteContents();var l=i(r.startContainer).closest("li");if(l.length>0){var c=document.createElement("div");c.innerHTML=e;var d=!0;if(i(c.childNodes).each(function(){return this.tagName&&s.DomUtil.isBlockTag(this.tagName)?(d=!1,!1):void 0}),d)return i.isFunction(n)&&n(e),!0;var u=l.get(0),f=l.closest("ul").length>0?l.closest("ul").get(0):l.closest("ol").get(0),h=u.innerText||u.textContent;if(h&&h.match(/\n/)&&1==u.childNodes.length){var g=u;u.innerHTML=""}else var p=s.DomUtil.splitNode(u,r.startContainer,r.startOffset),g=p;i(c.childNodes).each(function(){if("UL"==this.tagName||"OL"==this.tagName||i("ul,ol",this).length>0){var e=i("ul,ol",this).length>0?i("ul,ol",this).get(0):this;if(f.tagName!=e.tagName){var t=s.DomUtil.splitNode(f,r.startContainer,r.startOffset);t&&(t.parentNode.insertBefore(e,t.nextSibling),g=t)}else i(e.childNodes).each(function(){if("LI"==this.tagName)this.lastChild&&"BR"==this.lastChild.tagName&&i(this.lastChild).remove(),g.parentNode.insertBefore(this,g.nextSibling),g=this;else{if(0==u.childNodes.length)u.appendChild(this),e=u;else{var e=document.createElement("li");e.setAttribute("class",u.getAttribute("class")),e.appendChild(this),g.parentNode.insertBefore(e,g.nextSibling)}g=e}}),i(e).remove();if(this.childNodes.length>0){if(0==u.childNodes.length)u.appendChild(this),n=u;else{var n=document.createElement("li");n.setAttribute("class",u.getAttribute("class")),n.appendChild(this),g.parentNode.insertBefore(n,g.nextSibling)}g=n}}else{if(0==u.childNodes.length)u.appendChild(this),n=u;else{var n=document.createElement("li");n.setAttribute("class",u.getAttribute("class")),n.appendChild(this),g.parentNode.insertBefore(n,g.nextSibling)}g=n}}),i("li",t).each(function(){(0==this.childNodes.length||1==this.childNodes.length&&""==this.childNodes[0].nodeValue)&&i(this).remove()})}else i.isFunction(n)&&n(e)}}};t["default"]=l,e.exports=t["default"]}).call(t,n(3),n(8),n(3))},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={};n.set=function(e,t,n){if(n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var a="; expires="+i.toGMTString()}else var a="";document.cookie=e+"="+t+a+"; path=/",this[e]=t},n.remove=function(e){e&&(document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/")},n.get=function(e){var t="; "+document.cookie,n=t.split("; "+e+"=");return 2==n.length?n.pop().split(";").shift():void 0},t["default"]=n,e.exports=t["default"]},function(e,t,n){(function(n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={isTextBlock:function(e){return e?n(e).is("br")?!1:!this.isBlock(e)&&(n(e).next().is("br")||n(e).find("br,div").length>0||n(e).is("img")||e.parentNode.lastChild==e||this.isBlock(e.nextSibling)):!1},isBlockTag:function(e){var t,n=document.createElement(e),i="getComputedStyle"in window;return document.body.appendChild(n),t=(i?window.getComputedStyle(n,""):n.currentStyle).display,document.body.removeChild(n),"block"==t||"list-item"==t},isBlock:function(e){if(!e||!e.tagName)return!1;var t=n(e).css("display");return"block"==t||"list-item"==t},containsBlock:function a(e){var a=!1,t=this;return e&&n(e.childNodes).each(function(){return t.isBlock(this)?(a=!0,!1):void 0}),a},textBlockInNode:function(e){var t=[],i=this;return e&&n(e.childNodes).each(function(){i.isTextBlock(this)&&t.push(this)}),t},splitList:function(e,t,i){if(e){var a=e.childNodes.length,o=document.createElement(e.tagName),s=null;return e.parentNode.insertBefore(o,e),i&&e.parentNode.insertBefore(i,e),n(e.childNodes).each(function(i,r){r==t||n.contains(r,t)?(a=i,s||(s=document.createElement(e.tagName),e.parentNode.insertBefore(s,e)),s.appendChild(r)):a>i?o.appendChild(r):(s||(s=document.createElement(e.tagName),e.parentNode.insertBefore(s,e)),s.appendChild(r))}),o&&0==o.childNodes.length&&n(o).remove(),s&&0==s.childNodes.length&&n(s).remove(),n(e).remove(),[o,s,i]}},unwrapNode:function(e){e&&e.childNodes.length>0&&(n(e.childNodes).each(function(){e.parentNode.insertBefore(this,e)}),n(e).remove())},splitNode:function(e,t,n){var i=e.parentNode,a=this.getNodeIndex(i,e),o=t.ownerDocument,s=o.createRange();s.setStart(i,a),s.setEnd(t,n);var r=s.extractContents(),l=r.childNodes[0];return i.insertBefore(r,e),l},getNodeIndex:function(e,t){for(var n=e.childNodes.length;n--&&t!==e.childNodes[n];);return n}};t["default"]=i,e.exports=t["default"]}).call(t,n(3))},function(e,t,n){(function(n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={Common:{getEvent:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){if(document.all)return window.event;for(func=getEvent.caller;null!=func;){var e=func.arguments[0];if(e&&(e.constructor==Event||e.constructor==MouseEvent||"object"==typeof e&&e.preventDefault&&e.stopPropagation))return e;func=func.caller}return null}),getMousePos:function(e){return e||(e=this.getEvent()),e.pageX||e.pageY?{x:e.pageX,y:e.pageY}:document.documentElement&&document.documentElement.scrollTop?{x:e.clientX+document.documentElement.scrollLeft-document.documentElement.clientLeft,y:e.clientY+document.documentElement.scrollTop-document.documentElement.clientTop}:document.body?{x:e.clientX+document.body.scrollLeft-document.body.clientLeft,y:e.clientY+document.body.scrollTop-document.body.clientTop}:void 0},getViewportSize:{w:window.innerWidth?window.innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body.offsetWidth,h:window.innerHeight?window.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.offsetHeight},isIE:!!document.all,setOuterHtml:function(e,t){var n=document.createRange();e.innerHTML=t,n.selectNodeContents(e);var i=n.extractContents();e.parentNode.insertBefore(i,e),e.parentNode.removeChild(e)}},SetOpacity:function(e,t){this.Common.isIE?e.filters.alpha.opacity=t:e.style.opacity=t/100},drag:function(e,t,i,a,o){var s=this.Common;t?this.keepOrigin=t.keepOrigin&&(1==t.keepOrigin||0==t.keepOrigin)?t.keepOrigin:!1:this.keepOrigin=!1,this.originDragDiv=null,this.tmpX=0,this.tmpY=0,this.moveable=!1;var r=this;n(document).on("mousedown",e,function(e){var t=e||window.event||s.getEvent();if(!(s.isIE&&1==t.button||!s.isIE&&0==t.button))return!1;var l=n(this).closest(".note").get(0);if(n(l).hasClass("expand"))return!1;n(l).addClass("dragging"),e.altKey||e.metaKey||e.ctrlKey?n(l).addClass("copy"):n(l).removeClass("copy"),i();var c=n("<div><div>").css({position:"absolute",top:0,width:"100%",height:"100%"});n("#editor").append(c),r.keepOrigin&&(r.originDragDiv=document.createElement("div"),n(r.originDragDiv).css({position:"fixed",width:l.offsetWidth+"px",height:l.offsetHeight+"px",opacity:"0.5","z-index":"1212121221"}),r.originDragDiv.appendChild(n(l).clone().get(0)),n(r.originDragDiv).find(".handle").removeClass("fp-tooltips"),document.body.appendChild(r.originDragDiv)),r.moveable=!0;var d=s.getMousePos(t),u=l.getBoundingClientRect();r.tmpX=d.x-u.left,r.tmpY=d.y-u.top,s.isIE?l.setCapture():window.captureEvents(Event.mousemove),r.SetOpacity(l,r.opacity),t.preventDefault&&(t.preventDefault(),t.stopPropagation()),document.onmousemove=function(e){if(r.moveable){var t=e||window.event||s.getEvent();document.all&&(t.returnValue=!1);var i=s.getMousePos(t);n.isFunction(a)&&a(i),r.originDragDiv.style.left=i.x-r.tmpX+"px",r.originDragDiv.style.top=i.y-r.tmpY+"px"}},document.onmouseup=function(e){if(r.moveable){var t=e||window.event||s.getEvent();s.isIE?l.releaseCapture():window.releaseEvents(r.originDragDiv.mousemove),n(l).removeClass("dragging copy"),c.remove(),n(r.originDragDiv).remove(),r.moveable=!1,r.tmpX=0,r.tmpY=0;var i=s.getMousePos(t);n.isFunction(o)&&o(e,i,l)}}})}};t["default"]=i,e.exports=t["default"]}).call(t,n(3))},function(e,t,n){(function(n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={isFlashAvailable:function(){var e=!1;try{var t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");t&&(e=!0)}catch(n){navigator.mimeTypes&&void 0!=navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(e=!0)}return e},initENV:function(){var e=this;!function(t){var n="-",i="";if(screen.width){var a=screen.width?screen.width:"",o=screen.height?screen.height:"";i+=""+a+" x "+o}var s,r,l,c=navigator.appVersion,d=navigator.userAgent,u=navigator.appName,f=""+parseFloat(navigator.appVersion),h=parseInt(navigator.appVersion,10);-1!=(r=d.indexOf("Opera"))?(u="Opera",f=d.substring(r+6),-1!=(r=d.indexOf("Version"))&&(f=d.substring(r+8))):-1!=(r=d.indexOf("MSIE"))?(u="Microsoft Internet Explorer",f=d.substring(r+5)):-1!=(r=d.indexOf("Chrome"))?(u="Chrome",f=d.substring(r+7)):-1!=(r=d.indexOf("Safari"))?(u="Safari",f=d.substring(r+7),-1!=(r=d.indexOf("Version"))&&(f=d.substring(r+8))):-1!=(r=d.indexOf("Firefox"))?(u="Firefox",f=d.substring(r+8)):-1!=d.indexOf("Trident/")?(u="Microsoft Internet Explorer",f=d.substring(d.indexOf("rv:")+3)):(s=d.lastIndexOf(" ")+1)<(r=d.lastIndexOf("/"))&&(u=d.substring(s,r),f=d.substring(r+1),u.toLowerCase()==u.toUpperCase()&&(u=navigator.appName)),-1!=(l=f.indexOf(";"))&&(f=f.substring(0,l)),-1!=(l=f.indexOf(" "))&&(f=f.substring(0,l)),-1!=(l=f.indexOf(")"))&&(f=f.substring(0,l)),h=parseInt(""+f,10),isNaN(h)&&(f=""+parseFloat(navigator.appVersion),h=parseInt(navigator.appVersion,10));var g=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(c),p=!!navigator.cookieEnabled;"undefined"!=typeof navigator.cookieEnabled||p||(document.cookie="testcookie",p=-1!=document.cookie.indexOf("testcookie"));var m=n,v=[{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var w in v){var _=v[w];if(_.r.test(d)){m=_.s;break}}var y=n;switch(/Windows/.test(m)&&(y=/Windows (.*)/.exec(m)[1],m="Windows"),m){case"Mac OS X":y=/Mac OS X (10[\.\_\d]+)/.exec(d)[1];break;case"Android":y=/Android ([\.\_\d]+)/.exec(d)[1];break;case"iOS":y=/OS (\d+)_(\d+)_?(\d+)?/.exec(c),y=y[1]+"."+y[2]+"."+(0|y[3])}var b="no check";if("undefined"!=typeof swfobject){var C=swfobject.getFlashPlayerVersion();b=C.major>0?C.major+"."+C.minor+" r"+C.release:n}t._ENV={screen:i,browser:u,browserVersion:f,mobile:g,os:m,osVersion:y,cookies:p,flashVersion:b,flashAvailable:e.isFlashAvailable(),device:m+" "+y+" "+u}}(window);var t=n("body");("ontouchstart"in window||window.navigator.pointerEnabled||window.navigator.msPointerEnabled)&&window._ENV.mobile&&(document.addEventListener("touchstart",function(){},!1),t.addClass("touch-device")),""!=document.createElement("a").download?t.addClass("no-attr-dl"):t.addClass("attr-dl");var a=this.getBrowserName();if(window._ENV){var o=window._ENV.os.replace(/[\s|\_]/g,"-").toLowerCase(),s=window._ENV.browser.replace(/[\s|\_]/g,"-").toLowerCase();a&&(window.browser=a),t.addClass(o+" "+(a||s))}window.innerWidth<400&&t.addClass("in-sidebar"),null!=navigator.userAgent.match(/iPad/i)&&t.addClass("ipad"),window.top==self&&t.addClass("topwin"),"WebkitAppearance"in document.documentElement.style&&t.addClass("webkit"),i.enable_custom_css_scrollbar&&t.addClass("custom-css-scrollbar hover"),window.isTransformSupported=function(){var e=document.createElement("div");return void 0!==e.style.transform||void 0!==e.style.webkitTransform||void 0!==e.style.msTransform||void 0!==e.style.oTransform||void 0!==e.style.MozTransform}()},getBrowserName:function(){var e=null;if("undefined"!=typeof window.chrome&&navigator.userAgent.toLowerCase().indexOf("qqbrowser")>=0)return"qq";if("undefined"!=typeof window.safari)return"safari";if("undefined"!=typeof window.sogou||window.external&&window.external.Sogou404)return"sogou";if("undefined"!=typeof InstallTrigger||"undefined"!=typeof window.scrollMaxX)return"firefox";if(navigator.userAgent.toLowerCase().indexOf("opera")>=0)return"opera";if("chrome"==e&&window.external){var t=Object.keys(window.external);if(t.length>0)for(var n=0,i=t.length;i>n;n++)if(t[n].toLowerCase().indexOf("liebao")>=0)return e="liebao"}else if(this.is360se())return"360se";return("undefined"!=typeof window.chrome||navigator.userAgent.toLowerCase().indexOf("chrome")>=0)&&(e="chrome"),"chrome"==e&&window.external&&Object.keys(window.external).length>2&&(e="360ee"),e},is360se:function(){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&navigator.mimeTypes["application/x-shockwave-flash"]){var e=navigator.mimeTypes["application/x-shockwave-flash"].description.toLowerCase();if(e.indexOf("adobe")>-1)return!0}return!1}};t["default"]=a,e.exports=t["default"]}).call(t,n(3),n(8))},function(e,t,n){(function(i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(4),r=n(9),l=n(12),c={_bgPort:null,_tab:null,getCurrentExtVersion:function(){if(i.version)return i.version;var e="";if("undefined"!=typeof chrome&&chrome.extension){var t=a.ajax({url:chrome.extension.getURL("/manifest.json"),async:!1,dataType:"json"});t&&t.responseJSON&&(e=t.responseJSON.version)}else if("undefined"!=typeof safari&&safari.extension){var t=a.ajax({url:safari.extension.baseURI+"Info.plist",async:!1,dataType:"xml"});t&&t.responseXML&&a("dict > key",t.responseXML).each(function(){"CFBundleShortVersionString"==a(this).text()&&(e=a(this).next().text())})}return e&&(i.version=e),e},isExtensionInstalled:function(){return window.chrome&&chrome.extension&&chrome.extension.getURL?"chrome":window.safari&&safari.extension?"safari":!1},setExtBindings:function(){var e=this,t=this.isExtensionInstalled();if("chrome"==t&&this.isInsideExtension()){var n=chrome.runtime.connect();n&&(e._bgPort=n,e._bgPort.onMessage.addListener(function(t,n){if(t.tab){e._tab=t.tab;var i=s.UrlUtil.parseURL(t.tab.url);!i.protocol||"http"!=i.protocol&&"https"!=i.protocol||(r.AppModel.Globals.protocol=i.protocol)}"save_note"==t.command&&l.CreateNote.relCreateNote(t.note)}))}else"safari"==t?safari.self.addEventListener("message",function(e){if(console.log(e),"command"==e.name){var t=e.message.command;"save_note"==t&&l.CreateNote.relCreateNote(e.message.note)}}):location.host.match(/okay.do$/)&&(r.AppModel.Globals.protocol=location.protocol.replace(":",""),a(window).on("message",function(e){var t=e.originalEvent,n=t.data;"save_note"==n.command&&l.CreateNote.relCreateNote(n.note)}));a(window).on("message",function(t){var n=t.originalEvent,i=n.data;if(i.command)switch(i.command){case"open":e.handleAppOpen(i.userTrigger);break;case"close":e.handleAppClose();break;case"top_info":break;case"app_state_open":e.handleAppOpen(!1);break;case"even_larger":var o=a("body").hasClass("full-page");o&&l.App.toggleSidebar()}}),a(document).on("dragend",function(){window.top.postMessage({drag:"dragend"},"*")})},sendMsgToBg:function(e,t){window.chrome&&chrome.runtime&&chrome.runtime.sendMessage(e,function(e){a.isFunction(t)&&t(e)})},listenBgCmd:function(e,t){window.chrome&&chrome.runtime&&chrome.runtime.onMessage.addListener(function(n,i,o){e==n.command&&a.isFunction(t)&&t(n)})},handleAppOpen:function(e){s.WindowMessager.notifyCurrentPage("appopen",e)},handleAppClose:function(){s.WindowMessager.notifyCurrentPage("appclose")},isInsideExtension:function(){return window.chrome?chrome.extension:void 0},sendInfoToExt:function(){var e=l.App.currentTag||r.TagModel.getLastOpenedTag();e.tid!=i.TRASHBIN_ID&&e.tname!=i.TRASHBIN_NAME||(e={tid:i.ALL_TAG_ID,tname:i.ALL_TAG_NAME}),this.updateCurrentTag(e);var t=r.TagModel.getHistory(!0);if(t&&t.length>0){var n=[];t=a.grep(t,function(t){return t&&n.indexOf(t.tid)<0?(n.push(t.tid),t.tid!=e.tid&&t.tname!=e.tname&&t.tname!=i.TRASHBIN_NAME):!1})}this.updateRecentTags(t)},updateCurrentTag:function(e){o.debug("EXT_TAGS","更新当前标签为:"+e.tname),s.WindowMessager.notifyTop({command:"update_current_tag",currentTag:e})},updateRecentTags:function(e){if(e&&e.length>0){var t=[];e=a.grep(e,function(e){return t.indexOf(e.tname)<0?(t.push(e.tname),e.tname!=i.TRASHBIN_NAME&&e.tname!=i.ALL_TAG_NAME&&e.tname!=i.SECRET_NAME&&e.tname!=i.NO_TAG_NAME):!1})}o.debug("EXT_TAGS","更新最近标签为:",e),s.WindowMessager.notifyTop({command:"update_recent_tags",recentTags:e})}};t["default"]=c,e.exports=t["default"]}).call(t,n(8),n(3),n(13))},function(e,t,n){(function(i,a,o){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(46),l=s(r),c=n(9),d=n(4),u={getSidebarImgViaSrcAlpha:function(e,t){var n=window.devicePixelRatio?Math.min(window.devicePixelRatio,2):1,a=i.sidebar_img_width*n;i.sidebar_img_height*n;if(e.indexOf("//"+i.img_cdn_domain)>=0){if(e.indexOf(a)>0)return e;var o=e.split("@");if(o&&o[0])return o[0]+"@0e_"+a+"w"}return i.img_origin+"/"+this.getCDNImageName(e,t)+"@0e_"+a+"w"},getCDNImageNameAlpha:function(e,t){if(Date.now()>1449242085158){if(!isNaN(t))return(0,l["default"])(e+"_"+t);var n=c.ImageModel.getImageData(e);if(n&&n.size)return(0,l["default"])(e+"_"+n.size)}return(0,l["default"])(e)},getSidebarImgViaSrc:function(e,t,n,a,o){var s=window.devicePixelRatio?Math.min(window.devicePixelRatio,2):1,r=i.sidebar_img_width*s;i.sidebar_img_height*s;if(e.indexOf("//"+i.img_cdn_domain)>=0){if(e.indexOf(r)>0||r>n)return e;var l=e.split("@");if(l&&l[0])return l[0]+"@0e_"+r+"w"}return r>n?i.img_origin+"/"+this.getCDNImageName(e,t,n,a,o):i.img_origin+"/"+this.getCDNImageName(e,t,n,a,o)+"@0e_"+r+"w"},resizeCDNImageSrc:function(e){var t=window.devicePixelRatio?Math.min(window.devicePixelRatio,2):1,n=i.sidebar_img_width*t,a=e.replace(/\@.+/,""),o=a.match(/\_W(\d+)\_H(\d+)\_G([01])/);return o&&o[1]<=n&&1!=o[3]?a:a+"@0e_"+n+"w"},getCDNImageName:function(e,t,n,i,a){return(0,l["default"])(e+"_"+t)+"_W"+n+"_H"+i+"_G"+(a?1:0)},getFullsizeImgViaSrc:function(e,t,n,a,o){return e.indexOf("//"+i.img_cdn_domain)>=0?e.replace(/\@.+/,""):i.img_origin+"/"+this.getCDNImageName(e,t,n,a,o)},getBlobViaAjax:function(e,t){var n=this,i=new XMLHttpRequest;i.open("get",e,!0),i.responseType="blob",i.onload=function(){if(200==this.status){var i=this.response;i&&i.type&&("image/gif"==i.type?t(i,e):n.resizeImage(i,function(n){window.test=n,t(n,e)}))}},i.send(null)},resizeImage:function(){function e(){var e=a("body");e.append('<canvas id="canvas_compress_pictures" style="display: none;"></canvas>')}function t(t,n,o,s){e();var r=new Image;r.onload=function(){var e,t,l=document.getElementById("canvas_compress_pictures");e=n||r.width,e=Math.min(i.max_upload_width,e),e=Math.round(e),t=r.height*(e/r.width),t=Math.round(t),l.width=e,l.height=t;var c=l.getContext("2d");c.clearRect(0,0,l.width,l.height),c.drawImage(r,0,0,e,t);for(var d=o&&"image/webp"!=o?o:"image/jpeg",u=l.toDataURL(d,.8),f=atob(u.split(",")[1]),h=new Uint8Array(f.length),g=0;g<f.length;g++)h[g]=f.charCodeAt(g);var p=new Blob([h.buffer],{type:d});a.isFunction(s)&&s(p,e,t),l.remove&&l.remove()},r.onerror=s,r.src=t}var n=function(e,n,i){if(e){if(a.isFunction(n)&&(i=n,n=null),"object"==typeof e){var o=window.URL.createObjectURL(e);return t(o,n,e.type,function(e,t,n){URL.revokeObjectURL(o),i(e,t,n)})}return t(e,n,null,i)}};return n}(),getCachedCDNSrc:function(e){return e.indexOf("//"+i.img_cdn_domain)>=0?e:c.ImageModel.Globals._imageSrcCache[e]?c.ImageModel.Globals._imageSrcCache[e]:""},downloadImages:function(e){var t,n,i=this;if(a("body").hasClass("attr-dl")){for(var o=0;o<e.length;o++)if(n=e[o]){var s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),t=document.createElement("a"),t.href=n,n.match(/\.(png|gif|webp|bmp|jpg|jpeg)\b/)?t.download=n:t.download=n+".png",t.dispatchEvent(s)}}else if(a(window.parent.document.body).hasClass("firefox")&&d.ExtUtil.extensionInstalled()){var r=null;a(e).each(function(){r={url:this,prefix:i.getCurrentTime()};var e={type:"dl_img",data:r};window.postMessage&&window.top.postMessage(JSON.stringify(e),"*")})}else if(a("body").hasClass("no-attr-dl")){var l=window.open("about:blank"),c="";a(e).each(function(){c+='<div style="float:left;margin:5px;border:1px solid white;width:200px;height:200px;overflow:hidden;" onmouseover=""><img src="'+this+'" ></div>'}),l.document.body.innerHTML=c}},sendBlobImage:function(e,t,n){var i=new FormData;i.append("images",e),i.append("url",t),a.ajax({url:AppModel.getAPIRoot()+"/images/upload",type:"POST",data:i,processData:!1,contentType:!1,success:n})},testImg:function(e,t){var n=new Image;n.onload=function(){t&&t(e),n=null},n.onerror=function(){t&&t(null),n=null},n.src=e},isImageType:function(e,t,n){var i=this;c.Request.head(e,function(a){a&&a.indexOf("image")>-1?i.isImageUrl(e,function(e,i){i&&t&&t.call(n,e,i)}):t&&t.call(n,e,!1)})},isImageUrl:function(e,t,n){if(!e)return!1;var i=document.getElementById("testImg"),s=document.createElement("img");if(i)i.contentWindow.document.body.appendChild(s);else{var r=document.createElement("iframe");r.id="testImg",r.width=0,r.height=0,r.style.margin=0,r.style.padding=0,r.style.visibility="hidden",r.style.border="none",r.style.outline="none",r.style.position="absolute",r.style.bottom=0,r.style.left=0,r.style.height="0px",r.style.width="0px",document.body.appendChild(r),r.contentWindow.document.body.appendChild(s)}try{a.isFunction(t)&&(s.onerror=function(){s.onerror=null,t.call(n,e,!1)},s.onload=function(){s.onload=null,t.call(n,e,s)}),s.src=e}catch(l){o.log(l.message)}},lazyloadImgs:function(e){var t=this;e.each(function(e,n){if((!this.okloaded||0==this.src.indexOf("data")||this.naturalWidth<=1)&&t.elementInViewport(n)){if(-1==this.src.indexOf("data")&&t.isSmallImage(n))return n.okloaded=!0,!0;var i=a(n).attr("_src");if(i){var o=a(n).closest(".note"),s=t.getSidebarImgViaSrc(i),r=new Image;a(r).one("load",function(){n.okloaded=!0,a(n).one("load",function(){o.trigger("imgloaded",n),this.src==s&&(c.ImageModel.Globals._imageSrcCache[a(n).attr("_src")]=s)}),n.src=r.src,r=null}).one("error",function(){n.okloaded=!0;var e=a(n).attr("_src");a(n).one("load",function(){o.trigger("imgloaded",n);var e=c.ImageModel.getImageData(a(n).attr("_src"));n.src!=a(n).attr("_src")||e&&e.size||c.ImageModel.Globals.imagesNotSaved.indexOf(n.src)<0&&(o.trigger("imgerror",n),c.ImageModel.Globals.imagesNotSaved.push(n.src)),a(this).closest(".img").removeClass("load-failed")}),0==e.indexOf("//")&&(e="http:"+e),n.setAttribute("src",e),c.ImageModel.Globals._imageSrcCache[e]=e,r=null}),r.setAttribute("src",s)}}})},elementInViewport:function(e){var t=a(e),n=a(window),i=n.scrollTop(),o=i+n.height(),s=t.offset().top;s+t.height();return o>=s&&s>=i},isSmallImage:function(e){var t=e.naturalWidth||e.width,n=e.naturalHeight||e.height;return t>5&&128>t&&n>5&&128>n},placeImgInNote:function(e,t){if(!e)return!1;var n=a(e).closest(".img");if(n.length>0){n.get(0).style.maxHeight="";var o=e.naturalWidth||e.offsetWidth,s=e.naturalHeight||e.offsetHeight;if(o>=.7*i.sidebar_img_width){i.sidebar_img_width,s*(i.sidebar_img_width/o);e.style.width="100%"}else o>=.3*i.sidebar_img_width?n.get(0).style.maxHeight=o+"px":n.hasClass("video-img")&&(n.find(".dl").remove(),n.replaceWith(e))}}};t["default"]=u,e.exports=t["default"]}).call(t,n(8),n(3),n(13))},function(e,t,n){(function(n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={extendJquery:function(){i.fn.showWithAnim=function(e,t){var i=n(this);if(0===i.length)return!1;var a="anim";"string"==typeof e&&(a=e),e=e||{},a=e.className||a,i.show(),setTimeout(function(){i.addClass(a),n.isFunction(t)&&t()},50)},i.fn.hideWithAnim=function(e,t){var i=n(this);if(0===i.length)return!1;var a="anim";"string"==typeof e&&(a=e),e=e||{};var a=e.className||a,o=e.timeout||300;i.removeClass(a),setTimeout(function(){i.hide(),n.isFunction(t)&&t()},o)},i.fn.aloha=function(e){var t=this,i=null,e=e||{},a=(e.leftOffset||0,e.container||document.body);n(a).on("mouseover",t.selector,function(e){var t=n(this).data("tooltip")||this.title;if(this.title&&(n(this).attr("data-tooltip",this.title),this.title=""),t){var i='<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>';n(a).append(i);var o=n(".tooltip",a),s=o.find(".tooltip-inner");s.text(t);var r=n(this).data("placement")||"top";o.addClass(r);var l=n(this).offset().top,c=n(this).offset().left-(o.innerWidth()/2-n(this).innerWidth()/2);"top"==r?l=l-o.height()-10:"bottom"==r?l+=n(this).height():"left"==r?(c=n(this).offset().left-o.width()-10,l-=o.height()/2-n(this).height()/2):"right"==r&&(c=n(this).offset().left+n(this).width(),l-=o.height()/2-n(this).height()/2),o.css({top:l+"px",left:c+"px",opacity:1,zIndex:1e5}),n(this).one("mousedown",function(e){n(".tooltip",a).remove()}),n(window).one("scroll",function(e){n(".tooltip",a).remove()})}}),n(a).on("mouseout",t.selector,function(e){n(".tooltip",a).remove(),i&&clearTimeout(i)})}}()};t["default"]=a,e.exports=t["default"]}).call(t,n(3),n(3))},function(e,t,n){(function(i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(4),r={images:i([]),settings:{threshold:200,container:window},filterLoadedImg:function(){return this.images=i.grep(this.images,function(e){return 1!=i(e).data("loaded")}),this.images},lazyLoad:function(e){if(e){if(0==e.length)return;this.images=i(this.images).add(e)}this.images=this.filterLoadedImg();var t=this,n="";i(this.images).each(function(e,a){var o=i(this);t.inviewport(this,t.settings)&&(n=o.attr("data-origin"),n&&s.ImageUtil.testImg(n,function(e){e?(o.attr("src",e),o.data("loaded","1"),o.css({background:"#f0f0f0"})):(e=o.attr("_src"),s.ImageUtil.testImg(e,function(e){e?(o.attr("src",e),o.data("loaded","1"),o.css({background:"#f0f0f0"})):o.attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC")}))}))})},makeUrl:function(e){var t=document.createElement("div");t.innerHTML=e;var n=i(t).find("img");if(n.length>0)for(var r,l,c,d,u,f,h,g,p=0;p<n.length;p++)d=i(n[p]).attr("src"),i(n[p]).parent().hasClass("media")&&(g=!0),d?(f=d.indexOf("//"+o.img_cdn_domain)>=0,f&&(h=d.indexOf("_G1")>=0),0==d.indexOf("//")&&(d=AppModel.Globals.protocol+":"+d),f&&(d=s.ImageUtil.resizeCDNImageSrc(d)),i(n[p]).attr("data-origin",d),l=i(n[p]).data("width"),r=i(n[p]).data("height"),l||r||f&&(u=d.match(/\_W(\d+)\_H(\d+)/),u&&(l=u[1],r=u[2])),l&&r&&(c=l/r,g?(i(n[p]).parent().addClass("img big-img"),i(n[p]).after('<span class="media-cover cover-btn"></span>')):(l>129?(i(n[p]).wrap("<div class='img big-img'></div>"),l>300&&!h&&i(n[p]).after('<span class="img-icon icon-font fp-ext-zoom-in fp-tooltips" data-tooltip="查看大图" data-placement="top""></span>'),i(n[p]).css({width:o.content_img_maxwidth+"px",height:o.content_img_maxwidth/c+"px"})):(i(n[p]).wrap("<div class='img small-img'></div>"),1>=c&&i(n[p]).css({width:l+"px",height:r+"px"})),h&&i(n[p]).after('<span class="img-icon gif fp-tooltips" data-tooltip="查看GIF" data-placement="top">GIF</span>'))),g=!1,i(n[p]).attr("src","")):a.debug("图片加载","无src图");return t.innerHTML},belowthefold:function(e,t){var n;return n=void 0===t.container||t.container===window?(window.innerHeight?window.innerHeight:i(window).height())+i(window).scrollTop():i(t.container).offset().top+i(t.container).height(),n<=i(e).offset().top-t.threshold},rightoffold:function(e,t){var n;return n=void 0===t.container||t.container===window?i(window).width()+i(window).scrollLeft():i(t.container).offset().left+i(t.container).width(),n<=i(e).offset().left-t.threshold},abovethetop:function(e,t){var n;return n=void 0===t.container||t.container===window?i(window).scrollTop():i(t.container).offset().top,n>=i(e).offset().top+t.threshold+i(e).height()},leftofbegin:function(e,t){var n;return n=void 0===t.container||t.container===window?i(window).scrollLeft():i(t.container).offset().left,n>=i(e).offset().left+t.threshold+i(e).width()},inviewport:function(e,t){return!(this.rightoffold(e,t)||this.leftofbegin(e,t)||this.belowthefold(e,t)||this.abovethetop(e,t))}};t["default"]=r,e.exports=t["default"]}).call(t,n(3),n(13),n(8))},function(e,t,n){(function(n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={init:function(){this.getLanguageJson()},getLocalLanguage:function(){return window.navigator.language},getLanguageJson:function(){var e=this.getLocalLanguage(),t="zh";if(e)switch(e){case"zh":t="zh";break;case"zh-CN":t="zh";break;case"zh-TW":t="zh_TW";break;case"en":t="en";break;case"en-US":t="en_US";break;case"uk":t="en_UK"}var i="/";window.safari&&safari.extension&&(i=safari.extension.baseURI);var a=i+"_locales/"+t+"/messages.json",o=n.ajax({type:"GET",url:a,async:!1});window._language=JSON.parse(o.responseText);
},translate:function(e){if(e&&window._language){var t=window._language[e].message;return t}return e}};t["default"]=i,e.exports=t["default"]}).call(t,n(3))},function(e,t,n){(function(i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(9),r={login_url:i.LOGIN_SITE+"/v2/users/login",update_pass_url:i.LOGIN_SITE+"/v2/users/update_pass?rd=extension",login:function(e,t){var n=this,r=i.origin+"/user/wxlogin";if(e)if("edit"==e){var l=s.UserModel.getLocalUser();l&&(r=i.LOGIN_SITE+"/website.php?c=binding&a=email")}else r+="#register";var c=489,d=317,u=(window.screen.height-c)/2,f=(window.screen.width-d)/2,h=window.open(r,"授权登录","height="+c+",width="+d+",top="+u+",left="+f+",toolbar=no,menubar=no,scrollbars=yes,resizable=no,location=no,status=no");h&&(this._checkLoginInt&&clearInterval(this._checkLoginInt),this._checkLoginInt=setInterval(function(){h.closed&&(clearInterval(n._checkLoginInt),n._checkLoginInt=null,s.UserModel.userInfo(function(e){1==e.status||a.debug("登录","登录失败"),o.isFunction(t)&&t(e)}))},500))}};t["default"]=r,e.exports=t["default"]}).call(t,n(8),n(13),n(3))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(4),o={popupDialog:function(e){e.active=!0,i(window).trigger("dialog",e)},closeDialog:function(){i(window).trigger("closedialog")},showMessage:function(e,t,n){i(window).trigger("show_message",{types:t||"success",message:e,show:!0,autoClose:n===!0?!0:n!==!1})},hideMessage:function(){i(window).trigger("show_message",{show:!1})},notifyProfileComplete:function(){this.showSysMessage({id:Date.now()+parseInt(10*Math.random()),types:"profile-complete",icon:"ok-extension-qqmail",content:"亲爱的用户，为了您的账号安全请及时完善邮箱资料",btnValue:"前往完善",onConfirm:function(e){a.LoginUtil.login(!1),e.dismiss()}})},showSysMessage:function(e){e&&(e.isNew=!0,e.id=e.id||Date.now()+parseInt(10*Math.random()),e.btnValue=e.btnValue||"我知道了",i(window).trigger("sys_message",e))},hideSysMessage:function(){i(window).trigger("sys_message",{show:!1})}};t["default"]=o,e.exports=t["default"]}).call(t,n(3))},function(e,t,n){(function(n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={isHidden:function(){var e="hidden";return e in document?document[e]:(e="mozHidden")in document?document[e]:(e="webkitHidden")in document?document[e]:(e="msHidden")in document?document[e]:void 0},pageActiveDetect:function(e,t){var i=function(i){var o="visible",s="hidden",r={focus:o,focusin:o,pageshow:o,blur:s,focusout:s,pagehide:s};i=i||window.event;var l;l=i.type in r?r[i.type]:this[a]?"hidden":"visible","visible"==l?n.isFunction(e)&&e():n.isFunction(t)&&t()},a="hidden";a in document?document.addEventListener("visibilitychange",i):(a="mozHidden")in document?document.addEventListener("mozvisibilitychange",i):(a="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",i):(a="msHidden")in document?document.addEventListener("msvisibilitychange",i):"onfocusin"in document&&(document.onfocusin=document.onfocusout=i),window.onpageshow=window.onpagehide=i},getPageInfo:function(e,t){t=n.isFunction(t)?t:null,n.get(e,function(e){var a=document.createElement("div");a.innerHTML=e;var o=n("title",a).text()||i.default_page_title,s=n("link[href*='.ico']",a).attr("href")||i.default_favicon;t&&t({favicon:s,title:o})});var a={favicon:i.default_favicon,title:i.default_page_title};t&&t(a)},toggleHvr:function(e){n(document).on("mouseenter",e,function(){n(this).addClass("hvr").one("mouseleave",function(){n(this).removeClass("hvr")})})},preventOuterScroll:function(e){n(e).bind("mousewheel",function(e){return this.scrollHeight>this.offsetHeight?(n(this).scrollTop(n(this).scrollTop()-(e.originalEvent.wheelDeltaY||-e.originalEvent.deltaY)),!1):void 0})}};t["default"]=a,e.exports=t["default"]}).call(t,n(3),n(8))},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){e=e||{},this.title=e.title||document.title||"",this.content=(e.content?e.content.replace(/(<([^>]+)>)/gi,""):"")||"",this.share_url=e.share_url||location.href,this.img_url=e.img_url||"",this.extra=e.extra||"",this.twitter_name="funpin",this.content+=" :分享自方片收集"};n.prototype={setShareInfo:function(e){e=e||{},this.title=e.title||document.title||"",this.content=(e.content?e.content.replace(/(<([^>]+)>)/gi,""):"")||"",this.share_url=e.share_url||location.href,this.img_url=e.img_url||"",this.extra=e.extra||"",this.twitter_name=encodeURIComponent("@funpin "),this.content+=" :分享自方片收集"},shareTo:function(e,t){var n="";switch(e){case"gplus":this.share_url&&-1==this.share_url.indexOf("?")?this.share_url+="?__backsrc=gplus":this.share_url+="&__backsrc=gplus",n="https://plus.google.com/share?url="+encodeURIComponent(this.share_url)+this.extra;break;case"facebook":this.content.length>140&&(this.content=this.content.substr(0,130)+"......"),-1==this.share_url.indexOf("?")?this.share_url+="?__backsrc=facebook":this.share_url+="&__backsrc=facebook",this.content=this.content.replace(" ","+"),n="https://wwww.facebook/sharer/sharer.php?u="+encodeURIComponent(this.share_url)+"&t="+this.content+this.extra;break;case"twitter":this.content.length>140&&(this.content=this.content.substr(0,130)+"......"),-1==this.share_url.indexOf("?")?this.share_url+="?__backsrc=twitter":this.share_url+="&__backsrc=twitter",n="https://twitter.com/intent/tweet?url="+encodeURIComponent(this.share_url)+"&text="+encodeURIComponent(this.content)+" @funpin via="+this.twitter_name+this.extra;break;case"tumblr":-1==this.share_url.indexOf("?")?this.share_url+="?__backsrc=weibo":this.share_url+="&__backsrc=weibo",n=this.img_url?"https://www.tumblr.com/share/photo?source="+encodeURIComponent(this.img_url)+"&caption="+encodeURIComponent(this.content)+this.extra:this.share_url?"https://www.tumblr.com/share/link?url="+encodeURIComponent(this.share_url)+"&name="+encodeURIComponent(this.title)+"&description="+encodeURIComponent(this.content)+this.extra:"https://www.tumblr.com/share/quote?quote="+encodeURIComponent(this.content)+"&source="+encodeURIComponent(location.href);break;case"weibo":this.content.length>140&&(this.content=this.content.substr(0,130)+"......"),-1==this.share_url.indexOf("?")?this.share_url+="?__backsrc=weibo":this.share_url+="&__backsrc=weibo",n="http://service.weibo.com/share/share.php?pic="+encodeURIComponent(this.img_url)+"&url="+encodeURIComponent(this.share_url)+"&title="+encodeURIComponent(this.content)+this.extra;break;case"douban":this.content.length>140&&(this.content=this.content.substr(0,130)+"......"),n="http://www.douban.com/share/service?image="+encodeURIComponent(this.img_url)+"&name="+this.title+"&text="+this.content+this.extra;break;case"qqmail":var i="这是我从方片收集中看到的好东西，分享一下",a=document.title;-1==this.share_url.indexOf("?")?this.share_url+="?__backsrc=qqmail":this.share_url+="&__backsrc=qqmail",n="http://mail.qq.com/cgi-bin/qm_share?url="+encodeURIComponent(this.share_url)+"&to=&pics="+encodeURIComponent(this.pic_url)+"&desc="+i+"&summary="+encodeURIComponent(this.content)+"&title="+this.title+"&site="+document.title+this.extra;break;case"qq":var a=document.title;n="http://connect.qq.com/widget/shareqq/index.html?url="+encodeURIComponent(this.share_url)+"&showcount=1&desc="+encodeURIComponent(this.content)+"&summary="+encodeURIComponent(this.content)+"&title="+encodeURIComponent(this.title)+"&site="+encodeURIComponent(a)+"&pics="+encodeURIComponent(this.img_url)+this.extra;break;case"gmail":n="https://mail.google.com/mail/?ui=2&view=cm&fs=1&tf=1&su=&body="+encodeURIComponent(this.content)+"&shva=1&ov=0";break;case"qzone":var i="这是我从方片收集中看到的好东西，分享一下",a=document.title,o=encodeURIComponent(this.img_url);-1==this.share_url.indexOf("?")?this.share_url+="?__backsrc=qzone":this.share_url+="&__backsrc=qzone",n="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url="+encodeURIComponent(this.share_url)+"&pics="+o+"&title="+this.title+"&desc="+i+"&summary="+encodeURIComponent(this.content)+"&site="+a+this.extra;break;case"ttweibo":this.content.length>140&&(this.content=this.content.substr(0,130)+"......"),-1==this.share_url.indexOf("?")?this.share_url+="?__backsrc=qt":this.share_url+="&__backsrc=qt",n="http://share.v.t.qq.com/index.php?c=share&a=index&url="+encodeURIComponent(this.share_url)+"&pic="+encodeURIComponent(this.img_url)+"&title="+encodeURIComponent(this.content)+this.extra}if(n&&t!==!1){var s=500,r=800,l=(window.screen.height-s)/2,c=(window.screen.width-r)/2;window.open(n,"","height="+s+",width="+r+",top="+l+",left="+c+",toolbar=no,menubar=no,scrollbars=yes,resizable=no,location=no,status=no")}return n}},t["default"]=new n,e.exports=t["default"]},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(165),o=i(a),s={time:function(){return Math.ceil(Date.now()/1e3,10)},getTimezone:function(){!function(e){var t=n(42),i=t.determine(),a=i.name();a&&o["default"].set("tz",a,365),o["default"].set("GMT_bias",-(new Date).getTimezoneOffset()/60,365)}(n)},getLocaleDate:function(e){e=e||Date.now();var t=new Date(e);return"Invalid Date"==t&&(t=new Date(e.replace(/-/g,"/"))),t.getFullYear()+"年"+(t.getMonth()+1)+"月"+t.getDate()+"日"},getFormattedTime:function(e){e=e||Date.now();var t=new Date(e);"Invalid Date"==t&&(t=new Date(e.replace(/-/g,"/")));var n=parseInt(t.getMonth()+1)<10?"0"+parseInt(t.getMonth()+1):parseInt(t.getMonth()+1),i=parseInt(t.getDate())<10?"0"+parseInt(t.getDate()):parseInt(t.getDate()),a=parseInt(t.getHours())<10?"0"+parseInt(t.getHours()):parseInt(t.getHours()),o=parseInt(t.getMinutes())<10?"0"+parseInt(t.getMinutes()):parseInt(t.getMinutes()),s=parseInt(t.getSeconds())<10?"0"+parseInt(t.getSeconds()):parseInt(t.getSeconds());return t.getFullYear()+"-"+n+"-"+i+" "+a+":"+o+":"+s},getCurrentTimestamp:function(e){if(isNaN(e))return Date.now();var t=new Date;if(t.getUTCMonth){var n=parseInt(t.getUTCMonth()+1)<10?"0"+parseInt(t.getUTCMonth()+1):parseInt(t.getUTCMonth()+1),i=parseInt(t.getUTCDate())<10?"0"+parseInt(t.getUTCDate()):parseInt(t.getUTCDate()),a=parseInt(t.getUTCHours())<10?"0"+parseInt(t.getUTCHours()):parseInt(t.getUTCHours()),o=parseInt(t.getUTCMinutes())<10?"0"+parseInt(t.getUTCMinutes()):parseInt(t.getUTCMinutes()),s=parseInt(t.getUTCSeconds())<10?"0"+parseInt(t.getUTCSeconds()):parseInt(t.getUTCSeconds()),r=t.getFullYear()+"-"+n+"-"+i+" "+a+":"+o+":"+s,l=new Date(r);return"Invalid Date"==l&&(l=new Date(time.replace(/-/g,"/"))),l.valueOf()+60*e*60*1e3}return Date.now()},getCurrentTime:function(){return this.getFormattedTime()},getTimestamp:function(e){var t=new Date(e);return"Invalid Date"==t&&(t=new Date(e.replace(/-/g,"/"))),t.valueOf()},prettifyTime:function(e){if(!e)return"";var t=new Date,n=new Date(e);if("Invalid Date"==n&&(n=new Date(e.replace(/-/g,"/"))),t.getFullYear()==n.getFullYear()){if(t.getMonth()==n.getMonth()){var i=t.getDate()-n.getDate();if(0==i){var a=t.getHours()-n.getHours();if(0==a){var o=t.getMinutes()-n.getMinutes();if(0==o){var s=t.getSeconds()-n.getSeconds();return s+"秒钟以前"}return o+"分钟以前"}return 6>=a?a+"小时以前":n.getHours()+":"+n.getMinutes()}return 1==i?"昨天 "+n.getHours()+":"+n.getMinutes():n.getMonth()+1+"月"+n.getDate()+"日 "+n.getHours()+":"+n.getMinutes()+":"+n.getSeconds()}return n.getMonth()+1+"月"+n.getDate()+"日 "+n.getHours()+":"+n.getMinutes()+":"+n.getSeconds()}return e}};t["default"]=s,e.exports=t["default"]},function(e,t,n){(function(n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){this.init()};i.prototype={init:function(){var e=this,t=null;n(window).on("resize",function(){t&&clearTimeout(t),t=setTimeout(function(){e.winHeight=n(window).height()},500)})},winHeight:n(window).height()};var a=new i;t["default"]=a,e.exports=t["default"]}).call(t,n(3))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(9),o={isLink:function(e){var t=/((http\:\/\/|https\:\/\/|ftp\:\/\/|\/\/)?([a-z0-9\-]+\.){0,5}[a-z0-9\-]+\.(?:com|cn|hr|io|edu|org|do|fr|jp|tv|name|it|de|mobi|pro|us|fm|asia|net|gov|tel|la|travel|so|biz|info|hk|im|me|co|in|at|bz|ag|eu|in|cc|ly)\b(?:\:[\d+])?[^\<\>\;\(\)\s\"\'\[\]\{\}\<]{0,})/gi,n=/((http\:\/\/|https\:\/\/|ftp\:\/\/|\/\/)?[\d]{1,3}\.[\d]{1,3}\.[\d]{1,3}\.[\d]{1,3}\b(?:\:[\d+])?[^\<\>\;\(\)\s\"\'\[\]\{\}\<]{0,})/gi;return n.test(e)||t.test(e)},parseURL:function(e){var t=document.createElement("a");t.href=e;var n={source:e,protocol:t.protocol.replace(":",""),host:t.hostname,port:t.port,query:t.search,params:function(){for(var e,n={},i=t.search.replace(/^\?/,"").split("&"),a=i.length,o=0;a>o;o++)i[o]&&(e=i[o].split("="),n[e[0]]=e[1]);return n}(),file:(t.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:t.hash.replace("#",""),path:t.pathname.replace(/^([^\/])/,"/$1"),relative:(t.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:t.pathname.replace(/^\//,"").split("/")};return t=null,n},getDomainForUrl:function(e){var t=document.createElement("a");t.href=e;var n=t.hostname||"";return t=null,n},getUriType:function(e,t){a.Request.head(e,function(e){i.isFunction(t)&&t(e)})}};t["default"]=o,e.exports=t["default"]}).call(t,n(3))},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={isValid:function(e,t){switch(e){case"email":if(/^[0-9a-z_][_.0-9a-z-]{0,31}@([0-9a-z][0-9a-z-]{0,30}\.){1,4}[a-z]{2,4}$/.test(t)&&t&&""!=t&&-1!=t.indexOf("@")){var n=t.indexOf("@"),i=t.substring(0,n);return!(i.length>64||t.length>256)}break;case"password":if(t.length<16&&t.length>3)return!0;break;case"nickname":var a=/^[0-9a-zA-Z\u4e00-\u9fa5_-]+$/;if(t.length>0&&t.length<15&&a.test(t))return!0;break;case"introduction":if(t.length<49)return!0;break;case"noteTitle":if(t.length<49)return!0;break;case"tagName":var o=/^[0-9a-zA-Z\u4e00-\u9fa5_-]+$/;if(t.length>0&&t.length<15&&o.test(t))return!0;break;default:return!1}}};t["default"]=n,e.exports=t["default"]},function(e,t,n){(function(n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={supportedVideoSites:["www.youtube.com","vimeo.com","viddler.com","hulu.com","www.ted.com","youku.com","v.youku.com","youtu.be","56.com","v.qq.com","tudou.com","www.letv.com","tv.sohu.com","video.sina.com.cn"],videoSitesInfo:{"www.youtube.com":{player:"#player-api",idRegexp:/\?v\=([0-9a-z\-]+)/i,frameSrc:"https://www.youtube.com/embed/{{id}}"},"youtu.be":{player:"#player-api",idRegexp:/youtu\.be\/([0-9a-z\-]+)/i,frameSrc:"https://www.youtube.com/embed/{{id}}"},"vimeo.com":{player:"#video",idRegexp:/\.com\/([0-9]+)\b/,frameSrc:"https://player.vimeo.com/video/{{id}}"},"v.youku.com":{player:"#playerBox",idRegexp:/id_(.+)\.html/,frameSrc:"http://player.youku.com/embed/{{id}}"},"www.letv.com":{player:"#fla_box",idRegexp:/vplay\/(.+)\.html/,frameSrc:""},"v.qq.com":{player:"#mod_inner",idRegexp:/(?:([0-9a-z]{8,14})\.html$|\?vid\=([0-9a-z]{8,14}))/i,frameSrc:"http://v.qq.com/iframe/player.html?vid={{id}}&tiny=0&auto=0"},"www.ted.com":{player:".player__container",idRegexp:/talks\/([0-9a-z\_\-]+)(?:\.html|\?)/i,frameSrc:"https://embed-ssl.ted.com/talks/{{id}}.html"}},isVideoLink:function(e){if(!e)return!1;var t=document.createElement("a");t.href=e;var i=t.host;if(t=null,this.supportedVideoSites.indexOf(i)>=0){var a=this.videoSitesInfo[i];if(a){var o=e.match(a.idRegexp);if(o&&o.length>0&&(n(o).each(function(e,t){t||o.splice(e,1)}),o.length>=2)){var s=o[1];return a.frameSrc&&s?a.frameSrc.replace("{{id}}",s):!0}}}return!1}};t["default"]=i,e.exports=t["default"]}).call(t,n(3))},function(e,t,n){(function(i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(9),o={EVENT_NAMESPACE:".okmemo",notifyTop:function(e){return window.postMessage&&window.top.postMessage(e,"*"),this},notifyCurrentPage:function(e,t){return i(window).trigger(e+this.EVENT_NAMESPACE,t),this},listenPageEvent:function(e,t){return i(window).on(e+this.EVENT_NAMESPACE,function(e,n){i.isFunction(t)&&t.call(null,n)}),this},notifyTabs:function(e,t){return t=t||"",a.LocalKVDB.set(e+this.EVENT_NAMESPACE,t),this},listenGlobalEvent:function(e,t){return a.LocalKVDB.listenKeyChange(e+this.EVENT_NAMESPACE,function(e,n){var o=a.LocalKVDB.get(e,{});i.isFunction(t)&&t.call(null,o,n)}),this},notifyAll:function(e,t){return this.notifyTabs(e,t),this.notifyCurrentPage(e,t),this},ListenAllEvent:function(e,t){return i(window).on(e+this.EVENT_NAMESPACE,function(e,n){i.isFunction(t)&&t.call(null,n)}),a.LocalKVDB.listenKeyChange(e+this.EVENT_NAMESPACE,function(e,n){var o=a.LocalKVDB.get(e,{});i.isFunction(t)&&t.call(null,o,n)}),this}};t["default"]=o,e.exports=t["default"]}).call(t,n(3))},function(e,t,n){(function(t){e.exports=t._$=n(3)}).call(t,function(){return this}())},function(e,t,n){(function(t){e.exports=t._App=n(43)}).call(t,function(){return this}())},function(e,t,n){(function(t){e.exports=t._LocalStorage=n(44)}).call(t,function(){return this}())},function(e,t,n){(function(t){e.exports=t._Note=n(69)}).call(t,function(){return this}())},function(e,t,n){(function(t){e.exports=t._OKConfig=n(8)}).call(t,function(){return this}())},function(e,t,n){(function(t){e.exports=t._Request=n(45)}).call(t,function(){return this}())},function(e,t,n){(function(t){e.exports=t._User=n(70)}).call(t,function(){return this}())},function(e,t){},function(e,t,n){e.exports=n.p+"analytic.js"},function(e,t,n){e.exports=n.p+"jstorage.min.js"},function(e,t,n){e.exports=n.p+"load.js"},function(e,t,n){e.exports=n.p+"extension.html"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports="data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIgAAACICAYAAAA8uqNSAAAAAXNSR0IArs4c6QAAA01JREFUeAHt2lFOkwEQhVEwrpmwBMJiuwW0aukNIzel9KlzSJTJjJr06/FPBB8Ph8Pbgw8FPinw45O9tQJ/CgACQi0ASM3jCAgDtQAgNY8jIAzUAoDUPI6AMFALAFLzOALCQC0ASM3jCAgDtQAgNY8jIAzUAoDUPI6AMFALAFLzOALCQC0ASM3jCAgDtQAgNY8jIAzUAoDUPI6AMFALAFLzOALCQC0ASM3jCAgDtQAgNY8jIAzUAoDUPI6AMFALAFLzOALCQC0ASM3jCAgDtQAgNY8jIAzUAoDUPI6AMFALAFLzOALCQC0ASM3jCAgDtQAgNY8jIAzUAoDUPI6AMFALAFLzOALCQC0ASM3jCAgDtQAgNY8jIAzUAoDUPI6AhIGXl5eH4w8f5wI/z+Pu6Qjj9fX1PcLz8/P7vHnwBPn97n/EcYTiSfL3r8V6IB9xnJ4WkAAynhwnHKfPkDw8rH2CfPbkOOE4fd6OZCWQS3FAsvAJ8lUc25GseoJci2MzkjVAvotjK5IVQG6FYyOSuwdyaxzbkNw9kNMb6vN1Be4eyPF7Kk9PT9fVKb/r+Gdu+H7N3QM5vse3RrIFx7HdCiC3RLIJxyogt0CyDcc6IN9BshHHSiDXINmKYy2QryDZjGM1kEuQbMexHkhDAsexzqJ/5v59uf//+ePXSeA4d/K/2v+1yK+K5nxOtXN6PBwObztfuld9SYE1X0m9JIZfMwsAMpvYRAFAIoZxFgBkNrGJAoBEDOMsAMhsYhMFAIkYxlkAkNnEJgoAEjGMswAgs4lNFAAkYhhnAUBmE5soAEjEMM4CgMwmNlEAkIhhnAUAmU1sogAgEcM4CwAym9hEAUAihnEWAGQ2sYkCgEQM4ywAyGxiEwUAiRjGWQCQ2cQmCgASMYyzACCziU0UACRiGGcBQGYTmygASMQwzgKAzCY2UQCQiGGcBQCZTWyiACARwzgLADKb2EQBQCKGcRYAZDaxiQKARAzjLADIbGITBQCJGMZZAJDZxCYKABIxjLMAILOJTRQAJGIYZwFAZhObKABIxDDOAoDMJjZRAJCIYZwFAJlNbKIAIBHDOAsAMpvYRAFAIoZxFgBkNrGJAoBEDOMsAMhsYhMFAIkYxlngFyrJi0Of/52JAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6M0U2RTIyQjIwQUNEMTFFNjhFMzhFRTEwQTdBNEU3MjUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6M0U2RTIyQjMwQUNEMTFFNjhFMzhFRTEwQTdBNEU3MjUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoyODNCOTdGRjBBQ0IxMUU2OEUzOEVFMTBBN0E0RTcyNSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoyODNCOTgwMDBBQ0IxMUU2OEUzOEVFMTBBN0E0RTcyNSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PoInJOIAAAa1SURBVHja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"},function(e,t){e.exports="data:image/png;base64,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";
}]);