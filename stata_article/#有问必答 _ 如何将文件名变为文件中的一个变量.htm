<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><div class="rich_media_area_primary" id="page-content">
 <div id="img-content">
  <h2 class="rich_media_title" id="activity-name">
  </h2>
  <div class="rich_media_meta_list" id="meta_content">
  </div>
  <div class="rich_media_content " id="js_content">
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif;">
     近日，爬虫俱乐部的一位铁粉给小编发邮件，说他从wind数据库里下载的上市公司数据不包含股票代码，而下载下来的excel文件名是相应的股票代码，问有没有什么办法可以将excel文件的文件名变为excel文件中的一个变量，最后再将这些数据合并到一起。
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif;">
     让我们来瞄瞄具体问题。
    </span>
   </p>
   <section class="" data-source="bj.96weixin.com" style="padding-right: 5px; padding-left: 5px; border: 1px dashed transparent; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; box-sizing: border-box !important; word-wrap: break-word !important;">
    <p style="margin-top: 5px; margin-bottom: 5px; text-align: center; box-sizing: border-box !important; word-wrap: break-word !important;">
     <img _width="auto" class=" __bg_gif" data-fail="0" data-order="0" data-ratio="0.24242424242424243" data-src="http://mmbiz.qpic.cn/mmbiz_gif/ACviaWTBFxhbicaoyoWBsudqhkSI4gBR7bqHGk9YlWXLy2lL9ryah1MQ8w92TSEibM2LYb3623fiabme9Uqyg5cl0w/0?wx_fmt=gif" data-type="gif" data-w="330" src="%E6%9C%89%E9%97%AE%E5%BF%85%E7%AD%94%20_%20%E5%A6%82%E4%BD%95%E5%B0%86%E6%96%87%E4%BB%B6%E5%90%8D%E5%8F%98%E4%B8%BA%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E4%B8%80%E4%B8%AA%E5%8F%98%E9%87%8F_files/0_002.gif" style="box-sizing: border-box !important; overflow-wrap: break-word !important; width: auto !important; height: auto !important; visibility: visible !important;"/>
    </p>
   </section>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif;">
     这是我们需要添加股票代码的excel文件。
    </span>
    <img _width="100%" class=" " data-fail="0" data-ratio="0.39783001808318263" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_jpg/ACviaWTBFxhbicaoyoWBsudqhkSI4gBR7bzEGOYIzojkwia2NLVH8pKHWVy2JwUZ2sl09iaN4fvbcPgSf1Q2VhB9NA/0?wx_fmt=jpeg" data-type="jpeg" data-w="553" src="%E6%9C%89%E9%97%AE%E5%BF%85%E7%AD%94%20_%20%E5%A6%82%E4%BD%95%E5%B0%86%E6%96%87%E4%BB%B6%E5%90%8D%E5%8F%98%E4%B8%BA%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E4%B8%80%E4%B8%AA%E5%8F%98%E9%87%8F_files/640_002.jpg" style='text-align: center; font-family: "Helvetica Neue",Helvetica,"Hiragino Sans GB","Microsoft YaHei",Arial,sans-serif; line-height: 1.6; width: 100% !important; height: auto !important; visibility: visible !important;'/>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif;">
     我们先用import命令将000049.xlsx文件读入stata，看看具体的数据结构是什么样的。
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; text-indent: 0em; white-space: normal; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     import excel using 000049.xlsx,first clear
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif;">
     读
入后的结果如下图，其中有一个需要注意的地方是，在数据的结尾处，有一行空格和一行“数据来源：Wind咨询”，这是Wind数据的特有格式，虽然这两行
不影响我们对单个数据的处理，但会对后续的数据追加产生影响，而且这两行内容也是我们不需要的，所以我们先将这两行删掉，在这里，我们使用drop命令。
    </span>
    <img _width="100%" class="" data-fail="0" data-ratio="0.17902208201892744" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/ACviaWTBFxhbicaoyoWBsudqhkSI4gBR7bxwqA2eLD2po8V7z9v8rcmxQJUQiaxib5cWPDwXPAtZHUB6zJWpNzPSQQ/0?wx_fmt=png" data-type="png" data-w="1268" src="%E6%9C%89%E9%97%AE%E5%BF%85%E7%AD%94%20_%20%E5%A6%82%E4%BD%95%E5%B0%86%E6%96%87%E4%BB%B6%E5%90%8D%E5%8F%98%E4%B8%BA%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E4%B8%80%E4%B8%AA%E5%8F%98%E9%87%8F_files/640_003.jpg" style='text-align: center; font-family: "Helvetica Neue",Helvetica,"Hiragino Sans GB","Microsoft YaHei",Arial,sans-serif; line-height: 1.6; width: 100% !important; height: auto !important; visibility: visible !important;'/>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 0em; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="color: rgb(118, 146, 60); font-family: 微软雅黑, sans-serif; font-size: 16px; text-indent: 0em;">
     drop in -2/-1
    </span>
    <br/>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif;">
     下
面就是最主要的部分了，即产生股票代码变量，股票代码是在文件名里，如何让stata智能的记住文件名并引用文件名呢？这就要用到我们在推文《赐予我力量
吧，stata！》里介绍到的fs命令，这个命令的作用是列出某一文件夹下文件的名字，当然，我们也可以只列出指定类型的文件。
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif;">
     以000049.xlsx为例。
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; text-indent: 0em; white-space: normal; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     fs 000049.xlsx
    </span>
    <img _width="100%" class="" data-fail="0" data-ratio="0.35195530726256985" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/ACviaWTBFxhbicaoyoWBsudqhkSI4gBR7bYU8QXvLNNaXdYQXBY7KeIt6Vqr2icblEnpI7j1H0c2sa7tpJxIA5O0Q/0?wx_fmt=png" data-type="png" data-w="179" src="%E6%9C%89%E9%97%AE%E5%BF%85%E7%AD%94%20_%20%E5%A6%82%E4%BD%95%E5%B0%86%E6%96%87%E4%BB%B6%E5%90%8D%E5%8F%98%E4%B8%BA%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E4%B8%80%E4%B8%AA%E5%8F%98%E9%87%8F_files/640.png" style='text-align: center; font-family: "Helvetica Neue",Helvetica,"Hiragino Sans GB","Microsoft YaHei",Arial,sans-serif; line-height: 1.6; width: 100% !important; height: auto !important; visibility: visible !important;'/>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif;">
     文件名虽然列出来了，但是还不够，问题的关键是我们如何引用文件名，不过这也不是什么大大问题，因为fs命令在列出文件名的同时会自动将文件名存在返回值里，我们只需要引用fs命令的返回值r(files)就可以了。
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; text-indent: 0em; white-space: normal; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     return list
    </span>
    <img _width="100%" class="" data-fail="0" data-ratio="0.2540792540792541" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/ACviaWTBFxhbicaoyoWBsudqhkSI4gBR7bWiaNPgYqM6ZVIthiaO8ZLZU3Vfddib1ukcRPWFM8AwbXg6EPSUAUDPedA/0?wx_fmt=png" data-type="png" data-w="429" src="%E6%9C%89%E9%97%AE%E5%BF%85%E7%AD%94%20_%20%E5%A6%82%E4%BD%95%E5%B0%86%E6%96%87%E4%BB%B6%E5%90%8D%E5%8F%98%E4%B8%BA%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E4%B8%80%E4%B8%AA%E5%8F%98%E9%87%8F_files/640_002.png" style='font-family: "Helvetica Neue",Helvetica,"Hiragino Sans GB","Microsoft YaHei",Arial,sans-serif; line-height: 1.6; width: 100% !important; height: auto !important; visibility: visible !important;'/>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; text-indent: 0em; white-space: normal; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     gen code = r(files)
    </span>
    <img class="" data-fail="0" data-ratio="0.1679790026246719" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/ACviaWTBFxhbicaoyoWBsudqhkSI4gBR7b88s54J6WeF8uWibwA5jeukYnFAlUHZ3gyMprJu4wEp5W4G8FqY5nrHg/0?wx_fmt=png" data-type="png" data-w="1143" src="%E6%9C%89%E9%97%AE%E5%BF%85%E7%AD%94%20_%20%E5%A6%82%E4%BD%95%E5%B0%86%E6%96%87%E4%BB%B6%E5%90%8D%E5%8F%98%E4%B8%BA%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E4%B8%80%E4%B8%AA%E5%8F%98%E9%87%8F_files/640_004.jpg" style='font-family: "Helvetica Neue",Helvetica,"Hiragino Sans GB","Microsoft YaHei",Arial,sans-serif; line-height: 1.6; width: auto !important; height: auto !important; visibility: visible !important;'/>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif;">
     因为返回值r(files)里的文件名是包含文件的后缀的，所以将文件名生成股票代码后，还需要做一个小小的处理，即只将文件名中的股票代码保存下来，在这里我们可以用substr()函数。
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; text-indent: 0em; white-space: normal; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     replace code=substr(code,1,6)
    </span>
    <img _width="100%" data-ratio="0.16137566137566137" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/ACviaWTBFxhbicaoyoWBsudqhkSI4gBR7bq4cic8CYiaMRJsFnXhRYoBpLl6IOOxPzPoQ8GjRCes2gRGcbNx3hKskQ/0?wx_fmt=png" data-type="png" data-w="1134" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" style='text-align: center; font-family: "Helvetica Neue",Helvetica,"Hiragino Sans GB","Microsoft YaHei",Arial,sans-serif; line-height: 1.6; width: 100px !important; height: 16.1376px !important;'/>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif;">
     既然对000049.xlsx文件我们会处理了，那对于其他的excel文件，只需要写个循环批量处理，然后将新生成的dta文件追加在一起就OK了。
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif;">
     话不多说，直接将完整的代码奉送给大家。
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     clear
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     set more off
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     cd D:\2012
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     fs *.xlsx
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     foreach file in `r(files)' {
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     import excel using "`file'",first clear
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     drop in -2/-1
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     gen code = "`file'"
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     replace code=substr(code,1,6)
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     save `file'.dta,replace
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     }
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     clear
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     cd D:\2012
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     local files:dir "D:\2012" files "*.dta"
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     foreach file in `files'{
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     append using "`file'",force
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     }
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     save mydata.dta,replace
    </span>
    <img _width="100%" class="" data-fail="0" data-ratio="0.5248796147672552" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/ACviaWTBFxhbicaoyoWBsudqhkSI4gBR7bOlI3RibicUKMAhBOiaFQQ0aBpg8oVlLwlljOMy2fjjcwBIw0fZc2GcoHw/0?wx_fmt=png" data-type="png" data-w="1246" src="%E6%9C%89%E9%97%AE%E5%BF%85%E7%AD%94%20_%20%E5%A6%82%E4%BD%95%E5%B0%86%E6%96%87%E4%BB%B6%E5%90%8D%E5%8F%98%E4%B8%BA%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E4%B8%80%E4%B8%AA%E5%8F%98%E9%87%8F_files/640_006.jpg" style='text-align: center; font-family: "Helvetica Neue",Helvetica,"Hiragino Sans GB","Microsoft YaHei",Arial,sans-serif; line-height: 1.6; width: 100% !important; height: auto !important; visibility: visible !important;'/>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif;">
     这样，我们想要的股票代码就有了，所有的数据也都合并在一起了。我们的这位铁粉给小编指出，小编在使用了第一次循环后没有clear，导致其中一个文件被append了两次。在此，爬虫君特地提醒大家，批量append之前记得先clear哦。
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif;">
     在上述方法中，虽然我们达到了预定的目的，但还有更简洁更高效的办法，那就是使用openall命令，在推文《
     <a href="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247484190&amp;idx=1&amp;sn=99071962d7b49c6715bf3eb58e01f74d&amp;chksm=e9af4bb1ded8c2a7536b8312f3d29dc48a602ee06438aa2e708885d96df162c9f46bb0d0aa72&amp;scene=21#wechat_redirect" target="_blank">
      送你一只粘合剂——用openall合并数据
     </a>
     》
中详细介绍了这个命令。在批量将excel文件转成dta文件，并批量对dta文件做过预处理后，直接使用openall命令，不需在openall之前
先clear，而且openall命令的storefilename()选项可以生成一个新的变量，显示某条观测值的来源文件。
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif;">
     先用代码批量对excel文件和转化后的dtta文件做预处理。
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     cd D:\2012
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     fs *.xlsx
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     foreach file in `r(files)' {
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     import excel using "`file'",first clear
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     drop in -2/-1
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     save `file'.dta,replace
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     }
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif;">
     然后使用openall命令以及storefilename()选项
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; text-indent: 0em; white-space: normal; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     openall *,storefilename(code)
    </span>
    <img _width="100%" class="" data-fail="0" data-ratio="0.5426677713338857" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/ACviaWTBFxhbicaoyoWBsudqhkSI4gBR7bU25gmuf44ibF4tDh6Yow1Oo9kdn2ibaejJWyrt52f6uckOsicbCKUKRQA/0?wx_fmt=png" data-type="png" data-w="1207" src="%E6%9C%89%E9%97%AE%E5%BF%85%E7%AD%94%20_%20%E5%A6%82%E4%BD%95%E5%B0%86%E6%96%87%E4%BB%B6%E5%90%8D%E5%8F%98%E4%B8%BA%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E4%B8%80%E4%B8%AA%E5%8F%98%E9%87%8F_files/640_005.jpg" style='text-align: center; font-family: "Helvetica Neue",Helvetica,"Hiragino Sans GB","Microsoft YaHei",Arial,sans-serif; line-height: 1.6; width: 100% !important; height: auto !important; visibility: visible !important;'/>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif;">
     将code变量中需要的部分提取出来
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; text-indent: 0em; white-space: normal; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif; color: rgb(118, 146, 60);">
     replace code=substr(code,1,6)
    </span>
    <img _width="100%" class="" data-fail="0" data-ratio="0.5447761194029851" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/ACviaWTBFxhbicaoyoWBsudqhkSI4gBR7bmX3ksuXicCgs51HCiaBNGY6ia8CJ2mtyNcDLPgXF4eAicv7cia4bu9BLaGg/0?wx_fmt=png" data-type="png" data-w="1206" src="%E6%9C%89%E9%97%AE%E5%BF%85%E7%AD%94%20_%20%E5%A6%82%E4%BD%95%E5%B0%86%E6%96%87%E4%BB%B6%E5%90%8D%E5%8F%98%E4%B8%BA%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E4%B8%80%E4%B8%AA%E5%8F%98%E9%87%8F_files/640_007.jpg" style='text-align: center; font-family: "Helvetica Neue",Helvetica,"Hiragino Sans GB","Microsoft YaHei",Arial,sans-serif; line-height: 1.6; width: 100% !important; height: auto !important; visibility: visible !important;'/>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif;">
     呐，大功告成，这种方法是不是更简洁更高效呢？
    </span>
   </p>
   <p style="margin-top: 5px; margin-bottom: 5px; font-family: 'MicroSoft YaHei'; font-size: 14px; line-height: normal; white-space: normal; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important;">
    <span style="box-sizing: border-box !important; word-wrap: break-word !important; font-size: 16px; font-family: 微软雅黑, sans-serif;">
    </span>
   </p>
   <section class="" data-source="bj.96weixin.com">
    <p style="text-align: center;">
     <img _width="auto" class=" __bg_gif" data-fail="0" data-order="1" data-ratio="0.8181818181818182" data-src="http://mmbiz.qpic.cn/mmbiz/yqVAqoZvDibGMEA8vvxgFGXlBuKlBYGsGMpJCYbdz93Xtz6hsukWCHkyogaXLscNTLNRvVQ8yvreo9y79DkAY8w/0?wx_fmt=gif" data-w="66" src="%E6%9C%89%E9%97%AE%E5%BF%85%E7%AD%94%20_%20%E5%A6%82%E4%BD%95%E5%B0%86%E6%96%87%E4%BB%B6%E5%90%8D%E5%8F%98%E4%B8%BA%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E4%B8%80%E4%B8%AA%E5%8F%98%E9%87%8F_files/0.gif" style="width: auto !important; height: auto !important; visibility: visible !important;"/>
    </p>
   </section>
   <p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); font-family: 微软雅黑; line-height: 24px; text-indent: 32px; box-sizing: border-box !important; word-wrap: break-word !important; background-image: initial; background-attachment: initial; background-color: rgb(255, 255, 255); background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;">
    <span style="max-width: 100%; text-align: justify; color: rgb(136, 136, 136); text-indent: 2em; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">
     以上就是今天给大家分享的内容了，说得好就赏个铜板呗！有钱的捧个钱场，有人的捧个人场~。
    </span>
   </p>
   <p style="font-size: 16px; line-height: 25.6px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); font-family: 微软雅黑; text-indent: 2em; box-sizing: border-box !important; word-wrap: break-word !important; background-color: rgb(255, 255, 255);">
    <span style="max-width: 100%; text-align: justify; color: rgb(122, 79, 214); line-height: 25.6px; text-indent: 2em; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">
     应广大粉丝要求，爬虫俱乐部的推文公众号打赏功能可以开发票啦，累计打赏超过1000元我们即可给您开具发票，发票类别为“咨询费”。用心做事，只为做您更贴心的小爬虫。第一批发票已经寄到各位小主的手中，大家快来给小爬虫打赏呀~
    </span>
   </p>
   <section style="font-size: 16px; line-height: 25.6px; white-space: normal; max-width: 100%; box-sizing: border-box; color: rgb(62, 62, 62); font-family: 微软雅黑; text-align: center; word-wrap: break-word !important; background-color: rgb(255, 255, 255);">
    <section powered-by="xiumi.us" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;">
     <section style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;">
      <section style="max-width: 100%; box-sizing: border-box; line-height: 1.8; font-size: 14px; word-wrap: break-word !important;">
       <p style="max-width: 100%; min-height: 1em; text-align: right; line-height: 25.6px; text-indent: 28px; font-size: 16px; box-sizing: border-box !important; word-wrap: break-word !important;">
        <span style="max-width: 100%; color: rgb(122, 79, 214); line-height: 25.6px; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">
        </span>
        <span style="max-width: 100%; color: rgb(117, 114, 114); line-height: 25.6px; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">
         文字编辑：梅洁瓷傲
        </span>
       </p>
       <p style="max-width: 100%; min-height: 1em; text-align: right; line-height: 25.6px; text-indent: 28px; font-size: 16px; box-sizing: border-box !important; word-wrap: break-word !important;">
        <span style="max-width: 100%; color: rgb(117, 114, 114); line-height: 25.6px; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">
         技术总编：刘贝贝
        </span>
       </p>
       <hr style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>
       <hr style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>
       <p style="max-width: 100%; min-height: 1em; line-height: 25.6px; text-indent: 0em; font-size: 16px; text-align: left; box-sizing: border-box !important; word-wrap: break-word !important;">
        <strong style="max-width: 100%; text-align: justify; color: rgb(136, 136, 136); line-height: 23.27px; text-indent: 0em; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">
         往期推文推荐：
        </strong>
        <span style="max-width: 100%; color: rgb(117, 114, 114); line-height: 25.6px; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">
        </span>
       </p>
       <p style="max-width: 100%; min-height: 1em; text-align: left; box-sizing: border-box !important; word-wrap: break-word !important;">
        <span style="max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important;">
         1.
        </span>
        <a data_ue_src="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247486256&amp;idx=1&amp;sn=ac0e923153845a620ebcd57045f105a0&amp;chksm=e9af439fded8ca89ea91469c79d865dde3e12bfcfe55f4a8175785032a8ffdc5f24f8cdab400&amp;scene=21#wechat_redirect" href="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247486256&amp;idx=1&amp;sn=ac0e923153845a620ebcd57045f105a0&amp;chksm=e9af439fded8ca89ea91469c79d865dde3e12bfcfe55f4a8175785032a8ffdc5f24f8cdab400&amp;scene=21#wechat_redirect" style="color: rgb(0, 0, 0); max-width: 100%; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important;" target="_blank">
         高校学术大神：你的导师上榜了吗？
        </a>
       </p>
       <section powered-by="xiumi.us" style="max-width: 100%; box-sizing: border-box; line-height: 25.6px; font-size: 16px; word-wrap: break-word !important;">
        <section style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;">
         <section style="max-width: 100%; box-sizing: border-box; line-height: 1.8; font-size: 14px; word-wrap: break-word !important;">
          <section style="max-width: 100%; box-sizing: border-box; line-height: 2.2; word-wrap: break-word !important;">
           <section powered-by="xiumi.us" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;">
            <section style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;">
             <section style="max-width: 100%; box-sizing: border-box; line-height: 1.8; word-wrap: break-word !important;">
              <section style="max-width: 100%; box-sizing: border-box; line-height: 25.6px; word-wrap: break-word !important;">
               <section powered-by="xiumi.us" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;">
                <section style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;">
                 <section style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">
                  <p style="max-width: 100%; min-height: 1em; color: rgb(117, 114, 114); line-height: 25.6px; font-size: 15px; text-align: left; box-sizing: border-box !important; word-wrap: break-word !important;">
                   <span style="max-width: 100%; text-align: justify; color: rgb(0, 0, 0); line-height: 25.6px; box-sizing: border-box !important; word-wrap: break-word !important;">
                    2.
                   </span>
                   <a data_ue_src="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247485548&amp;idx=1&amp;sn=478ba30875877af79d97e9ed4eecaa7c&amp;chksm=e9af40c3ded8c9d5dc76879c0d21bb2e5e8fd182c59f2545c9879706403cafb260281dc13fce&amp;scene=21#wechat_redirect" href="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247485548&amp;idx=1&amp;sn=478ba30875877af79d97e9ed4eecaa7c&amp;chksm=e9af40c3ded8c9d5dc76879c0d21bb2e5e8fd182c59f2545c9879706403cafb260281dc13fce&amp;scene=21#wechat_redirect" style="color: rgb(0, 0, 0); max-width: 100%; text-align: justify; line-height: 25.6px; box-sizing: border-box !important; word-wrap: break-word !important;" target="_blank">
                    中国高校财经、管理与综合类期刊灌水排行榜
                   </a>
                   <a data_ue_src="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247484899&amp;idx=1&amp;sn=0da9bcae33696501a5eb8c8ab9c5b5ff&amp;chksm=e9af4d4cded8c45a84ed90d75464c3a866a79295f355f75e68943300fa58eb2ad1d18e016ef5&amp;scene=21#wechat_redirect" href="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247484899&amp;idx=1&amp;sn=0da9bcae33696501a5eb8c8ab9c5b5ff&amp;chksm=e9af4d4cded8c45a84ed90d75464c3a866a79295f355f75e68943300fa58eb2ad1d18e016ef5&amp;scene=21#wechat_redirect" style="color: rgb(0, 0, 0); max-width: 100%; text-align: justify; line-height: 25.6px; box-sizing: border-box !important; word-wrap: break-word !important;" target="_blank">
                   </a>
                  </p>
                  <p style="max-width: 100%; min-height: 1em; color: rgb(117, 114, 114); line-height: 25.6px; font-size: 15px; text-align: left; box-sizing: border-box !important; word-wrap: break-word !important;">
                   <span style="max-width: 100%; color: rgb(0, 0, 0); line-height: 25.6px; box-sizing: border-box !important; word-wrap: break-word !important;">
                    3.
                    <a data_ue_src="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247484941&amp;idx=1&amp;sn=f348ba26ed2e9c5c25efd14e3c26c506&amp;chksm=e9af4ea2ded8c7b4f0c98365323ca46337259f9ba58c9d2541b94898bcd450c162108ba9a577&amp;scene=21#wechat_redirect" href="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247484941&amp;idx=1&amp;sn=f348ba26ed2e9c5c25efd14e3c26c506&amp;chksm=e9af4ea2ded8c7b4f0c98365323ca46337259f9ba58c9d2541b94898bcd450c162108ba9a577&amp;scene=21#wechat_redirect" style="color: rgb(0, 0, 0); max-width: 100%; line-height: 25.6px; box-sizing: border-box !important; word-wrap: break-word !important;" target="_blank">
                     关于RTF你不知道的命令之番外篇
                    </a>
                   </span>
                  </p>
                  <p style="max-width: 100%; min-height: 1em; color: rgb(117, 114, 114); line-height: 25.6px; font-size: 15px; text-align: left; box-sizing: border-box !important; word-wrap: break-word !important;">
                   <span style="max-width: 100%; text-align: justify; color: rgb(0, 0, 0); line-height: 24px; box-sizing: border-box !important; word-wrap: break-word !important;">
                    4.
                    <a data_ue_src="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247484326&amp;idx=1&amp;sn=179a96c391bae0ff47e9f84b3e960aae&amp;chksm=e9af4b09ded8c21f705cc74ba9a18f996a6fed246222e51b404425e79a30b041bf2eef5c5d44&amp;scene=21#wechat_redirect" href="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247484326&amp;idx=1&amp;sn=179a96c391bae0ff47e9f84b3e960aae&amp;chksm=e9af4b09ded8c21f705cc74ba9a18f996a6fed246222e51b404425e79a30b041bf2eef5c5d44&amp;scene=21#wechat_redirect" style="color: rgb(0, 0, 0); max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;" target="_blank">
                     免费事件研究，一片片从邮局寄来
                    </a>
                   </span>
                  </p>
                  <p style="max-width: 100%; min-height: 1em; color: rgb(117, 114, 114); line-height: 25.6px; font-size: 15px; text-align: left; box-sizing: border-box !important; word-wrap: break-word !important;">
                   <span style="max-width: 100%; text-align: justify; color: rgb(0, 0, 0); line-height: 24px; box-sizing: border-box !important; word-wrap: break-word !important;">
                    5.
                   </span>
                   <a data_ue_src="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247484452&amp;idx=1&amp;sn=c40cd805dafb50cf9c226cdd20550382&amp;chksm=e9af4c8bded8c59da87a75728c6600f0b6691846dfc071d9ee50d4d1424fd26bb696ed2ee0d4&amp;scene=21#wechat_redirect" href="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247484452&amp;idx=1&amp;sn=c40cd805dafb50cf9c226cdd20550382&amp;chksm=e9af4c8bded8c59da87a75728c6600f0b6691846dfc071d9ee50d4d1424fd26bb696ed2ee0d4&amp;scene=21#wechat_redirect" style="color: rgb(0, 0, 0); max-width: 100%; text-align: justify; line-height: 24px; box-sizing: border-box !important; word-wrap: break-word !important;" target="_blank">
                    免费的股价同步性，一片片从邮局寄来
                   </a>
                  </p>
                  <p style="max-width: 100%; min-height: 1em; color: rgb(117, 114, 114); line-height: 25.6px; font-size: 15px; text-align: left; box-sizing: border-box !important; word-wrap: break-word !important;">
                   <span style="max-width: 100%; text-align: justify; color: rgb(0, 0, 0); line-height: 24px; box-sizing: border-box !important; word-wrap: break-word !important;">
                    6.
                   </span>
                   <a data_ue_src="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247484529&amp;idx=1&amp;sn=dace95be71022f51c515c28b252d1e7b&amp;chksm=e9af4cdeded8c5c87a91fb3a1a5caa55cc6fe961ab72c6734cd859b48239882b48756bd4ad5e&amp;scene=21#wechat_redirect" href="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247484529&amp;idx=1&amp;sn=dace95be71022f51c515c28b252d1e7b&amp;chksm=e9af4cdeded8c5c87a91fb3a1a5caa55cc6fe961ab72c6734cd859b48239882b48756bd4ad5e&amp;scene=21#wechat_redirect" style="color: rgb(0, 0, 0); max-width: 100%; text-align: justify; line-height: 24px; box-sizing: border-box !important; word-wrap: break-word !important;" target="_blank">
                    Stata叫你回家听音乐了！
                   </a>
                  </p>
                  <p style="max-width: 100%; min-height: 1em; color: rgb(117, 114, 114); line-height: 25.6px; font-size: 15px; text-align: left; box-sizing: border-box !important; word-wrap: break-word !important;">
                   <span style="max-width: 100%; text-align: justify; color: rgb(0, 0, 0); line-height: 1.4; box-sizing: border-box !important; word-wrap: break-word !important;">
                    7.
                   </span>
                   <a data_ue_src="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247484866&amp;idx=1&amp;sn=9814dd7590f639877665d9a7be1a7596&amp;chksm=e9af4d6dded8c47bec92e4f77659fe8b2b6ec7502b6d380e34a3c67ef83165e103077abd3ee5&amp;scene=21#wechat_redirect" href="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247484866&amp;idx=1&amp;sn=9814dd7590f639877665d9a7be1a7596&amp;chksm=e9af4d6dded8c47bec92e4f77659fe8b2b6ec7502b6d380e34a3c67ef83165e103077abd3ee5&amp;scene=21#wechat_redirect" style="color: rgb(0, 0, 0); max-width: 100%; text-align: justify; line-height: 1.4; box-sizing: border-box !important; word-wrap: break-word !important;" target="_blank">
                    一言不合就用stata写邮件（Outlook/Foxmail）
                   </a>
                  </p>
                  <p style="max-width: 100%; min-height: 1em; color: rgb(117, 114, 114); line-height: 25.6px; font-size: 15px; text-align: left; box-sizing: border-box !important; word-wrap: break-word !important;">
                   <span style="max-width: 100%; text-align: justify; color: rgb(0, 0, 0); line-height: 24px; box-sizing: border-box !important; word-wrap: break-word !important;">
                    8.
                   </span>
                   <a data_ue_src="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247484979&amp;idx=1&amp;sn=e572f2658ba8137832e3ae3aff2ce01a&amp;chksm=e9af4e9cded8c78a191dd0bcd06218c57a5492e4d23b1f7b0c564701a174337a4afe61a6b8e2&amp;scene=21#wechat_redirect" href="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247484979&amp;idx=1&amp;sn=e572f2658ba8137832e3ae3aff2ce01a&amp;chksm=e9af4e9cded8c78a191dd0bcd06218c57a5492e4d23b1f7b0c564701a174337a4afe61a6b8e2&amp;scene=21#wechat_redirect" style="color: rgb(0, 0, 0); max-width: 100%; text-align: justify; line-height: 24px; box-sizing: border-box !important; word-wrap: break-word !important;" target="_blank">
                    听说你想知道怎么用stata画地图？
                   </a>
                  </p>
                  <p style="max-width: 100%; min-height: 1em; color: rgb(117, 114, 114); line-height: 25.6px; font-size: 15px; text-align: left; box-sizing: border-box !important; word-wrap: break-word !important;">
                   <span style="max-width: 100%; text-align: justify; color: rgb(0, 0, 0); line-height: 1.4; box-sizing: border-box !important; word-wrap: break-word !important;">
                    9.
                   </span>
                   <a data_ue_src="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247484233&amp;idx=1&amp;sn=104ca64b0bd3cf2dea046b11ea89e028&amp;chksm=e9af4be6ded8c2f005e28306aa9dab5cfcbca4020abb8296469fc5006c1eb32c6594c7b99a4b&amp;scene=21#wechat_redirect" href="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247484233&amp;idx=1&amp;sn=104ca64b0bd3cf2dea046b11ea89e028&amp;chksm=e9af4be6ded8c2f005e28306aa9dab5cfcbca4020abb8296469fc5006c1eb32c6594c7b99a4b&amp;scene=21#wechat_redirect" style="color: rgb(0, 0, 0); max-width: 100%; text-align: justify; line-height: 1.4; box-sizing: border-box !important; word-wrap: break-word !important;" target="_blank">
                    I have a Stata, I have a python
                   </a>
                  </p>
                  <p style="max-width: 100%; min-height: 1em; color: rgb(117, 114, 114); line-height: 25.6px; font-size: 15px; text-align: left; box-sizing: border-box !important; word-wrap: break-word !important;">
                   <span style="max-width: 100%; text-align: justify; color: rgb(0, 0, 0); line-height: 24px; box-sizing: border-box !important; word-wrap: break-word !important;">
                    10.
                   </span>
                   <a data_ue_src="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247484789&amp;idx=1&amp;sn=5c52d2bba468ceb9392b440c43638a19&amp;chksm=e9af4ddaded8c4cc6bf486b21c87f0e3b17b79694bbc388741e0a1d9f5e8f6bd4134efede7f2&amp;scene=21#wechat_redirect" href="http://mp.weixin.qq.com/s?__biz=MzI0NzU3MDg4MA==&amp;mid=2247484789&amp;idx=1&amp;sn=5c52d2bba468ceb9392b440c43638a19&amp;chksm=e9af4ddaded8c4cc6bf486b21c87f0e3b17b79694bbc388741e0a1d9f5e8f6bd4134efede7f2&amp;scene=21#wechat_redirect" style="color: rgb(0, 0, 0); max-width: 100%; text-align: justify; line-height: 24px; box-sizing: border-box !important; word-wrap: break-word !important;" target="_blank">
                    I have a Stata, I have a Python之二——pdf转word
                   </a>
                  </p>
                  <hr style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>
                  <hr style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>
                  <p style="max-width: 100%; min-height: 1em; color: rgb(117, 114, 114); line-height: 25.6px; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important;">
                   <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>
                  </p>
                 </section>
                </section>
               </section>
              </section>
             </section>
            </section>
           </section>
          </section>
         </section>
        </section>
       </section>
       <section powered-by="xiumi.us" style="max-width: 100%; box-sizing: border-box; line-height: 25.6px; font-size: 16px; word-wrap: break-word !important;">
        <section style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;">
         <section style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;">
          <section style="max-width: 100%; box-sizing: border-box; line-height: 2.2; font-size: 14px; word-wrap: break-word !important;">
           <section powered-by="xiumi.us" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;">
            <section style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;">
             <section style="max-width: 100%; box-sizing: border-box; line-height: 1.8; word-wrap: break-word !important;">
              <section style="max-width: 100%; box-sizing: border-box; line-height: 25.6px; word-wrap: break-word !important;">
               <section powered-by="xiumi.us" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;">
                <section style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;">
                 <section style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">
                  <section style="margin-top: 10px; margin-bottom: 10px; max-width: 100%; box-sizing: border-box; color: rgb(120, 114, 114); line-height: 25.6px; font-size: 15px; font-stretch: normal; word-wrap: break-word !important;">
                   <section style="padding-right: 1em; max-width: 100%; box-sizing: border-box; width: 556.36px; text-align: right; vertical-align: top; display: inline-block; word-wrap: break-word !important;">
                    <section style="margin-right: -1em; max-width: 100%; box-sizing: border-box; text-align: left; vertical-align: bottom; display: inline-block; transform: rotate(0deg); word-wrap: break-word !important;">
                     <section style="max-width: 100%; box-sizing: border-box; width: 0px; border-right-color: rgb(1, 115, 164); border-bottom-color: rgb(1, 115, 164); border-right-width: 0.8em; border-bottom-width: 0.8em; border-right-style: solid; border-bottom-style: solid; word-wrap: break-word !important; border-top-color: transparent !important; border-left-color: transparent !important; border-top-width: 0.8em !important; border-left-width: 0.8em !important; border-top-style: solid !important; border-left-style: solid !important;">
                     </section>
                     <section style="margin-top: -1em; margin-left: -0.18em; max-width: 100%; box-sizing: border-box; width: 0px; border-right-color: rgb(255, 255, 255); border-bottom-color: rgb(255, 255, 255); border-right-width: 0.8em; border-bottom-width: 0.8em; border-right-style: solid; border-bottom-style: solid; word-wrap: break-word !important; border-top-color: transparent !important; border-left-color: transparent !important; border-top-width: 0.8em !important; border-left-width: 0.8em !important; border-top-style: solid !important; border-left-style: solid !important;">
                     </section>
                    </section>
                    <section style="margin-top: 0.3em; padding-bottom: 1em; max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; background-color: rgb(1, 183, 204);">
                     <section style="margin-top: -1em; margin-right: -1em; max-width: 100%; box-sizing: border-box; border: 0.2em solid rgb(1, 115, 164); width: 540.36px; display: inline-block; word-wrap: break-word !important; background-color: rgb(255, 255, 255);">
                      <section style="padding: 10px; max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;">
                       <section powered-by="xiumi.us" style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;">
                        <section style="max-width: 100%; box-sizing: border-box; word-wrap: break-word !important;">
                         <section style="max-width: 100%; box-sizing: border-box; text-align: center; word-wrap: break-word !important;">
                          <p style="max-width: 100%; box-sizing: border-box; min-height: 1em; line-height: 25.6px; word-wrap: break-word !important;">
                           <span style="max-width: 100%; color: rgb(255, 41, 65); box-sizing: border-box !important; word-wrap: break-word !important;">
                            <strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">
                             关于我们
                            </strong>
                           </span>
                          </p>
                          <p style="max-width: 100%; box-sizing: border-box; min-height: 1em; text-align: left; line-height: 25.6px; word-wrap: break-word !important;">
                           <span style="max-width: 100%; color: rgb(0, 0, 0); line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">
                            微信公众号“爬虫俱乐部”分享实用的stata命令，欢迎转载、打赏。爬虫俱乐部是由李春涛教授领导下的研究生及本科生组成的大数据分析和数据挖掘团队。
                           </span>
                          </p>
                         </section>
                        </section>
                       </section>
                      </section>
                     </section>
                    </section>
                   </section>
                  </section>
                  <p style="max-width: 100%; min-height: 1em; text-align: left; box-sizing: border-box !important; word-wrap: break-word !important;">
                   <span style="max-width: 100%; text-align: justify; color: rgb(255, 76, 0); line-height: 25.6px; box-sizing: border-box !important; word-wrap: break-word !important;">
                    此外，欢迎大家踊跃投稿，介绍一些关于stata的数据处理和分析技巧。
                   </span>
                  </p>
                  <p style="max-width: 100%; min-height: 1em; text-align: left; color: rgb(117, 114, 114); line-height: 25.6px; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important;">
                   <span style="max-width: 100%; color: rgb(255, 76, 0); font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">
                    投稿邮箱：
                   </span>
                   statatraining@163.com
                  </p>
                  <p style="max-width: 100%; min-height: 1em; text-align: left; color: rgb(117, 114, 114); line-height: 25.6px; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important;">
                   <span style="max-width: 100%; color: rgb(255, 76, 0); font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">
                    投稿要求：
                    <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>
                    1）必须原创，禁止抄袭；
                    <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>
                    2）必须准确，详细，有例子，有截图；
                    <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>
                    注意事项：
                    <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>
                    1）所有投稿都会经过本公众号运营团队成员的审核，审核通过才可录用，一经录用，会在该推文里为作者署名，并有赏金分成。
                    <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>
                    2）邮件请注明投稿，邮件名称为“投稿”+“推文名称”。
                    <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>
                    <span style="max-width: 100%; color: rgb(122, 79, 214); box-sizing: border-box !important; word-wrap: break-word !important;">
                     3）应广大读者要求，现开通有偿问答服务，如果大家遇到关于stata分析数据的问题，可以在公众号中提出，只需支付少量赏金，我们会在后期的推文里给予解答。
                    </span>
                   </span>
                  </p>
                 </section>
                </section>
               </section>
              </section>
              <p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;">
               <img _width="556px" class="" data-fail="0" data-ratio="1" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_jpg/ACviaWTBFxhaWXvVQ75jWic8ZgzBHtCqoBqxqNuAHrRUqGSSdt9PXL1ibOiadXZDz2bHs7MsqI4tViaF9GoGceQ71Qw/640?wx_fmt=jpeg" data-type="jpeg" data-w="430" src="%E6%9C%89%E9%97%AE%E5%BF%85%E7%AD%94%20_%20%E5%A6%82%E4%BD%95%E5%B0%86%E6%96%87%E4%BB%B6%E5%90%8D%E5%8F%98%E4%B8%BA%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E4%B8%80%E4%B8%AA%E5%8F%98%E9%87%8F_files/640.jpg" style="box-sizing: border-box !important; overflow-wrap: break-word !important; visibility: visible !important; width: 556px !important; height: auto !important;" width="100%"/>
              </p>
              <p style="max-width: 100%; min-height: 1em; line-height: 25.6px; box-sizing: border-box !important; word-wrap: break-word !important;">
               <span style="max-width: 100%; color: rgb(120, 114, 114); line-height: 19.2px; letter-spacing: 2px; font-size: 15px; box-sizing: border-box !important; word-wrap: break-word !important;">
                欢迎关注爬虫俱乐部
               </span>
              </p>
             </section>
            </section>
           </section>
          </section>
         </section>
        </section>
       </section>
      </section>
     </section>
    </section>
   </section>
  </div>
  <script nonce="101784143" type="text/javascript">
   var first_sceen__time = (+new Date());

                    if ("" == 1 && document.getElementById('js_content')) {
                        document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                            var link = document.createElement('link');
                            var head = document.getElementsByTagName('head')[0];
                            link.rel = 'stylesheet';
                            link.type = 'text/css';
                            link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg/page_mp_article_improve_winwx31619e.css";
                            head.appendChild(link);
                        }
                    })();
  </script>
  <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display:none;">
  </div>
  <div class="reward_area tc" id="js_reward_area" style="display:none;">
   <p class="tips_global reward_tips">
    救救吃土的爬虫君
   </p>
   <p>
    <a class="reward_access" href="##" id="js_reward_link">
     赞赏
    </a>
   </p>
   <div class="reward_area_inner" id="js_reward_inner" style="display: none; width: 578px;">
    <p class="tips_global reward_user_tips">
     <a href="##" id="js_reward_total">
     </a>
     人赞赏
    </p>
    <div class="reward_user_list" id="js_reward_list">
    </div>
   </div>
  </div>
  <div class="reward_qrcode_area reward_area tc" id="js_reward_qrcode" style="display:none;">
   <p class="tips_global">
    长按二维码向我转账
   </p>
   <p class="reward_tips">
    救救吃土的爬虫君
   </p>
   <span class="reward_qrcode_img_wrp">
    <img class="reward_qrcode_img" id="js_reward_qrcode_img"/>
   </span>
   <p class="tips_global">
    受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。
   </p>
  </div>
 </div>
 <div class="rich_media_tool" id="js_toobar3">
  <div class="media_tool_meta tips_global meta_primary" id="js_read_area3" style="display:none;">
   阅读
   <span id="readNum3">
   </span>
  </div>
  <span class="media_tool_meta meta_primary tips_global meta_praise" id="like3" style="display:none;">
   <i class="icon_praise_gray">
   </i>
   <span class="praise_num" id="likeNum3">
   </span>
  </span>
  <a class="media_tool_meta tips_global meta_extra" href="##" id="js_report_article3" style="display:none;">
   投诉
  </a>
 </div>
</div>
</body></html>